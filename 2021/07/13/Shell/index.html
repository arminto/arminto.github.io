<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="article">
<meta property="og:title" content="Shell">
<meta property="og:url" content="http://example.com/2021/07/13/Shell/index.html">
<meta property="og:site_name" content="LEMON">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://bucket-1301203199.cos.ap-shanghai.myqcloud.com/armin/008i3skNly1gricvz2ha1j30g70get9v.jpg">
<meta property="og:image" content="https://bucket-1301203199.cos.ap-shanghai.myqcloud.com/armin/008i3skNly1gricw9vbxzj315l0ksgm8.jpg">
<meta property="og:image" content="https://bucket-1301203199.cos.ap-shanghai.myqcloud.com/armin/008i3skNly1gsda74t8rpg30kq050q2v.gif">
<meta property="og:image" content="https://bucket-1301203199.cos.ap-shanghai.myqcloud.com/armin/008i3skNly1gricwwzwroj60v00imac302.jpg">
<meta property="og:image" content="https://bucket-1301203199.cos.ap-shanghai.myqcloud.com/armin/008i3skNly1grid0pw1s9j30ve0aggm4.jpg">
<meta property="og:image" content="https://bucket-1301203199.cos.ap-shanghai.myqcloud.com/armin/008i3skNly1grid0mckvyj31bu0acjs3.jpg">
<meta property="article:published_time" content="2021-07-13T01:29:33.000Z">
<meta property="article:modified_time" content="2021-08-03T07:19:14.922Z">
<meta property="article:author" content="Armin">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://bucket-1301203199.cos.ap-shanghai.myqcloud.com/armin/008i3skNly1gricvz2ha1j30g70get9v.jpg">

<link rel="canonical" href="http://example.com/2021/07/13/Shell/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Shell | LEMON</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">LEMON</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">记录站</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/07/13/Shell/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/armin.png">
      <meta itemprop="name" content="Armin">
      <meta itemprop="description" content="记录生活中的点点滴滴">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LEMON">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Shell
        </h1>

        <div class="post-meta">

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
      
        <!--toc-->
<span id="more"></span>

<h1 id="shell-介绍"><a href="#shell-介绍" class="headerlink" title="shell 介绍"></a>shell 介绍</h1><ul>
<li>什么shell</li>
<li>shell功能</li>
</ul>
<h2 id="一、什么是shell"><a href="#一、什么是shell" class="headerlink" title="一、什么是shell"></a>一、什么是shell</h2><blockquote>
<p>shell是一个程序，采用C语言编写，是用户和linux内核沟通的桥梁。它既是一种命令语言，又是一种解释性的编程语言。通过一个图表来查看一下shell的作用。</p>
</blockquote>
<p><img src="https://bucket-1301203199.cos.ap-shanghai.myqcloud.com/armin/008i3skNly1gricvz2ha1j30g70get9v.jpg" alt="image-20200605095946883"></p>
<blockquote>
<p><em><strong>作用：</strong></em></p>
<p><strong>kernel：为软件服务，接收用户或软件指令驱动硬件，完成工作</strong></p>
<p><strong>shell：命令解释器</strong></p>
<p><strong>user：用户接口，对接用户。</strong></p>
</blockquote>
<h2 id="二、shell-功能"><a href="#二、shell-功能" class="headerlink" title="二、shell 功能"></a>二、shell 功能</h2><ul>
<li>命令行解释功能</li>
<li>启动程序</li>
<li>输入输出重定向</li>
<li>管道连接</li>
<li>文件名置换 (echo /*)</li>
<li>变量维护</li>
<li>环境控制</li>
<li>shell编程</li>
</ul>
<h1 id="shell-语法"><a href="#shell-语法" class="headerlink" title="shell 语法"></a>shell 语法</h1><ul>
<li>如何抒写一个shell脚本</li>
<li>shell脚本运行</li>
<li>shell中的特殊符号</li>
<li>重定向</li>
<li>shell中数学运算</li>
</ul>
<p><strong>shell脚本就是一组命令的集合，按照先后顺序执行；自上而下写入到一个文本文件中，然后给予执行权限。</strong></p>
<h2 id="一、如何抒写一个shell脚本"><a href="#一、如何抒写一个shell脚本" class="headerlink" title="一、如何抒写一个shell脚本"></a>一、如何抒写一个shell脚本</h2><ul>
<li><p><em><strong>shell脚本的命名</strong></em></p>
<ul>
<li>名字要有意义，最好不要用a、b、c、d、1、2、3、4这种方式命名；虽然linux系统中，文件没有扩展名的概念，依然建议你用.sh结尾；名字不要太长，最好能在30个字节以内解决。例如：check_memory.sh</li>
</ul>
</li>
<li><p><em><strong>shell脚本格式</strong></em></p>
<ul>
<li>shell脚本开头必须指定脚本运行环境 以 #！这个特殊符号组合来组成。如： #!/bin/bash 指定该脚本是运行解析由/bin/bash来完成的；</li>
</ul>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">shell脚本中，最好加入脚本说明字段</span><br><span class="line"> <span class="comment">#!/bin/bash</span></span><br><span class="line"> <span class="comment">#Author: lemon</span></span><br><span class="line"> <span class="comment">#Created Time: 2018/08/2712:27</span></span><br><span class="line"> <span class="comment">#Script Description: first shell study script</span></span><br><span class="line"> <span class="comment">#下面写执行的命令语句</span></span><br><span class="line"> 。。。</span><br><span class="line"> 。。。</span><br><span class="line"> 。。。</span><br></pre></td></tr></table></figure>

<h2 id="二、如何运行一个shell脚本"><a href="#二、如何运行一个shell脚本" class="headerlink" title="二、如何运行一个shell脚本"></a>二、如何运行一个shell脚本</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># cat /etc/shells      #查看当前系统的所有shell环境</span></span><br><span class="line">/bin/sh</span><br><span class="line">/bin/bash</span><br><span class="line">/usr/bin/sh</span><br><span class="line">/usr/bin/bash</span><br><span class="line"></span><br><span class="line">脚本运行需要执行权限，当我们给一个文件赋予执行权限后，该脚本就可以运行。</span><br><span class="line">[root@lemon ~]<span class="comment"># chmod u+x filename</span></span><br><span class="line"></span><br><span class="line">如果不希望赋予脚本执行权限，那么可以使用bash命令来运行未给予执行权限的脚本bash fiename</span><br><span class="line">[root@lemon ~]<span class="comment"># bash filename</span></span><br></pre></td></tr></table></figure>

<h2 id="三、shell中的特殊符号"><a href="#三、shell中的特殊符号" class="headerlink" title="三、shell中的特殊符号"></a>三、shell中的特殊符号</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">~          家目录，<span class="built_in">cd</span> ~ 代表进入用户家目录</span><br><span class="line">!          执行历史命令，!! 执行上一条命令</span><br><span class="line">$          变量中取内容符</span><br><span class="line">+ - * / %  对应数学运算  加 减 乘 除 取余 </span><br><span class="line">*          星号是shell中的通配符  匹配所有</span><br><span class="line">?          问号是shell中的通配符  匹配除回车以外的一个字符</span><br><span class="line">\          转义字符</span><br><span class="line">``         反引号,命令中执行命令</span><br><span class="line"><span class="string">&#x27; &#x27;</span>        强转义,禁止引用其他变量值，$视为普通字符；意思就是<span class="string">&#x27; &#x27;</span>号里面写的是什么，显示的就是什么</span><br><span class="line"><span class="string">&quot; &quot;</span>        弱转义,允许通过$符号引用其他变量值；意思就是将<span class="string">&quot; &quot;</span>号里面变量名的变量值显示出来</span><br><span class="line">|          管道符,把前边命令的输出结果，作为后边命令的处理对象</span><br><span class="line">||         逻辑或,前边的命令执行成功，后面的不执行；前边的命令执行失败，后面的命令将会被执行</span><br><span class="line">&amp;          后台执行,仅在当前终端生效，断开终端后放在后台运行的进程也会随着退出</span><br><span class="line">&amp;&amp;         逻辑与,只有前边的命令执行成功，才会执行后面的命令</span><br><span class="line">;          和 &amp;&amp; 符号不同的一点就是 他不管前面命令的结果是否成功，它都会执行后面命令</span><br></pre></td></tr></table></figure>

<h2 id="四、shell重定向"><a href="#四、shell重定向" class="headerlink" title="四、shell重定向"></a>四、shell重定向</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#默认是正确重定向 </span></span><br><span class="line">        1&gt;        重定向正确覆盖；把屏幕上的正确内容输出到文件 </span><br><span class="line">	1&gt;&gt;       重定向正确追加；把屏幕上的正确内容以追加的形式输出到文件</span><br><span class="line">	2&gt;        重定向错误覆盖；把屏幕上的错误内容输出到文件</span><br><span class="line">	2&gt;&gt;       重定向错误追加；把屏幕上的错误内容以追加的形式输出到文件</span><br><span class="line">	&amp;&gt;        重定向混合覆盖；把屏幕上无论是正确还是错误的都输出到文件</span><br><span class="line">	&amp;&gt;&gt;       重定向混合追加；把屏幕上无论是正确还是错误以追加的形式都输出到文件</span><br></pre></td></tr></table></figure>

<h2 id="五、shell数学运算"><a href="#五、shell数学运算" class="headerlink" title="五、shell数学运算"></a>五、shell数学运算</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#$双小圆括号运算，在shell中$(( ))也可以用来做数学运算（推荐）</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo $((100 + 3))</span></span><br><span class="line">103</span><br><span class="line">[root@lemon ~]<span class="comment"># echo $((100 - 3)) </span></span><br><span class="line">97</span><br><span class="line">[root@lemon ~]<span class="comment"># echo $((100 * 3)) </span></span><br><span class="line">300</span><br><span class="line">[root@lemon ~]<span class="comment"># echo $((100 / 3)) </span></span><br><span class="line">33</span><br><span class="line">[root@lemon ~]<span class="comment"># echo $((100 % 3)) </span></span><br><span class="line">1</span><br><span class="line">[root@lemon ~]<span class="comment"># echo $((100 ** 3)) </span></span><br><span class="line">1000000</span><br><span class="line"></span><br><span class="line"><span class="comment">#expr 命令：只能做整数运算，格式比较古板，注意空格</span></span><br><span class="line">[root@lemon ~]<span class="comment"># expr 1 + 1</span></span><br><span class="line">2</span><br><span class="line">[root@lemon ~]<span class="comment"># expr 5 - 2</span></span><br><span class="line">3</span><br><span class="line">[root@lemon ~]<span class="comment"># expr 5 \* 2  #注意*出现应该转义，否则认为是通配符</span></span><br><span class="line">10</span><br><span class="line">[root@lemon ~]<span class="comment"># expr 5 / 2</span></span><br><span class="line">2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#使用bc计算器处理浮点运算，scale=2代表小数点保留两位</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo &quot;scale=2; 100 + 3&quot; | bc</span></span><br><span class="line">103</span><br><span class="line">[root@lemon ~]<span class="comment"># echo &quot;scale=2; 100 - 3&quot; | bc</span></span><br><span class="line">97</span><br><span class="line">[root@lemon ~]<span class="comment"># echo &quot;scale=2; 100 * 3&quot; | bc</span></span><br><span class="line">300</span><br><span class="line">[root@lemon ~]<span class="comment"># echo &quot;scale=2; 100 / 3&quot; | bc</span></span><br><span class="line">33.33</span><br></pre></td></tr></table></figure>

<h1 id="shell格式化输出"><a href="#shell格式化输出" class="headerlink" title="shell格式化输出"></a>shell格式化输出</h1><ul>
<li>echo 命令</li>
<li>颜色输出</li>
</ul>
<p><strong>一个程序需要有0个或以上输入，一个或更多输出</strong></p>
<h2 id="一、echo-命令介绍"><a href="#一、echo-命令介绍" class="headerlink" title="一、echo 命令介绍"></a>一、echo 命令介绍</h2><ul>
<li><p><em><strong>功能：将内容输出到默认显示设备</strong></em></p>
<ul>
<li>echo命令的功能是在显示器上显示一段文字，一般起到一个提示的作用。 功能说明:显示文字。</li>
<li>补充说明:echo会将输入的字符串送往标准输出。输出的字符串间以空白字符隔开,并在 最后加上换行号。</li>
</ul>
</li>
<li><p><em><strong>命令选项：</strong></em></p>
<ul>
<li><p>–help 显示帮助–version显示版本信息</p>
</li>
<li><p>-n 不要在最后自动换行</p>
</li>
<li><p>-e 若字符串中出现以下特殊字符，则特别加以处理，而不会将它当成一般文字输出:</p>
<ul>
<li>\t 插入tab;</li>
<li>\n 换行且光标移至行首;</li>
<li>\a 发出警告声;</li>
<li>\c 忽略掉这个参数之后的任何字符信息；<ul>
<li>\r 输出回车后的内容信息;</li>
</ul>
</li>
<li>\v 换行但光标仍旧停留在原来的位置;与\f相同;</li>
</ul>
</li>
</ul>
</li>
<li><p><em><strong>举例说明：</strong></em></p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># \n</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo -e &quot;lemon\nhandsome&quot;</span></span><br><span class="line">lemon</span><br><span class="line">handsome</span><br><span class="line"></span><br><span class="line"><span class="comment"># \t</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo -e &quot;lemon\thandsome&quot;</span></span><br><span class="line">lemon	handsome</span><br><span class="line"></span><br><span class="line"><span class="comment"># \c</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo -e &quot;lemon\chandsome&quot;</span></span><br><span class="line">lemon[root@lemon-min ~]<span class="comment"># </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># \r</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo -e &quot;lemo\rnhandsome&quot;</span></span><br><span class="line">nhandsome</span><br><span class="line"></span><br><span class="line"><span class="comment"># \v</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo -e &quot;lemon\vhandsome&quot;</span></span><br><span class="line">lemon</span><br><span class="line">     handsome</span><br></pre></td></tr></table></figure>

<h2 id="二、颜色代码"><a href="#二、颜色代码" class="headerlink" title="二、颜色代码"></a>二、颜色代码</h2><blockquote>
<p>脚本中echo显示内容带颜色显示,echo显示带颜色，需要使用参数  <code>-e</code></p>
<p><em><strong>示例如下：</strong></em></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">下面是相应的字和背景颜色，可以自己来尝试找出不同颜色搭配</span><br><span class="line">　　echo -e &quot;\033[31m 红色字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[34m 黄色字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[41;33m 红底黄字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[41;37m 红底白字 \033[0m&quot;</span><br><span class="line">　　</span><br><span class="line">字颜色：30—–37</span><br><span class="line">　　echo -e &quot;\033[30m 黑色字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[31m 红色字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[32m 绿色字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[33m 黄色字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[34m 蓝色字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[35m 紫色字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[36m 天蓝字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[37m 白色字 \033[0m&quot;</span><br><span class="line">　　</span><br><span class="line">字背景颜色范围：40—–47</span><br><span class="line">　　echo -e &quot;\033[40;37m 黑底白字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[41;37m 红底白字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[42;37m 绿底白字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[43;37m 黄底白字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[44;37m 蓝底白字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[45;37m 紫底白字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[46;37m 天蓝底白字 \033[0m&quot;</span><br><span class="line">　　echo -e &quot;\033[47;30m 白底黑字 \033[0m&quot;</span><br><span class="line">　　</span><br><span class="line">最后面控制选项说明</span><br><span class="line">　　\033[0m 关闭所有属性</span><br><span class="line">　　\033[1m 设置高亮度</span><br><span class="line">　　\033[4m 下划线</span><br><span class="line">　　\033[5m 闪烁</span><br><span class="line">　　\033[7m 反显</span><br><span class="line">　　\033[8m 消隐</span><br><span class="line"></span><br><span class="line">设置前景色</span><br><span class="line">　　\033[40m — \33[47m 设置背景色</span><br><span class="line">　　\033[nA 光标上移n行</span><br><span class="line">　　\033[nB 光标下移n行</span><br><span class="line">　　\033[nC 光标右移n行</span><br><span class="line">　　\033[nD 光标左移n行</span><br><span class="line">　　\033[y;xH设置光标位置</span><br><span class="line">　　\033[2J 清屏</span><br><span class="line">　　\033[K 清除从光标到行尾的内容</span><br><span class="line">　　\33[s 保存光标位置</span><br><span class="line">　　\033[u 恢复光标位置</span><br><span class="line">　　\033[?25l 隐藏光标</span><br><span class="line">　　\033[?25h 显示光标</span><br></pre></td></tr></table></figure>

<h1 id="shell交互输入定义变量"><a href="#shell交互输入定义变量" class="headerlink" title="shell交互输入定义变量"></a>shell交互输入定义变量</h1><h2 id="一、read基本命令"><a href="#一、read基本命令" class="headerlink" title="一、read基本命令"></a>一、read基本命令</h2><ul>
<li><p><em><strong>默认接受键盘的输入，回车符代表输入结束</strong></em></p>
</li>
<li><p><em><strong>read 命令选项：</strong></em></p>
<ul>
<li>-p 打印信息</li>
<li>-t  交互停留的时间</li>
<li>-s 隐藏在外面输入值的信息</li>
<li>-n 限制输入字符个数</li>
</ul>
</li>
</ul>
<h2 id="二、read-基本示例"><a href="#二、read-基本示例" class="headerlink" title="二、read 基本示例"></a>二、read 基本示例</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim read.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">clear</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Centos linux 7 (Core)&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;Kernel `uname -r` an `uname -m`&quot;</span></span><br><span class="line"><span class="built_in">read</span> -n 6 -p <span class="string">&quot;login:&quot;</span> user</span><br><span class="line"><span class="built_in">read</span> -n 6 -t 10 -s -p <span class="string">&quot;Passd:&quot;</span> passwd</span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;login:<span class="variable">$user</span>\nPassd:<span class="variable">$passwd</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行此脚本</span></span><br><span class="line">[root@lemon ~]<span class="comment"># bash read.sh</span></span><br><span class="line">Centos linux 7 (Core)</span><br><span class="line">Kernel 3.10.0-693.el7.x86_64 an x86_64</span><br><span class="line">login:lemon</span><br><span class="line">Passd:</span><br><span class="line">login:lemon</span><br><span class="line">Passd:123123</span><br></pre></td></tr></table></figure>

<h1 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h1><ul>
<li>变量介绍</li>
<li>变量分类</li>
<li>变量管理</li>
</ul>
<h2 id="一、变量介绍"><a href="#一、变量介绍" class="headerlink" title="一、变量介绍"></a>一、变量介绍</h2><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在编程中，我们总有一些数据需要临时存放在内存，以待后续使用时快速读出。内存在系统启动的时候被按照<span class="number">1</span>B一个单位划分为若干个块，然后统一编号<span class="comment">(16进制编号)</span>，并对内存的使用情况做记录，保存在内存跟踪表中。</span><br></pre></td></tr></table></figure>

<ul>
<li><em><strong>那么问题来了，1G内存有多少个1B的单位呢？</strong></em></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">计算机的单位:</span><br><span class="line">1B=8bit</span><br><span class="line">1KB=1024B</span><br><span class="line">1MB=1024KB</span><br><span class="line">1GB=1024MB</span><br><span class="line">1TB=1024GB</span><br><span class="line">1PB=1024TB</span><br><span class="line">1EB=1024PB</span><br><span class="line">1ZB=1024EB</span><br><span class="line">...</span><br><span class="line">好了，已经够大了！当然还有YB、BB更大的单位，同样进制也是1024.</span><br><span class="line"></span><br><span class="line">1G=1024*1024*1024=1073741824B</span><br></pre></td></tr></table></figure>

<blockquote>
<p>假如你将一个1B的字符存入内存，如何读出呢？有没有一种大海捞针的感觉啊！我们讨论一下计算机是如何通过让我们快速将数据存在内存，如何从内存中读出数据的。我们研究过变量后就明白了。</p>
</blockquote>
<ul>
<li><p><em><strong>变量：变量是编程中最常用的一种临时在内存中存取数据的一种方式。</strong></em></p>
</li>
<li><p><em><strong>变量存取原理</strong></em></p>
<p><img src="https://bucket-1301203199.cos.ap-shanghai.myqcloud.com/armin/008i3skNly1gricw9vbxzj315l0ksgm8.jpg" alt="image-20200605145747872"></p>
</li>
<li><p><strong>从图片可以看出，当我们在脚本中定义变量存值的时候，可以从以下方面看到变化：</strong></p>
<ul>
<li><p>内存占用：如果存的是一个字符则占用1个字节，如果存的是字符串则是字符串的长度加1个字节长度(\0是一个特殊字符，代表字符串结束)。</p>
</li>
<li><p>变量名与内存空间关系：计算机中会将对应的内存空间和变量名称绑定在一起，此时代表这段内存空间已经被程序占用，其他程序不可复用；然后将变量名对应的值存在对应内存地址的空间里。</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 理解变量存储：STRING1=&quot;ABC&quot;</span></span><br><span class="line">1）0X5...0X8(物理地址) &lt;===&gt; STRING1(逻辑地址) &lt;===&gt; 存取数据(ABC)</span><br><span class="line">         0x5...0x8是内存物理地址，是计算机寻址的依据；</span><br><span class="line">         STRING1是给人看的，方便人记忆；</span><br><span class="line"></span><br><span class="line">2）对于人来说STRING1上存的数据是ABC，对于计算机来说数据是存在物理地址上的；</span><br><span class="line"></span><br><span class="line">3）在建立变量的时候计算机自动将逻辑地址(变量名)和物理地址做了对应。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#变量读出</span></span><br><span class="line">1）当调用STRING1的时候，计算机会根据对应关系，找到物理地址</span><br><span class="line"></span><br><span class="line">2）定位内存地址，读出数据并返回</span><br></pre></td></tr></table></figure>

<h2 id="二、变量分类"><a href="#二、变量分类" class="headerlink" title="二、变量分类"></a>二、变量分类</h2><blockquote>
<p><strong>注意事项：一定要按顺序写位置变量名！比如：$1 $2 $3 $4 $5 $6，如果位置变量用到两位数或多位数的话就用{}括上；比如：echo ‘$10 是’ ${10}；如果不加就会出现问题！</strong></p>
</blockquote>
<ol>
<li><em><strong>本地变量：</strong></em>用户私有变量，只有本用户可以使用，保存在家目录下的.bash_profile、.bashrc文件中</li>
<li><em><strong>全局变量：</strong></em>所有用户都可以使用，保存在/etc/profile、/etc/bashrc文件，可使用 <code>export</code> 命令查看系统变量</li>
<li><em><strong>用户自定义变量：</strong></em>用户自定义，比如脚本中的变量</li>
<li><em><strong>位置变量：</strong></em>可以放在任何位置的变量，$1、$2、$3……</li>
</ol>
<p><strong>案例解释</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 准备脚本</span></span><br><span class="line">[root@lemon ~]<span class="comment"># vim envd.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;我是$1:&#x27;</span> <span class="variable">$1</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;我是$2:&#x27;</span> <span class="variable">$2</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;我是$3:&#x27;</span> <span class="variable">$3</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;我是$4:&#x27;</span> <span class="variable">$4</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;我是$5:&#x27;</span> <span class="variable">$5</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;我是$6:&#x27;</span> <span class="variable">$6</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;我是$7:&#x27;</span> <span class="variable">$7</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;我是$8:&#x27;</span> <span class="variable">$8</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;我是$9:&#x27;</span> <span class="variable">$9</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;我是$10:&#x27;</span> <span class="variable">$&#123;10&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行此脚本</span></span><br><span class="line">[root@lemon ~]<span class="comment"># bash envd.sh q w e r t y u i o p</span></span><br><span class="line">我是<span class="variable">$1</span>: q</span><br><span class="line">我是<span class="variable">$2</span>: w</span><br><span class="line">我是<span class="variable">$3</span>: e</span><br><span class="line">我是<span class="variable">$4</span>: r</span><br><span class="line">我是<span class="variable">$5</span>: t</span><br><span class="line">我是<span class="variable">$6</span>: y</span><br><span class="line">我是<span class="variable">$7</span>: u</span><br><span class="line">我是<span class="variable">$8</span>: i</span><br><span class="line">我是<span class="variable">$9</span>: o</span><br><span class="line">我是<span class="variable">$10</span>: p</span><br></pre></td></tr></table></figure>

<ol start="5">
<li><p><em><strong>预定义变量：</strong></em>$0、$#、$*、$?</p>
<ul>
<li><p>$?：上一条命令执行后返回的状态，当返回状态值为0时表示执行正常，非0值表示执行异常或出错</p>
</li>
<li><p>$#：命令行中位置变量的个数</p>
</li>
<li><p>$0：当前执行的进程/程序名</p>
</li>
<li><p>$*：所有位置变量的内容，$@ 和 $*差不多。但是注意，他俩是有区别的！！！</p>
<ul>
<li><em>使用如下的脚本查看 $@ 和  $* 的区别</em></li>
</ul>
</li>
</ul>
</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 准备脚本</span></span><br><span class="line">[root@lemon ~]<span class="comment"># vim envd.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;我是--&gt;<span class="variable">$1</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;我是--&gt;<span class="variable">$2</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;我是--&gt;<span class="variable">$3</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;==================================&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&quot;$*&quot;</span>;<span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$i</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;==================================&#x27;</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span>;<span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$y</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;==================================&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行脚本</span></span><br><span class="line">[root@lemon ~]<span class="comment"># sh envd.sh a1 a2 a3</span></span><br><span class="line">我是--&gt;a1</span><br><span class="line">我是--&gt;a2</span><br><span class="line">我是--&gt;a3</span><br><span class="line">==================================</span><br><span class="line">a1 a2 a3</span><br><span class="line">==================================</span><br><span class="line">a1</span><br><span class="line">a2</span><br><span class="line">a3</span><br><span class="line">==================================</span><br></pre></td></tr></table></figure>

<p><strong>案例解释：</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 准备脚本</span></span><br><span class="line">[root@lemon ~]<span class="comment"># vim envd.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;我是--&gt;<span class="variable">$1</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;我是--&gt;<span class="variable">$2</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;我是--&gt;<span class="variable">$3</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;$?&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$#</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;$*&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$0</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行脚本</span></span><br><span class="line">[root@lemon ~]<span class="comment"># bash envd.sh a1 a2 a3</span></span><br><span class="line">我是--&gt;a1</span><br><span class="line">我是--&gt;a2</span><br><span class="line">我是--&gt;a3</span><br><span class="line">0</span><br><span class="line">3</span><br><span class="line">a1 a2 a3</span><br><span class="line">envd.sh</span><br></pre></td></tr></table></figure>

<h2 id="三、使用变量"><a href="#三、使用变量" class="headerlink" title="三、使用变量"></a>三、使用变量</h2><h3 id="1-定义变量"><a href="#1-定义变量" class="headerlink" title="1. 定义变量"></a>1. 定义变量</h3><ul>
<li><p><em><strong>变量格式： 变量名=值</strong></em></p>
</li>
<li><p><em><strong>在shell编程中的变量名和等号之间不能有空格。</strong></em></p>
</li>
<li><p><em><strong>变量名命名规则：</strong></em></p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 命名只能使用英文字母，数字和下划线，首个字符不能以数字开头。</span></span><br><span class="line"><span class="comment"># 中间不能有空格，可以使用下划线（_）。</span></span><br><span class="line"><span class="comment"># 不能使用标点符号。</span></span><br><span class="line"><span class="comment"># 不能使用bash里的关键字（可用help命令查看保留关键字）。</span></span><br></pre></td></tr></table></figure>

<ul>
<li><em><strong>定义变量演示：</strong></em></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 变量赋值，此种方法设置为本地变量</span></span><br><span class="line">[root@lemon ~]<span class="comment"># name=&#x27;lemon&#x27;</span></span><br><span class="line">[root@lemon ~]<span class="comment"># pass=&#x27;12345&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-读取变量内容"><a href="#2-读取变量内容" class="headerlink" title="2. 读取变量内容"></a>2. 读取变量内容</h3><ul>
<li><em><strong>读取方法：$变量名</strong></em></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 变量内容读出</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo $name</span></span><br><span class="line">lemon</span><br><span class="line">[root@lemon ~]<span class="comment"># echo $age</span></span><br><span class="line">12345</span><br></pre></td></tr></table></figure>

<h3 id="3-取消变量-unset"><a href="#3-取消变量-unset" class="headerlink" title="3. 取消变量  unset"></a>3. 取消变量  unset</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># unset name</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo $name</span></span><br></pre></td></tr></table></figure>

<h3 id="4-定义全局变量-export"><a href="#4-定义全局变量-export" class="headerlink" title="4. 定义全局变量 export"></a>4. 定义全局变量 export</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># export name=&#x27;lemon&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><em>上述设置的变量其实都是一次性的变量，系统重启就会丢失。</em></li>
<li><em>如果希望本地变量或者全局变量可以永久使用，可以将需要设置的变量写入变量文件中即可。</em></li>
</ul>
<h3 id="5-定义永久变量"><a href="#5-定义永久变量" class="headerlink" title="5. 定义永久变量"></a>5. 定义永久变量</h3><ul>
<li><p><em><strong>本地变量：</strong></em>用户私有变量，只有本用户可以使用，保存在家目录下的.bash_profile、.bashrc文件中</p>
</li>
<li><p><em><strong>全局变量：</strong></em>所有用户都可以使用，保存在/etc/profile、/etc/bashrc文件中</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 本地变量</span></span><br><span class="line">[root@lemon ~]<span class="comment"># tail -1 .bash_profile</span></span><br><span class="line"><span class="built_in">export</span> name=<span class="string">&#x27;lemon&#x27;</span></span><br><span class="line">[root@lemon ~]<span class="comment"># source .bash_profile</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 全局变量</span></span><br><span class="line">[root@lemon ~]<span class="comment"># tail -1 /etc/profile</span></span><br><span class="line"><span class="built_in">export</span> age=18</span><br><span class="line">[root@lemon ~]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>

<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><ul>
<li>数组介绍</li>
<li>基本数组</li>
<li>关联数组</li>
<li>案列分享</li>
</ul>
<h2 id="一、数组介绍"><a href="#一、数组介绍" class="headerlink" title="一、数组介绍"></a>一、数组介绍</h2><ul>
<li><p>概述：数组就是一组数据类型相同集合</p>
</li>
<li><p><em>一个变量只能存一个值，但是现实中又很多值需要存储，那么变量就有些拘谨了。比如做一个学员信息表，一个班50个人，每个人6条信息，我们需要定义300个变量才能完成。恐怖恐怖，这只是一个班的学生，一个学校呢？一个市呢？……我想静静了！</em></p>
</li>
<li><p><em>仔细想想上述的案例，一个学生六个信息：ID、姓名、性别、年龄、成绩、班级。可不可以定义六个变量就能存储这六类信息呢？答案是当然可以的！但变量不行，我们可以用数组。</em></p>
</li>
</ul>
<h2 id="二、基本数组"><a href="#二、基本数组" class="headerlink" title="二、基本数组"></a>二、基本数组</h2><blockquote>
<p><strong>数组可以让用户一次赋予多个值，需要读取数据时只需通过索引调用就可以方便读出了。</strong></p>
</blockquote>
<h3 id="1-数组语法"><a href="#1-数组语法" class="headerlink" title="1. 数组语法"></a>1. 数组语法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">数组名称=()                             <span class="comment">#定义空元素的数组</span></span><br><span class="line">数组名称=(元素1 元素2 元素3 ...)         <span class="comment">#定义有元素的数组</span></span><br></pre></td></tr></table></figure>

<h3 id="2-数组读出"><a href="#2-数组读出" class="headerlink" title="2. 数组读出"></a>2. 数组读出</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;数组名称[索引]&#125;</span></span><br><span class="line">索引默认是元素在数组中的排队编号，默认第一个从<span class="number">0</span>开始</span><br></pre></td></tr></table></figure>

<h3 id="3-数组赋值"><a href="#3-数组赋值" class="headerlink" title="3. 数组赋值"></a>3. 数组赋值</h3><ul>
<li><em>数组赋值格式：数组名[下标]=值，下标不存在，则新增数组元素; 下标已有，则覆盖值。</em></li>
</ul>
<h4 id="方法1：一次赋一个值"><a href="#方法1：一次赋一个值" class="headerlink" title="方法1：一次赋一个值"></a>方法1：一次赋一个值</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># array1[0]=&#x27;tom&#x27;</span></span><br><span class="line">[root@lemon ~]<span class="comment"># array1[1]=&#x27;jarry&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="方法2：一次赋多个值"><a href="#方法2：一次赋多个值" class="headerlink" title="方法2：一次赋多个值"></a>方法2：一次赋多个值</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># array2=(tom jack alice &quot;bash shell&quot;)     #linux默认都是字符串类型数据</span></span><br><span class="line">[root@lemon ~]<span class="comment"># array3=(`cat /etc/passwd`)               #希望是将该文件中的每一个行作为一                                                          个元素赋值给数组array3</span></span><br></pre></td></tr></table></figure>

<h3 id="4-查看基本数组-a"><a href="#4-查看基本数组-a" class="headerlink" title="4. 查看基本数组-a"></a>4. 查看基本数组<code>-a</code></h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看数组</span></span><br><span class="line">[root@lemon ~]<span class="comment"># declare -a</span></span><br></pre></td></tr></table></figure>

<h3 id="5-访问数组元素"><a href="#5-访问数组元素" class="headerlink" title="5. 访问数组元素"></a>5. 访问数组元素</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># echo $&#123;array1[0]&#125;        #访问数组中的第一个元素</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo $&#123;array1[*]&#125;        #访问数组中所有元素  等同于 echo $&#123;array1[@]&#125;</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo $&#123;#array1[*]&#125;       #统计数组元素的个数</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo $&#123;!array2[*]&#125;       #获取数组元素中的所有索引</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo $&#123;array1[*]:1&#125;      #从数组下标1开始</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo $&#123;array1[*]:1:2&#125;    #从数组下标1开始，访问两个元素</span></span><br></pre></td></tr></table></figure>

<h3 id="6-遍历数组"><a href="#6-遍历数组" class="headerlink" title="6. 遍历数组"></a>6. 遍历数组</h3><ul>
<li><em>默认数组通过数组元素的个数进行遍历</em></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># for i in `echo $&#123;array1[*]&#125;`;do echo $i; done</span></span><br><span class="line">pear</span><br><span class="line">apple</span><br><span class="line">orange</span><br><span class="line">peach</span><br></pre></td></tr></table></figure>

<h2 id="三、关联数组"><a href="#三、关联数组" class="headerlink" title="三、关联数组"></a>三、关联数组</h2><h3 id="1-定义关联数组"><a href="#1-定义关联数组" class="headerlink" title="1. 定义关联数组"></a>1. 定义关联数组</h3><ul>
<li><em>申明关联数组变量</em></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># declare -A ass_array1</span></span><br><span class="line">[root@lemon ~]<span class="comment"># declare -A ass_array2</span></span><br></pre></td></tr></table></figure>

<h3 id="2-关联数组赋值"><a href="#2-关联数组赋值" class="headerlink" title="2. 关联数组赋值"></a>2. 关联数组赋值</h3><h4 id="方法1：一次赋一个值-1"><a href="#方法1：一次赋一个值-1" class="headerlink" title="方法1：一次赋一个值"></a>方法1：一次赋一个值</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># ass_array1[index1]=pear</span></span><br><span class="line">[root@lemon ~]<span class="comment"># ass_array1[index2]=apple</span></span><br><span class="line">[root@lemon ~]<span class="comment"># ass_array1[index3]=orange</span></span><br><span class="line">[root@lemon ~]<span class="comment"># ass_array1[index4]=peach</span></span><br></pre></td></tr></table></figure>

<h4 id="方法2：一次赋多个值-1"><a href="#方法2：一次赋多个值-1" class="headerlink" title="方法2：一次赋多个值"></a>方法2：一次赋多个值</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># ass_array2=([index1]=tom [index2]=jack [index3]=alice [index4]=&#x27;tool&#x27;)</span></span><br></pre></td></tr></table></figure>

<h3 id="3-查看关联数组-A"><a href="#3-查看关联数组-A" class="headerlink" title="3. 查看关联数组-A"></a>3. 查看关联数组<code>-A</code></h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># declare -A</span></span><br></pre></td></tr></table></figure>

<h3 id="4-访问数组元素"><a href="#4-访问数组元素" class="headerlink" title="4. 访问数组元素"></a>4. 访问数组元素</h3><blockquote>
<p>@ 等同于 *</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># echo $&#123;ass_array2[index2]&#125;   #访问数组中的第二个元数 </span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo $&#123;ass_array2[*]&#125;        #访问数组中所有元数  等同于 echo $&#123;array1[@]&#125;</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo $&#123;#ass_array2[*]&#125;       #获得数组元素的个数</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo $&#123;!ass_array2[*]&#125;       #获得数组元素的全部索引</span></span><br></pre></td></tr></table></figure>

<h3 id="5-遍历数组"><a href="#5-遍历数组" class="headerlink" title="5. 遍历数组"></a>5. 遍历数组</h3><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]# <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">`echo $&#123;ass_array2[*]&#125;`</span>;<span class="keyword">do</span> echo $i; done</span><br><span class="line">tool</span><br><span class="line">tom</span><br><span class="line">jack</span><br><span class="line">alice</span><br></pre></td></tr></table></figure>

<h3 id="6-简单的学员信息系统"><a href="#6-简单的学员信息系统" class="headerlink" title="6. 简单的学员信息系统"></a>6. 简单的学员信息系统</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> ((i=0;i&lt;3;i++));<span class="keyword">do</span></span><br><span class="line">      <span class="built_in">read</span> -p <span class="string">&quot;输入第<span class="subst">$((i + 1)</span>)个人名: &quot;</span> name[<span class="variable">$i</span>]</span><br><span class="line">      <span class="built_in">read</span> -p <span class="string">&quot;输入第$[<span class="variable">$i</span> + 1]个年龄: &quot;</span> age[<span class="variable">$i</span>]</span><br><span class="line">      <span class="built_in">read</span> -p <span class="string">&quot;输入第`expr <span class="variable">$i</span> + 1`个性别: &quot;</span> gender[<span class="variable">$i</span>]</span><br><span class="line">      <span class="built_in">echo</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">clear</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\t\t\t\t\t\t学员查询系统&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span>;<span class="keyword">do</span></span><br><span class="line">      cp=0</span><br><span class="line">      <span class="built_in">read</span> -p <span class="string">&quot;输入要查询的姓名: &quot;</span> xm</span><br><span class="line">      [ <span class="variable">$xm</span> == <span class="string">&quot;q&quot;</span> ] &amp;&amp; <span class="built_in">exit</span></span><br><span class="line">      <span class="keyword">for</span> ((i=0;i&lt;3;i++));<span class="keyword">do</span></span><br><span class="line">          <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$xm</span>&quot;</span> == <span class="string">&quot;<span class="variable">$&#123;name[$i]&#125;</span>&quot;</span> ];<span class="keyword">then</span></span><br><span class="line">              <span class="built_in">echo</span> -e <span class="string">&quot;name: <span class="variable">$&#123;name[$i]&#125;</span>\nage: <span class="variable">$&#123;age[$i]&#125;</span>\ngender: <span class="variable">$&#123;gender[$i]&#125;</span>&quot;</span></span><br><span class="line">              cp=1</span><br><span class="line">          <span class="keyword">fi</span></span><br><span class="line">      <span class="keyword">done</span></span><br><span class="line">      [ <span class="variable">$cp</span> -eq 0 ]&amp;&amp;<span class="built_in">echo</span> <span class="string">&quot;not found student&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h1 id="shell流程控制-if判断语句"><a href="#shell流程控制-if判断语句" class="headerlink" title="shell流程控制-if判断语句"></a>shell流程控制-if判断语句</h1><ul>
<li>shell中的四大运算</li>
<li>if语法</li>
<li>在写程序的时候，时常会对上一步执行是否成功如何判断苦恼，当我们今天学习了if就可以解决你的苦恼。</li>
<li>if语句在我们程序中就是用来做判断的，不管学习的是什么语言，以后只要涉及到判断的部分，都可以直接拿if来使用，不同的语言之间的if只是语法不同，原理是相同的。</li>
</ul>
<h2 id="一、shell中的运算"><a href="#一、shell中的运算" class="headerlink" title="一、shell中的运算"></a>一、shell中的运算</h2><h3 id="1-数学比较运算"><a href="#1-数学比较运算" class="headerlink" title="1. 数学比较运算"></a>1. 数学比较运算</h3><ul>
<li><em><strong>示例：</strong></em></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">-eq    <span class="comment">#等于</span></span><br><span class="line">[root@lemon ~]<span class="comment"># [ 9 -eq 10 ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@lemon ~]<span class="comment"># [ 10 -eq 10 ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">-gt    <span class="comment">#大于</span></span><br><span class="line">[root@lemon ~]<span class="comment"># [ 10 -gt 10 ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@lemon ~]<span class="comment"># [ 11 -gt 10 ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">-lt    <span class="comment">#小于</span></span><br><span class="line">[root@lemon ~]<span class="comment"># [ 9 -lt 10 ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ 10 -lt 10 ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">-ge    <span class="comment">#大于或等于</span></span><br><span class="line">[root@lemon ~]<span class="comment"># [ 9 -ge 10 ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@lemon ~]<span class="comment"># [ 11 -ge 10 ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ 10 -ge 10 ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">-le    <span class="comment">#小于或等于</span></span><br><span class="line">[root@lemon ~]<span class="comment"># [ 9 -le 10 ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ 10 -le 10 ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ 11 -le 10 ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">-ne    <span class="comment">#不等于</span></span><br><span class="line">[root@lemon ~]<span class="comment"># [ 9 -ne 10 ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ 10 -ne 10 ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@lemon ~]<span class="comment"># [ 11 -ne 10 ] ; echo $?</span></span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<h3 id="2-字符串比较运算"><a href="#2-字符串比较运算" class="headerlink" title="2. 字符串比较运算"></a>2. 字符串比较运算</h3><ul>
<li><p><em><strong>注意字符串，一定别忘了使用引号引起来</strong></em></p>
</li>
<li><p><em><strong>示例：</strong></em></p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">==    <span class="comment">#等于，也可以指写一个 = 号</span></span><br><span class="line">[root@lemon ~]<span class="comment"># [ &#x27;lemon&#x27; == &#x27;lemon&#x27; ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ &#x27;lemon&#x27; == &#x27;tom&#x27; ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">!=    <span class="comment">#不等于</span></span><br><span class="line">[root@lemon ~]<span class="comment"># [ &#x27;lemon&#x27; != &#x27;lemon&#x27; ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@lemon ~]<span class="comment"># [ &#x27;lemon&#x27; != &#x27;tom&#x27; ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">-z    <span class="comment">#检查字符串的长度是否为空，加上!号就是取反 ! -z</span></span><br><span class="line">[root@lemon ~]<span class="comment"># echo &quot;$name&quot;</span></span><br><span class="line">lemon</span><br><span class="line">[root@lemon ~]<span class="comment"># echo &quot;$named&quot;</span></span><br><span class="line"></span><br><span class="line">[root@lemon ~]<span class="comment"># [ -z $name ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@lemon ~]<span class="comment"># [ -z $named ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ ! -z $name ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ ! -z $named ] ; echo $?</span></span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<h3 id="3-文件比较与检查"><a href="#3-文件比较与检查" class="headerlink" title="3. 文件比较与检查"></a>3. 文件比较与检查</h3><ul>
<li><em><strong>示例：</strong></em></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">-e     <span class="comment">#检查目录及文件是否存在</span></span><br><span class="line">[root@lemon ~]<span class="comment"># [ -e /etc ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ -e /etc/passwd ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ -e /etcc ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@lemon ~]<span class="comment"># [ -e /etcc/passwd ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">-d    <span class="comment">#检查文件是否存在且为目录</span></span><br><span class="line">[root@lemon ~]<span class="comment"># [ -d /etc ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ -d /tom ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">-f    <span class="comment">#检查文件是否存在且为文件</span></span><br><span class="line">[root@lemon ~]<span class="comment"># [ -f /etc/passwd ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ -f /etc/file ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">-nt    <span class="comment">#检查file1是否比file2新，按照时间比对的</span></span><br><span class="line">[root@lemon opt]<span class="comment"># ll -h *</span></span><br><span class="line">-rw-r--r-- 1 root root 0 6月   5 21:21 lemon.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 6月   5 21:28 tools.txt</span><br><span class="line">[root@lemon opt]<span class="comment"># [ lemon.txt -nt tools.txt ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@lemon opt]<span class="comment"># [ tools.txt -nt lemon.txt ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">-ot    <span class="comment">#检查file1是否比file2旧，按照时间比对的</span></span><br><span class="line">[root@lemon opt]<span class="comment"># ll -h *</span></span><br><span class="line">-rw-r--r-- 1 root root 0 6月   5 21:21 lemon.txt</span><br><span class="line">-rw-r--r-- 1 root root 0 6月   5 21:28 tools.txt</span><br><span class="line">[root@lemon opt]<span class="comment"># [ lemon.txt -ot tools.txt ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon opt]<span class="comment"># [ tools.txt -ot lemon.txt ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">-s    <span class="comment">#检查目录及文件是否存在且不为空</span></span><br><span class="line">[root@lemon ~]<span class="comment"># [ -s /etc/passwd ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ -s /etc ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ -s /etcc/passwd ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@lemon ~]<span class="comment"># [ -s /etcc ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">-O    <span class="comment">#检查文件是否存在并且被当前用户拥有</span></span><br><span class="line">测试省略……</span><br><span class="line"></span><br><span class="line">-G    <span class="comment">#检查文件是否存在并且默认组为当前用户组</span></span><br><span class="line">测试省略……</span><br><span class="line"></span><br><span class="line">-r    <span class="comment">#检查文件是否存在且可读</span></span><br><span class="line">测试省略……</span><br><span class="line"></span><br><span class="line">-w    <span class="comment">#检查文件是否存在且可写</span></span><br><span class="line">测试省略……</span><br><span class="line"></span><br><span class="line">-x    <span class="comment">#检查文件是否存在且可执行</span></span><br><span class="line">测试省略……</span><br></pre></td></tr></table></figure>

<h3 id="4-逻辑运算"><a href="#4-逻辑运算" class="headerlink" title="4. 逻辑运算"></a>4. 逻辑运算</h3><ul>
<li><em><strong>逻辑运算注意事项：</strong></em><ul>
<li><em>逻辑与 或 运算都需要两个或以上条件，逻辑非运算只能一个条件。</em></li>
<li><em>口诀:</em><ul>
<li>逻辑与运算       &lt;==&gt;        真真为真   真假为假   假假为假</li>
<li>逻辑或运算       &lt;==&gt;        真真为真   真假为真   假假为假</li>
<li>逻辑非运算       &lt;==&gt;        真为假   假为真</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&amp;&amp;    <span class="comment">#逻辑与运算</span></span><br><span class="line">[root@lemon ~]<span class="comment"># [ 10 -eq 10 ] &amp;&amp; [ &#x27;lemon&#x27; == &#x27;lemon&#x27; ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ 10 -eq 20 ] &amp;&amp; [ &#x27;lemon&#x27; == &#x27;lemon&#x27; ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">||    <span class="comment">#逻辑或运算</span></span><br><span class="line">[root@lemon ~]<span class="comment"># [ 10 -eq 10 ] || [ &#x27;lemon&#x27; == &#x27;lemon&#x27; ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ 10 -eq 20 ] || [ &#x27;lemon&#x27; == &#x27;lemon&#x27; ] ; echo $?</span></span><br><span class="line">0</span><br><span class="line">[root@lemon ~]<span class="comment"># [ 10 -eq 20 ] || [ &#x27;lemon&#x27; == &#x27;tomcc&#x27; ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">!     <span class="comment">#逻辑非运算</span></span><br><span class="line">[root@lemon ~]<span class="comment"># [ ! 10 -eq 10 ] ; echo $?</span></span><br><span class="line">1</span><br><span class="line">[root@lemon ~]<span class="comment"># [ ! 10 -eq 11 ] ; echo $?</span></span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<h2 id="二、if-语法"><a href="#二、if-语法" class="headerlink" title="二、if 语法"></a>二、if 语法</h2><h3 id="1-语法一：-单if语句"><a href="#1-语法一：-单if语句" class="headerlink" title="1. 语法一： 单if语句"></a>1. 语法一： 单if语句</h3><ul>
<li><p>适用范围：只需要一步判断，条件返回真干什么或者条件返回假干什么。</p>
</li>
<li><p>语句格式：</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if [ <span class="keyword">condition</span> ];<span class="keyword">then</span>           #<span class="keyword">condition</span> 值为<span class="literal">true</span> <span class="keyword">or</span> <span class="literal">false</span></span><br><span class="line">   commands</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<ul>
<li>该语句翻译成汉语大意如下：</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">如果条件为真</span><br><span class="line">那么</span><br><span class="line">    执行commands代码块</span><br><span class="line">结束</span><br></pre></td></tr></table></figure>

<ul>
<li>通过一段代码来演示一下</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim if.sh </span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">if</span> [ 10 -eq 10 ];<span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;hello world&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># bash if.sh </span></span><br><span class="line">hello world</span><br></pre></td></tr></table></figure>

<h3 id="2-语法二：-if-else语句"><a href="#2-语法二：-if-else语句" class="headerlink" title="2. 语法二： if-else语句"></a>2. 语法二： if-else语句</h3><ul>
<li>适用范围:两步判断，条件为真干什么，条件为假干什么。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ condition ];<span class="keyword">then</span></span><br><span class="line">   commands1</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   commands2</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<ul>
<li>该语句翻译成汉语大意如下：</li>
</ul>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">如果条件为真</span><br><span class="line">那么</span><br><span class="line">    执行comma<span class="symbol">nds1</span>代码块</span><br><span class="line">否则</span><br><span class="line">    执行comma<span class="symbol">nds2</span>代码块</span><br><span class="line">结束</span><br></pre></td></tr></table></figure>

<ul>
<li>通过一段代码演示一下</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim if.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入数字:&quot;</span> number</span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$number</span> -eq 10 ];<span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;条件为真&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;条件为假&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@lemon</span> ~]<span class="meta"># bash if.sh </span></span><br><span class="line">请输入数字:<span class="number">10</span></span><br><span class="line">条件为真</span><br><span class="line"></span><br><span class="line">[root<span class="symbol">@lemon</span> ~]<span class="meta"># bash if.sh </span></span><br><span class="line">请输入数字:<span class="number">20</span></span><br><span class="line">条件为假</span><br></pre></td></tr></table></figure>

<h3 id="3-语法三-if-elif-else语句"><a href="#3-语法三-if-elif-else语句" class="headerlink" title="3. 语法三: if-elif-else语句"></a>3. 语法三: if-elif-else语句</h3><ul>
<li>适用范围:多于两个以上的判断结果，也就是多于一个以上的判断条件。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ condition 1 ];<span class="keyword">then</span></span><br><span class="line">   commands1</span><br><span class="line"><span class="keyword">elif</span> [ condition 2 ];<span class="keyword">then</span></span><br><span class="line">   commands2</span><br><span class="line">.......</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   commandsX</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<ul>
<li>该语句翻译成汉语大意如下：</li>
</ul>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">如果 条件1 为真</span><br><span class="line"><span class="code">      那么</span></span><br><span class="line"><span class="code">         执行代码块1</span></span><br><span class="line"><span class="code">如果 条件2 为真</span></span><br><span class="line"><span class="code">      那么</span></span><br><span class="line"><span class="code">         执行代码块2</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">以此类推的N个条件及对应的执行代码块</span><br><span class="line"></span><br><span class="line">否则 【以上所有条件中没有一个满足的】</span><br><span class="line"><span class="code">         执行代码块X</span></span><br><span class="line"><span class="code">结束</span></span><br></pre></td></tr></table></figure>

<ul>
<li>通过一段代码演示一下</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim if.sh </span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入数字:&quot;</span> number</span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$number</span> -eq 10 ];<span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;条件 1 为真&quot;</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="variable">$number</span> -gt 10 ];<span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;条件 2 为真&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;以上条件都为假&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># bash if.sh </span></span><br><span class="line">请输入数字:9</span><br><span class="line">以上条件都为假</span><br><span class="line"></span><br><span class="line">[root@lemon ~]<span class="comment"># bash if.sh </span></span><br><span class="line">请输入数字:10</span><br><span class="line">条件 1 为真</span><br><span class="line"></span><br><span class="line">[root@lemon ~]<span class="comment"># bash if.sh </span></span><br><span class="line">请输入数字:11</span><br><span class="line">条件 2 为真</span><br></pre></td></tr></table></figure>

<h2 id="三、if-高级应用"><a href="#三、if-高级应用" class="headerlink" title="三、if 高级应用"></a>三、if 高级应用</h2><blockquote>
<p><em><strong><a target="_blank" rel="noopener" href="https://recomm.cnblogs.com/blogpost/4848736">if 命令, 双圆括号, 双中括号 条件测试</a></strong></em></p>
</blockquote>
<h1 id="循环脚本控制语句"><a href="#循环脚本控制语句" class="headerlink" title="循环脚本控制语句"></a>循环脚本控制语句</h1><h2 id="特殊条件表达式"><a href="#特殊条件表达式" class="headerlink" title="特殊条件表达式"></a>特殊条件表达式</h2><blockquote>
<ul>
<li><p><em><strong>true</strong></em>      #当条件表达式为true时，那么代表条件表达式永远成立，为真； 【条件成立】</p>
</li>
<li><p><em><strong>false</strong></em>     #当条件表达式为false时，那么代表条件表达式永远不成立，为假；【条件不成立】</p>
</li>
</ul>
</blockquote>
<h2 id="测试-continue、break、exit-语句的不同点"><a href="#测试-continue、break、exit-语句的不同点" class="headerlink" title="测试 continue、break、exit 语句的不同点"></a>测试 continue、break、exit 语句的不同点</h2><blockquote>
<p>通俗点讲：break是立马跳出循环；continue是跳出当前条件循环，继续下一轮条件循环；exit是直接退出整个脚本</p>
</blockquote>
<ul>
<li>代码如下</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim test.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..5&#125;;<span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$i</span> -eq 3 ];<span class="keyword">then</span></span><br><span class="line">       <span class="variable">$1</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$i</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;循环体外命令&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># continue</span></span><br><span class="line">[root@lemon ~]<span class="comment"># bash test.sh continue</span></span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">循环体外命令</span><br><span class="line"></span><br><span class="line"><span class="comment"># break</span></span><br><span class="line">[root@lemon ~]<span class="comment"># bash test.sh break</span></span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">循环体外命令</span><br><span class="line"></span><br><span class="line"><span class="comment"># exit</span></span><br><span class="line">[root@lemon ~]<span class="comment"># bash test.sh exit</span></span><br><span class="line">1</span><br><span class="line">2</span><br></pre></td></tr></table></figure>



<h2 id="1-sleep-N-脚本执行到该步休眠N秒"><a href="#1-sleep-N-脚本执行到该步休眠N秒" class="headerlink" title="1. sleep   N   脚本执行到该步休眠N秒"></a>1. sleep   N   脚本执行到该步休眠N秒</h2><ul>
<li><p><em><strong>作用：执行完上一条命令要停留的时间</strong></em></p>
</li>
<li><p>段代如下</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim for.sh </span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `seq 9 -1 1`;<span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> -n -e <span class="string">&quot;倒计时: <span class="variable">$i</span>\r&quot;</span></span><br><span class="line">    sleep 1</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<p><img src="https://bucket-1301203199.cos.ap-shanghai.myqcloud.com/armin/008i3skNly1gsda74t8rpg30kq050q2v.gif" alt="img"></p>
<h2 id="2-continue-跳过循环中的某次循环"><a href="#2-continue-跳过循环中的某次循环" class="headerlink" title="2. continue 跳过循环中的某次循环"></a>2. continue 跳过循环中的某次循环</h2><ul>
<li><p><em><strong>作用：终止本次循环，继续执行下一次的循环</strong></em></p>
</li>
<li><p>代码如下，默认循环输出1-9，但是使用continue跳过输出5</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim for.sh #!/bin/bashfor i in &#123;1..9&#125;;do    if [ $i -eq 5 ];then       continue    else       echo &quot;$i&quot;    fidone</span></span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># bash for.sh 12346789</span></span><br></pre></td></tr></table></figure>

<h2 id="3-break-跳出循环继续执行后续代码"><a href="#3-break-跳出循环继续执行后续代码" class="headerlink" title="3. break 跳出循环继续执行后续代码"></a>3. break 跳出循环继续执行后续代码</h2><ul>
<li><p><em><strong>作用：退出脚本中当前的循环体，继续执行循环体外的命令</strong></em></p>
</li>
<li><p>代码如下，默认循环输出1-9，当输出到5的时候跳出循环</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..9&#125;;<span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$i</span> -eq 6 ];<span class="keyword">then</span></span><br><span class="line">       <span class="built_in">break</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$i</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># bash for.sh </span></span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td></tr></table></figure>

<ul>
<li>break N 跳出某个循环，用在嵌套循环环境，从内循环到外循环依次编号为1-N</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim for.sh </span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#脚本分三步执行</span></span><br><span class="line"><span class="comment">#1.没有break  那么脚本i=1的时候  内循环将无限循环，满屏幕haha</span></span><br><span class="line"><span class="comment">#2.内循环加break  终止内循环 内循环只执行一次 输出就会loop 1   haha   loop2  haha   ....</span></span><br><span class="line"><span class="comment">#3.内循环加break 2 终止外循环 输出loop 1  haha  脚本运行结束</span></span><br><span class="line"><span class="keyword">for</span> (( i=1; i&lt;5; i++ ));<span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;#loop <span class="variable">$i</span>&quot;</span></span><br><span class="line">    <span class="keyword">for</span> ((;;)); <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;haha&quot;</span></span><br><span class="line">        <span class="built_in">break</span> 2</span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">    sleep 3</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># bash for.sh </span></span><br><span class="line"><span class="comment">#loop 1</span></span><br><span class="line">haha</span><br></pre></td></tr></table></figure>

<h2 id="4-exit-退出当前脚本"><a href="#4-exit-退出当前脚本" class="headerlink" title="4. exit  退出当前脚本"></a>4. exit  退出当前脚本</h2><ul>
<li><p><em><strong>作用：直接退出脚本，循环体外的命令不会执行</strong></em></p>
</li>
<li><p>代码如下</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim for.sh </span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..9&#125;;<span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$i</span> == 5 ];<span class="keyword">then</span></span><br><span class="line">       <span class="built_in">exit</span> 2    <span class="comment">#后面的数字就是一个返回值，可用echo $?查看</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$i</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># bash for.sh </span></span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">[root@lemon ~]<span class="comment"># echo $?</span></span><br><span class="line">2</span><br></pre></td></tr></table></figure>

<h1 id="shell流程控制-for循环语句"><a href="#shell流程控制-for循环语句" class="headerlink" title="shell流程控制-for循环语句"></a>shell流程控制-for循环语句</h1><ul>
<li>for循环介绍</li>
<li>for语法</li>
<li>循环控制</li>
</ul>
<blockquote>
<p><strong>脚本在执行任务的时候，总会遇到需要循环执行的时候，比如说我们需要脚本每隔五分钟执行一次ping的操作，除了计划任务，我们还可以使用脚本来完成，那么我们就用到了循环语句。</strong></p>
</blockquote>
<p><em><strong>循环的优点：</strong></em></p>
<ul>
<li>节省内存   10M脚本   1M脚本 哪个更剩内存   完成同一个任务</li>
<li>结构更清晰</li>
<li>节省开发时间成本</li>
</ul>
<h2 id="一、for-循环介绍"><a href="#一、for-循环介绍" class="headerlink" title="一、for 循环介绍"></a>一、for 循环介绍</h2><ul>
<li>for的工作原理</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">很多人把for循环叫做条件循环，或者for <span class="selector-tag">i</span> in 。其实前者说的就是for的特性，for循环的次数和给予的条件是成正比的，也就是你给<span class="number">5</span>个条件，那么他就循环<span class="number">5</span>次；后者说的是for的语法。</span><br></pre></td></tr></table></figure>

<h2 id="二、for语法"><a href="#二、for语法" class="headerlink" title="二、for语法"></a>二、for语法</h2><h3 id="1-for-语法一"><a href="#1-for-语法一" class="headerlink" title="1. for 语法一"></a>1. for 语法一</h3><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for i <span class="keyword">in</span> value1 value2 <span class="params">...</span><span class="params">...</span>;<span class="keyword">do</span></span><br><span class="line">     commands</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<ul>
<li>接下来看段代码吧，循环输出1-9数字</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim for.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `seq 1 9`;<span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;number &lt;==&gt; <span class="variable">$i</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<ul>
<li>代码执行结果:</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># bash for.sh</span></span><br><span class="line">number &lt;==&gt; 1</span><br><span class="line">number &lt;==&gt; 2</span><br><span class="line">number &lt;==&gt; 3</span><br><span class="line">number &lt;==&gt; 4</span><br><span class="line">number &lt;==&gt; 5</span><br><span class="line">number &lt;==&gt; 6</span><br><span class="line">number &lt;==&gt; 7</span><br><span class="line">number &lt;==&gt; 8</span><br><span class="line">number &lt;==&gt; 9</span><br></pre></td></tr></table></figure>

<h3 id="2-for语法二"><a href="#2-for语法二" class="headerlink" title="2. for语法二"></a>2. for语法二</h3><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for <span class="comment">((变量;条件;自增减运算)</span>);<span class="keyword">do</span></span><br><span class="line">    代码块</span><br><span class="line"><span class="keyword">do</span><span class="symbol">ne</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>来段代码理解一下，看下还是输出1-9</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim for.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> ((i=1;<span class="variable">$i</span>&lt;10;i++));<span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;number &lt;==&gt; <span class="variable">$i</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<ul>
<li>代码执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># bash for.sh</span></span><br><span class="line">number &lt;==&gt; 1</span><br><span class="line">number &lt;==&gt; 2</span><br><span class="line">number &lt;==&gt; 3</span><br><span class="line">number &lt;==&gt; 4</span><br><span class="line">number &lt;==&gt; 5</span><br><span class="line">number &lt;==&gt; 6</span><br><span class="line">number &lt;==&gt; 7</span><br><span class="line">number &lt;==&gt; 8</span><br><span class="line">number &lt;==&gt; 9</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>for循环使用多个变量</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim for.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> ((a=0,b=9;<span class="variable">$a</span>&lt;10;a++,b--));<span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;number &lt;==&gt; <span class="variable">$a</span>  <span class="variable">$b</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<ul>
<li>代码执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># bash for.sh</span></span><br><span class="line">number &lt;==&gt; 0  9</span><br><span class="line">number &lt;==&gt; 1  8</span><br><span class="line">number &lt;==&gt; 2  7</span><br><span class="line">number &lt;==&gt; 3  6</span><br><span class="line">number &lt;==&gt; 4  5</span><br><span class="line">number &lt;==&gt; 5  4</span><br><span class="line">number &lt;==&gt; 6  3</span><br><span class="line">number &lt;==&gt; 7  2</span><br><span class="line">number &lt;==&gt; 8  1</span><br><span class="line">number &lt;==&gt; 9  0</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>for 无限循环 使用((;;)) 条件可以实现无线循环</strong></p>
</blockquote>
<ul>
<li>代码如下</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim for.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> ((;;));<span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;hello world&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># bash for.sh</span></span><br><span class="line">hello world</span><br><span class="line">hello world</span><br><span class="line">hello world</span><br><span class="line">hello world</span><br><span class="line">hello world</span><br><span class="line">hello world</span><br><span class="line">hello world</span><br><span class="line">hello world</span><br><span class="line">hello world</span><br><span class="line">hello world</span><br><span class="line">hello world</span><br><span class="line">……………………………</span><br></pre></td></tr></table></figure>

<h1 id="shell流程控制-while循环语句"><a href="#shell流程控制-while循环语句" class="headerlink" title="shell流程控制-while循环语句"></a>shell流程控制-while循环语句</h1><ul>
<li>while循环介绍</li>
<li>while循环语法</li>
<li>while实战</li>
</ul>
<h2 id="一、while循环介绍"><a href="#一、while循环介绍" class="headerlink" title="一、while循环介绍"></a>一、while循环介绍</h2><ul>
<li><em><strong>while的工作原理</strong></em></li>
</ul>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">当程序执行到<span class="keyword">while</span>语句时，首先会计算<span class="keyword">condition</span>的值，如果<span class="keyword">condition</span>的值为假，结束整个<span class="keyword">while</span>语句，如果表达式的值为真，则执行语句，执行完语句再去计算表达式的值，如果表达式的值还为真，则在执行语句.....直到表达式的值为假才会停止，否则一直循环。</span><br></pre></td></tr></table></figure>

<h2 id="二、while循环语法"><a href="#二、while循环语法" class="headerlink" title="二、while循环语法"></a>二、while循环语法</h2><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> [ condition ];<span class="keyword">do</span>      #注意，条件为真<span class="keyword">while</span>才会循环，条件为假，<span class="keyword">while</span>停止循环</span><br><span class="line">      commands</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h2 id="三、while实战"><a href="#三、while实战" class="headerlink" title="三、while实战"></a>三、while实战</h2><h3 id="1-跳板机脚本"><a href="#1-跳板机脚本" class="headerlink" title="1. 跳板机脚本"></a>1. 跳板机脚本</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="function"><span class="title">lemon</span></span>()&#123;</span><br><span class="line">        contiue=$(pgrep -l -u jump|grep <span class="string">&quot;bash&quot;</span>|awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class="line">        <span class="built_in">kill</span> -9 <span class="variable">$contiue</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">trap</span> <span class="string">&quot;&quot;</span> HUP INT QUIT TSTP</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"> <span class="built_in">read</span> -p <span class="string">&quot;andmin:</span></span><br><span class="line"><span class="string">       1).input is sshd server:192.168.1.1;</span></span><br><span class="line"><span class="string">       2).input is sshd server:192.168.1.2;</span></span><br><span class="line"><span class="string">       3).Input to user exit&#x27;s 192.168.1.3;</span></span><br><span class="line"><span class="string">what is to name&#x27;s server:&quot;</span> num</span><br><span class="line">   <span class="keyword">if</span> [[ <span class="variable">$num</span> -eq 1 ]];<span class="keyword">then</span></span><br><span class="line">    ssh root@192.168.1.1</span><br><span class="line"> <span class="keyword">elif</span> [[ <span class="variable">$num</span> -eq 2 ]];<span class="keyword">then</span></span><br><span class="line">    ssh root@192.168.1.2</span><br><span class="line"> <span class="keyword">elif</span> [[ <span class="variable">$num</span> -eq 3 ]];<span class="keyword">then</span></span><br><span class="line">    lemon</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$0</span>语法|1|2|3&quot;</span></span><br><span class="line">    sleep 2</span><br><span class="line"> <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h3 id="2-遍历文件内容"><a href="#2-遍历文件内容" class="headerlink" title="2. 遍历文件内容"></a>2. 遍历文件内容</h3><ul>
<li>代码如下</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim while.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> i;<span class="keyword">do</span></span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$i</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span> &lt; <span class="variable">$1</span></span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># bash while.sh /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="line">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><br><span class="line">sync:x:5:0:sync:/sbin:/bin/sync</span><br><span class="line">shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">halt:x:7:0:halt:/sbin:/sbin/halt</span><br><span class="line">mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span><br><span class="line">operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">games:x:12:100:games:/usr/games:/sbin/nologin</span><br><span class="line">ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</span><br><span class="line">nobody:x:99:99:Nobody:/:/sbin/nologin</span><br><span class="line">systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin</span><br><span class="line">dbus:x:81:81:System message bus:/:/sbin/nologin</span><br><span class="line">polkitd:x:999:997:User <span class="keyword">for</span> polkitd:/:/sbin/nologin</span><br><span class="line">tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin</span><br><span class="line">postfix:x:89:89::/var/spool/postfix:/sbin/nologin</span><br><span class="line">chrony:x:998:996::/var/lib/chrony:/sbin/nologin</span><br><span class="line">sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</span><br></pre></td></tr></table></figure>

<h3 id="3-读出文件中的列，IFS指定默认的列分隔符"><a href="#3-读出文件中的列，IFS指定默认的列分隔符" class="headerlink" title="3. 读出文件中的列，IFS指定默认的列分隔符"></a>3. 读出文件中的列，IFS指定默认的列分隔符</h3><ul>
<li>代码如下</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim while.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">IFS=$<span class="string">&quot;:&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> f1 f2 f3 f4 f5 f6 f7;<span class="keyword">do</span></span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$f1</span> <span class="variable">$f2</span> <span class="variable">$f3</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span> &lt; /etc/passwd</span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># bash while.sh</span></span><br><span class="line">root x 0</span><br><span class="line">bin x 1</span><br><span class="line">daemon x 2</span><br><span class="line">adm x 3</span><br><span class="line">lp x 4</span><br><span class="line">sync x 5</span><br><span class="line">shutdown x 6</span><br><span class="line">halt x 7</span><br><span class="line">mail x 8</span><br><span class="line">operator x 11</span><br><span class="line">games x 12</span><br><span class="line">ftp x 14</span><br><span class="line">nobody x 99</span><br><span class="line">systemd-network x 192</span><br><span class="line">dbus x 81</span><br><span class="line">polkitd x 999</span><br><span class="line">postfix x 89</span><br><span class="line">chrony x 998</span><br><span class="line">sshd x 74</span><br></pre></td></tr></table></figure>

<h3 id="4-批量创建用户-及-设置密码"><a href="#4-批量创建用户-及-设置密码" class="headerlink" title="4. 批量创建用户 及 设置密码"></a>4. 批量创建用户 及 设置密码</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">password=$(<span class="built_in">echo</span> <span class="variable">$RANDOM</span>|md5sum|cut -c 1-6)</span><br><span class="line">number=100</span><br><span class="line"><span class="keyword">for</span> user <span class="keyword">in</span> lemon&#123;1..100&#125;;<span class="keyword">do</span></span><br><span class="line">    useradd <span class="variable">$user</span></span><br><span class="line">    <span class="keyword">while</span> [ <span class="variable">$number</span> -ge 1 ];<span class="keyword">do</span></span><br><span class="line">          <span class="built_in">echo</span>  <span class="variable">$password</span>|passwd --stdin  <span class="variable">$user</span> &amp;&gt;/dev/null</span><br><span class="line">          <span class="built_in">let</span> number--</span><br><span class="line">          <span class="keyword">if</span>  [ $? -eq 0 ];<span class="keyword">then</span></span><br><span class="line">              tail -100 /etc/passwd</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">              <span class="built_in">echo</span> <span class="string">&quot;error&quot;</span></span><br><span class="line">          <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h1 id="until语句"><a href="#until语句" class="headerlink" title="until语句"></a>until语句</h1><ul>
<li>until介绍</li>
<li>until语法</li>
<li>案例分享</li>
</ul>
<h2 id="一、until介绍"><a href="#一、until介绍" class="headerlink" title="一、until介绍"></a>一、until介绍</h2><blockquote>
<p><em><strong>和 while正好相反，until是条件为假开始执行，条件为真停止执行。</strong></em></p>
</blockquote>
<h2 id="二、until语法"><a href="#二、until语法" class="headerlink" title="二、until语法"></a>二、until语法</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">until [ condition ];<span class="keyword">do</span>      <span class="comment">#注意，条件为假until才会循环，条件为真，until停止循环</span></span><br><span class="line">      commands代码块</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h2 id="三、案例"><a href="#三、案例" class="headerlink" title="三、案例"></a>三、案例</h2><ul>
<li>代码如下</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim until1.sh </span></span><br><span class="line"><span class="comment">#打印10-20数字</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">init_num=10</span><br><span class="line">until [ <span class="variable">$init_num</span> -gt 20 ]</span><br><span class="line">   <span class="keyword">do</span></span><br><span class="line">       <span class="built_in">echo</span> <span class="variable">$init_num</span></span><br><span class="line">       init_num=$((init_num + <span class="number">1</span>))</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># sh until1.sh </span></span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td></tr></table></figure>

<h1 id="case多条件分支语句"><a href="#case多条件分支语句" class="headerlink" title="case多条件分支语句"></a>case多条件分支语句</h1><ul>
<li>case介绍</li>
<li>case语法</li>
<li>shell特殊变量</li>
</ul>
<h2 id="一、case介绍"><a href="#一、case介绍" class="headerlink" title="一、case介绍"></a>一、case介绍</h2><blockquote>
<ul>
<li><em><strong>概述：根据变量的值，顺序匹配模式，匹配后执行命令并结束，如果没有匹配的模式，则执行默认命令，执行成功后退出，返回1，然后退出case</strong></em></li>
<li><em><strong>意思就是：下面的模式就是变量名的值，模式里面的命令都会执行；从第一个开始，直到最后一个结束；如果没有模式则默认执行exit退出脚本命令</strong></em></li>
</ul>
</blockquote>
<h2 id="二、case语法"><a href="#二、case语法" class="headerlink" title="二、case语法"></a>二、case语法</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">case 变量  <span class="keyword">in</span> </span><br><span class="line"></span><br><span class="line">模式<span class="number">1</span>）</span><br><span class="line">           执行代码块<span class="number">1</span></span><br><span class="line">;;</span><br><span class="line">模式<span class="number">2</span>）</span><br><span class="line">           执行代码块<span class="number">2</span></span><br><span class="line">;;</span><br><span class="line">......</span><br><span class="line">*)         代表不是以上模式的值就执行 *)</span><br><span class="line">           执行的默认代码块；默认是<span class="keyword">exit</span>。</span><br><span class="line">;;</span><br><span class="line"></span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line">注意：每个代码块执行完毕要以;;结尾代表结束，case结尾要以倒过来写的esac来结束。</span><br></pre></td></tr></table></figure>

<ul>
<li>代码如下</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim case.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">1)</span><br><span class="line">   <span class="built_in">echo</span> haha</span><br><span class="line">;;</span><br><span class="line">2)</span><br><span class="line">   <span class="built_in">echo</span> hehe</span><br><span class="line">;;</span><br><span class="line">3)</span><br><span class="line">   <span class="built_in">echo</span> heihei</span><br><span class="line">;;</span><br><span class="line">*)</span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&#x27;usage:|1|2|3|&#x27;</span></span><br><span class="line">;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># bash case.sh 1</span></span><br><span class="line">haha</span><br><span class="line">[root@lemon ~]<span class="comment"># bash case.sh 2</span></span><br><span class="line">hehe</span><br><span class="line">[root@lemon ~]<span class="comment"># bash case.sh 3</span></span><br><span class="line">heihei</span><br><span class="line">[root@lemon ~]<span class="comment"># bash case.sh 4</span></span><br><span class="line">usage:|1|2|3|</span><br><span class="line">[root@lemon ~]<span class="comment"># bash case.sh 4asd</span></span><br><span class="line">usage:|1|2|3|</span><br></pre></td></tr></table></figure>

<h2 id="三、shell特殊变量"><a href="#三、shell特殊变量" class="headerlink" title="三、shell特殊变量"></a>三、shell特殊变量</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$*       <span class="comment">#代表所有参数，其间隔为IFS内定参数的第一个字元</span></span><br><span class="line"><span class="variable">$@</span>       <span class="comment">#与*星号类同。不同之处在於不参照IFS</span></span><br><span class="line"><span class="variable">$#</span>       <span class="comment">#代表参数数量</span></span><br><span class="line">$        <span class="comment">#执行上一个指令的返回值</span></span><br><span class="line">$-       <span class="comment">#最近执行的foreground pipeline的选项参数</span></span><br><span class="line">$$       <span class="comment">#本身的Process ID</span></span><br><span class="line">$        <span class="comment">#执行上一个背景指令的PID</span></span><br><span class="line"><span class="variable">$_</span>       <span class="comment">#显示出最後一个执行的命令</span></span><br><span class="line"><span class="variable">$N</span>       <span class="comment">#shell的第几个外传参数</span></span><br></pre></td></tr></table></figure>

<h1 id="shell函数"><a href="#shell函数" class="headerlink" title="shell函数"></a>shell函数</h1><ul>
<li>函数介绍</li>
<li>函数语法</li>
<li>函数应用</li>
</ul>
<h2 id="一、函数介绍"><a href="#一、函数介绍" class="headerlink" title="一、函数介绍"></a>一、函数介绍</h2><blockquote>
<ul>
<li><p>Shell函数类似于Shell脚本里面存放了一系列的指令，不过Shell的函数存在于内存，而不是硬盘文件，所以速度很快，另外，Shell还能对函数进行预处理，所以函数的启动比脚本更快。</p>
</li>
<li><p>shell允许将一组命令集 或 语句形成一个可用块，这些块称为shell函数。</p>
</li>
<li><p>说白了，函数就是将某一组shell命令封装成一个模块，想用的时候就用，不用就放在原地</p>
</li>
<li><p><strong>函数的优点：</strong></p>
<ul>
<li>代码模块化，调用方便，节省内存</li>
<li>代码模块化，代码量少，排错简单</li>
<li>代码模块化，可以改变代码的执行顺序</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="二、函数的语法"><a href="#二、函数的语法" class="headerlink" title="二、函数的语法"></a>二、函数的语法</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">语法一:</span><br><span class="line">函数名 () &#123;</span><br><span class="line">    代码块</span><br><span class="line">    [<span class="built_in">return</span> N]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">语法二：</span><br><span class="line"><span class="keyword">function</span> 函数名 &#123;</span><br><span class="line">    代码块</span><br><span class="line">    [<span class="built_in">return</span> N]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>解析：</strong>所有函数在使用前必须定义。这意味着必须将函数放在脚本开始部分，直至shell解释器首次发现它时，才可以使用。调用函数仅使用其函数名即可。函数中的关键字“return”可以放到函数体的任意位置，通常用于返回某些值，Shell在执行到return之后，就停止往下执行，返回到主程序的调用行，return的返回值只能是0~256之间的一个整数，返回值将保存到变量“$?”中。</p>
</blockquote>
<h2 id="三、Shell函数的退出及删除"><a href="#三、Shell函数的退出及删除" class="headerlink" title="三、Shell函数的退出及删除"></a>三、Shell函数的退出及删除</h2><ul>
<li><p>函数结束之后会返回调用函数的部分继续执行</p>
</li>
<li><p>退出函数体：exit 退出整个脚本、break跳出当前函数体</p>
</li>
<li><p>shell中查询函数及删除：</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> 或 . 脚本       <span class="comment">#将函数载入到内存</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">declare</span> -f            <span class="comment">#可以显示定义的函数内容</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">declare</span> -F            <span class="comment">#可以只显示定义的函数名</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">unset</span> -f 函数名        <span class="comment">#可以从Shell内存中删除函数</span></span><br></pre></td></tr></table></figure>

<h2 id="四、函数的变量概念"><a href="#四、函数的变量概念" class="headerlink" title="四、函数的变量概念"></a>四、函数的变量概念</h2><ul>
<li>全局变量：默认情况下，脚本中定义的任何变量都是全局变量，在函数外定义的变量可在函数内正常访问。</li>
<li>局部变量：函数内部使用全局变量可以用 ‘local 变量名=值’ 声明成局部变量，局部变量只能在函数体内生效。</li>
</ul>
<h2 id="五、函数的应用"><a href="#五、函数的应用" class="headerlink" title="五、函数的应用"></a>五、函数的应用</h2><ul>
<li>定义一个函数</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">print</span></span> () &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;lemon&quot;</span></span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> hello &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;hello world&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>print   和  hello就是函数的名字，函数名字命名参考变量一节中的变量命名规则</p>
<p>定义好函数后，如果想调用该函数，只需通过函数名调用即可</p>
</blockquote>
<ul>
<li>代码如下</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim function.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">N1</span></span> () &#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;world&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">N2</span></span> () &#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;hello&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">N3</span></span> () &#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;lemon is a very good&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#方便调整代码执行顺序</span></span><br><span class="line">N2</span><br><span class="line">N1</span><br><span class="line"></span><br><span class="line"><span class="comment">#可以重复调用摸个函数</span></span><br><span class="line">N3</span><br><span class="line">N3</span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># bash function.sh</span></span><br><span class="line">hello</span><br><span class="line">world</span><br><span class="line">lemon is a very good</span><br><span class="line">lemon is a very good</span><br></pre></td></tr></table></figure>

<h1 id="自动化交互-expect-详解"><a href="#自动化交互-expect-详解" class="headerlink" title="自动化交互 expect 详解"></a>自动化交互 expect 详解</h1><h2 id="一、expect介绍"><a href="#一、expect介绍" class="headerlink" title="一、expect介绍"></a>一、expect介绍</h2><blockquote>
<ul>
<li>expect是一个自动化交互套件，主要应用于执行命令和程序时，系统以交互形式要求输入指定字符串，实现交互通信。</li>
<li><strong>expect自动交互流程：</strong>spawn启动指定进程 &lt;—&gt; expect获取指定关键字 &lt;—&gt; send向指定程序发送指定字符 &lt;—&gt; 执行完成退出</li>
<li><strong>使用场景：</strong>在管理系统的多种情况下，会出现管理员手动输入字符，称为交互式，如下：</li>
</ul>
</blockquote>
<p><img src="https://bucket-1301203199.cos.ap-shanghai.myqcloud.com/armin/008i3skNly1gricwwzwroj60v00imac302.jpg" alt="image-20200606130643207"></p>
<h2 id="二、安装-expect-工具"><a href="#二、安装-expect-工具" class="headerlink" title="二、安装 expect 工具"></a>二、安装 expect 工具</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 expect 工具</span></span><br><span class="line">[root@lemon ~]<span class="comment"># yum -y install expect</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看 expect 版本</span></span><br><span class="line">[root@lemon ~]<span class="comment"># expect -v</span></span><br><span class="line">expect version 5.45</span><br></pre></td></tr></table></figure>

<h2 id="三、expect常用命令"><a href="#三、expect常用命令" class="headerlink" title="三、expect常用命令"></a>三、expect常用命令</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">spawn               <span class="comment">#交互程序开始后面跟命令或者指定程序</span></span><br><span class="line">expect              <span class="comment">#获取匹配信息匹配成功则执行expect后面的程序动作; expect eof 代表正常结束</span></span><br><span class="line">send exp_send       <span class="comment">#用于发送指定的字符串信息</span></span><br><span class="line">exp_continue        <span class="comment">#在expect中多次匹配就需要用到</span></span><br><span class="line">send_user           <span class="comment">#用来打印输出 相当于shell中的echo</span></span><br><span class="line"><span class="built_in">exit</span>                <span class="comment">#退出expect脚本</span></span><br><span class="line">eof                 <span class="comment">#expect执行结束 退出</span></span><br><span class="line"><span class="built_in">set</span>                 <span class="comment">#定义变量</span></span><br><span class="line">puts                <span class="comment">#输出变量</span></span><br><span class="line"><span class="built_in">set</span> timeout         <span class="comment">#设置超时时间        </span></span><br><span class="line">interact 　　　　　　 <span class="comment">#允许用户交互; 停留在远程终端</span></span><br></pre></td></tr></table></figure>

<h2 id="四、expect-基本语法"><a href="#四、expect-基本语法" class="headerlink" title="四、expect 基本语法"></a>四、expect 基本语法</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">spawn   linux命令</span><br><span class="line">expect  <span class="string">&quot;关键字&quot;</span></span><br><span class="line"></span><br><span class="line">expect &#123;</span><br><span class="line"> <span class="string">&quot;*yes/no&quot;</span> &#123; send <span class="string">&quot;yes\r&quot;</span>; exp_continue&#125;</span><br><span class="line"> <span class="string">&quot;*password:&quot;</span> &#123; send <span class="string">&quot;<span class="variable">$password</span>\r&quot;</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interact</span><br></pre></td></tr></table></figure>

<h2 id="五、expect-应用案例"><a href="#五、expect-应用案例" class="headerlink" title="五、expect 应用案例"></a>五、expect 应用案例</h2><h3 id="案例1：expect自动交互ssh远程登录"><a href="#案例1：expect自动交互ssh远程登录" class="headerlink" title="案例1：expect自动交互ssh远程登录"></a>案例1：expect自动交互ssh远程登录</h3><ul>
<li><p>需要两台虚拟机</p>
<ul>
<li>主机一 ：IP — 192.168.2.1        主机名 — lemon</li>
<li>主机二 ：IP — 192.168.2.2        主机名 — docker</li>
</ul>
</li>
<li><p>代码如下</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># which expect           #查看expect程序位置</span></span><br><span class="line">/usr/bin/expect</span><br><span class="line"></span><br><span class="line">[root@lemon ~]<span class="comment"># vim ssh.exp            #后缀名是什么都行</span></span><br><span class="line"><span class="comment">#!/usr/bin/expect</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># set设置变量，将第一个位置变量交给变量ip</span></span><br><span class="line"><span class="built_in">set</span> ip [lindex <span class="variable">$argv</span> 0]</span><br><span class="line"></span><br><span class="line"><span class="comment"># set设置变量，将第二个位置变量交给变量password</span></span><br><span class="line"><span class="built_in">set</span> password [lindex <span class="variable">$argv</span> 1]</span><br><span class="line"></span><br><span class="line"><span class="comment"># spawn指定命令</span></span><br><span class="line">spawn ssh root@<span class="variable">$ip</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># expect指定匹配字段</span></span><br><span class="line">expect &#123;</span><br><span class="line"><span class="comment"># exp_continue表示继续匹配字段, send自动输入指定交互式内容</span></span><br><span class="line"> <span class="string">&quot;*(yes/no)?&quot;</span> &#123; send <span class="string">&quot;yes\r&quot;</span>; exp_continue &#125;</span><br><span class="line"> <span class="string">&quot;*password:&quot;</span> &#123; send <span class="string">&quot;<span class="variable">$password</span>\r&quot;</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Interact开启交互式模式，不然导致远程后无法敲命令</span></span><br><span class="line">interact</span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># chmod u+x ssh.exp                #给予执行权限</span></span><br><span class="line">[root@lemon ~]<span class="comment"># rm -rf .ssh/known_hosts          #删除之前的key验证文件,不删也可以</span></span><br><span class="line">[root@lemon ~]<span class="comment"># ./ssh.exp 192.168.2.2 123123     #执行脚本</span></span><br><span class="line">spawn ssh root@192.168.2.2</span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.2.2 (192.168.2.2)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:dSDdVALO14Vgdmr49RwTkRDyXrZHmCz1CUVlSf0fZrM.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is MD5:8e:75:d7:bc:9c:61:45:fc:0c:67:3b:3a:f6:db:fe:3c.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.2.2<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">root@192.168.2.2&#x27;</span>s password: </span><br><span class="line">Last login: Sat Jun  6 13:15:44 2020 from 192.168.2.1</span><br><span class="line">[root@docker ~]<span class="comment"># </span></span><br><span class="line">[root@docker ~]<span class="comment"># ifconfig ens32</span></span><br><span class="line">ens32: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.2.2  netmask 255.255.255.0  broadcast 192.168.2.255</span><br><span class="line">        inet6 fe80::20c:29ff:fe16:9fdd  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:0c:29:16:9f:dd  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 349  bytes 46800 (45.7 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 262  bytes 43941 (42.9 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">[root@docker ~]<span class="comment"># exit</span></span><br><span class="line">登出</span><br><span class="line">Connection to 192.168.2.2 closed.</span><br><span class="line">[root@lemon ~]<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<h3 id="案例2：expect自动交互式管理执行命令"><a href="#案例2：expect自动交互式管理执行命令" class="headerlink" title="案例2：expect自动交互式管理执行命令"></a>案例2：expect自动交互式管理执行命令</h3><ul>
<li><p>需要两台虚拟机</p>
<ul>
<li>主机一 ：IP — 192.168.2.1        主机名 — lemon</li>
<li>主机二 ：IP — 192.168.2.2        主机名 — docker</li>
</ul>
</li>
<li><p>代码如下</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim admin.exp</span></span><br><span class="line"><span class="comment">#!/usr/bin/expect</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> ip [lindex <span class="variable">$argv</span> 0]</span><br><span class="line"><span class="built_in">set</span> user [lindex <span class="variable">$argv</span> 1]</span><br><span class="line"><span class="built_in">set</span> password [lindex <span class="variable">$argv</span> 2]</span><br><span class="line"><span class="built_in">set</span> order [lindex <span class="variable">$argv</span> 3]</span><br><span class="line"><span class="built_in">set</span> timeout 10</span><br><span class="line"></span><br><span class="line">spawn ssh <span class="variable">$user</span>@<span class="variable">$ip</span> <span class="variable">$order</span></span><br><span class="line"></span><br><span class="line">expect &#123;</span><br><span class="line"> <span class="string">&quot;*(yes/no)?&quot;</span> &#123; send <span class="string">&quot;yes\r&quot;</span>; exp_continue &#125;</span><br><span class="line"> <span class="string">&quot;*password:&quot;</span> &#123; send <span class="string">&quot;<span class="variable">$password</span>\r&quot;</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interact</span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># chmod u+x admin.exp</span></span><br><span class="line"></span><br><span class="line">[root@lemon ~]<span class="comment"># ./admin.exp 192.168.2.2 root 123123 &quot;free -m&quot;</span></span><br><span class="line">spawn ssh root@192.168.2.2 free -m</span><br><span class="line">root@192.168.2.2<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">              total        used        free      shared  buff/cache   available</span></span><br><span class="line"><span class="string">Mem:            976         145         572           6         258         643</span></span><br><span class="line"><span class="string">Swap:          1023           0        1023</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[root@lemon ~]# ./admin.exp 192.168.2.2 root 123123 &quot;df -hT&quot;</span></span><br><span class="line"><span class="string">spawn ssh root@192.168.2.2 df -hT</span></span><br><span class="line"><span class="string">root@192.168.2.2&#x27;</span>s password: </span><br><span class="line">文件系统                类型      容量  已用  可用 已用% 挂载点</span><br><span class="line">/dev/mapper/centos-root xfs        18G  3.2G   15G   18% /</span><br><span class="line">devtmpfs                devtmpfs  478M     0  478M    0% /dev</span><br><span class="line">tmpfs                   tmpfs     489M     0  489M    0% /dev/shm</span><br><span class="line">tmpfs                   tmpfs     489M  6.7M  482M    2% /run</span><br><span class="line">tmpfs                   tmpfs     489M     0  489M    0% /sys/fs/cgroup</span><br><span class="line">/dev/sr0                iso9660   4.3G  4.3G     0  100% /mnt</span><br><span class="line">/dev/sdb1               xfs        80G   33M   80G    1% /sdb1</span><br><span class="line">/dev/sda1               xfs      1014M  125M  890M   13% /boot</span><br><span class="line">tmpfs                   tmpfs      98M     0   98M    0% /run/user/0</span><br></pre></td></tr></table></figure>

<h3 id="案例3：expect自动化下发脚本，执行脚本（结合案例2）"><a href="#案例3：expect自动化下发脚本，执行脚本（结合案例2）" class="headerlink" title="案例3：expect自动化下发脚本，执行脚本（结合案例2）"></a>案例3：expect自动化下发脚本，执行脚本（结合案例2）</h3><ul>
<li><p>需要两台虚拟机</p>
<ul>
<li>主机一 ：IP — 192.168.2.1        主机名 — lemon</li>
<li>主机二 ：IP — 192.168.2.2        主机名 — docker</li>
</ul>
</li>
<li><p>代码如下</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 准备要下发的脚本文件</span></span><br><span class="line">[root@lemon ~]<span class="comment"># vim ping.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">ping -c 3 127.0.0.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 准备远程下发脚本文件的脚本</span></span><br><span class="line">[root@lemon ~]<span class="comment"># vim remote_copy.exp</span></span><br><span class="line"><span class="comment">#!/usr/bin/expect</span></span><br><span class="line"><span class="built_in">set</span> ip [lindex <span class="variable">$argv</span> 0]</span><br><span class="line"><span class="built_in">set</span> user [lindex <span class="variable">$argv</span> 1]</span><br><span class="line"><span class="built_in">set</span> password [lindex <span class="variable">$argv</span> 2]</span><br><span class="line"><span class="built_in">set</span> sfile [lindex <span class="variable">$argv</span> 3]</span><br><span class="line"><span class="built_in">set</span> ddir [lindex <span class="variable">$argv</span> 4]</span><br><span class="line"><span class="built_in">set</span> timeout 10</span><br><span class="line">spawn scp <span class="variable">$sfile</span> <span class="variable">$user</span>@<span class="variable">$ip</span>:<span class="variable">$ddir</span></span><br><span class="line">expect &#123;</span><br><span class="line"> <span class="string">&quot;*yes/no&quot;</span> &#123; send <span class="string">&quot;yes\r&quot;</span>; exp_continue&#125;</span><br><span class="line"> <span class="string">&quot;*password:&quot;</span> &#123; send <span class="string">&quot;<span class="variable">$password</span>\r&quot;</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line">interact</span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># chmod a+x ping.sh</span></span><br><span class="line">[root@lemon ~]<span class="comment"># chmod u+x remote_copy.exp</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 下发脚本文件</span></span><br><span class="line">[root@lemon ~]<span class="comment"># ./remote_copy.exp 192.168.2.2 root 123123 /root/ping.sh /tmp/</span></span><br><span class="line">spawn scp /root/ping.sh root@192.168.2.2:/tmp/</span><br><span class="line">root@192.168.2.2<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">ping.sh                            100%   34    13.8KB/s   00:00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 使用刚刚写好的admin.exp运行刚才remote_copy.exp下发给2.2主机上的shell脚本ping.sh</span></span><br><span class="line"><span class="string">[root@lemon ~]# ./admin.exp 192.168.2.2 root 123123 &quot;/tmp/ping.sh&quot;</span></span><br><span class="line"><span class="string">spawn ssh root@192.168.2.2 /tmp/ping.sh</span></span><br><span class="line"><span class="string">root@192.168.2.2&#x27;</span>s password: </span><br><span class="line">PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.020 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=2 ttl=64 time=0.037 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_seq=3 ttl=64 time=0.027 ms</span><br><span class="line"></span><br><span class="line">--- 127.0.0.1 ping statistics ---</span><br><span class="line">3 packets transmitted, 3 received, 0% packet loss, time 2005ms</span><br><span class="line">rtt min/avg/max/mdev = 0.020/0.028/0.037/0.007 ms</span><br></pre></td></tr></table></figure>

<h3 id="案例4：expect-变量的练习"><a href="#案例4：expect-变量的练习" class="headerlink" title="案例4：expect 变量的练习"></a>案例4：expect 变量的练习</h3><ul>
<li>代码如下</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim env.exp</span></span><br><span class="line"><span class="comment">#!/usr/bin/expect</span></span><br><span class="line"><span class="comment"># A=$1</span></span><br><span class="line"><span class="built_in">set</span> A [lindex <span class="variable">$argv</span> 0]</span><br><span class="line"></span><br><span class="line"><span class="comment"># B=$2</span></span><br><span class="line"><span class="built_in">set</span> B [lindex <span class="variable">$argv</span> 1]</span><br><span class="line"></span><br><span class="line"><span class="comment"># C=$3</span></span><br><span class="line"><span class="built_in">set</span> C [lindex <span class="variable">$argv</span> 2]</span><br><span class="line"></span><br><span class="line"><span class="comment"># D=lemon</span></span><br><span class="line"><span class="built_in">set</span> D lemon</span><br><span class="line"></span><br><span class="line">send <span class="string">&quot;\$A=<span class="variable">$A</span>\n&quot;</span></span><br><span class="line">send <span class="string">&quot;\$B=<span class="variable">$B</span>\n&quot;</span></span><br><span class="line">send <span class="string">&quot;\$C=<span class="variable">$C</span>\n&quot;</span></span><br><span class="line">send <span class="string">&quot;\$D=<span class="variable">$D</span>\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 相当$*</span></span><br><span class="line">send <span class="string">&quot;\$argv=<span class="variable">$argv</span>\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 相当$#</span></span><br><span class="line">send <span class="string">&quot;\$argc=<span class="variable">$argc</span>\n&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># chmod u+x env.exp</span></span><br><span class="line">[root@lemon ~]<span class="comment"># ./env.exp a b c d</span></span><br><span class="line"><span class="variable">$A</span>=a</span><br><span class="line"><span class="variable">$B</span>=b</span><br><span class="line"><span class="variable">$C</span>=c</span><br><span class="line"><span class="variable">$D</span>=lemon</span><br><span class="line"><span class="variable">$argv</span>=a b c d</span><br><span class="line"><span class="variable">$argc</span>=4</span><br></pre></td></tr></table></figure>

<h3 id="案例5：expect-结合-if-的练习，"><a href="#案例5：expect-结合-if-的练习，" class="headerlink" title="案例5：expect 结合 if 的练习，"></a>案例5：expect 结合 if 的练习，</h3><blockquote>
<p><strong>注意：</strong>括号的空格，严格要求</p>
</blockquote>
<ul>
<li>代码如下</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># vim if.exp</span></span><br><span class="line"><span class="comment">#!/usr/bin/expect</span></span><br><span class="line"><span class="keyword">if</span> &#123;<span class="variable">$argc</span> != 3&#125;  &#123;</span><br><span class="line">  <span class="comment"># send:相当于echo</span></span><br><span class="line">  <span class="comment"># send_user:相当于echo -e</span></span><br><span class="line">  send_user <span class="string">&quot;usage: == <span class="variable">$argc</span> 不等于3!\n&quot;</span></span><br><span class="line">  <span class="built_in">exit</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">set</span> FILE [lindex <span class="variable">$argv</span> 0]</span><br><span class="line"><span class="built_in">set</span> HOST [lindex <span class="variable">$argv</span> 1]</span><br><span class="line"><span class="built_in">set</span> DIR [lindex <span class="variable">$argv</span> 2]</span><br><span class="line">send_user <span class="string">&quot;<span class="variable">$FILE</span>\t<span class="variable">$HOST</span>\t<span class="variable">$DIR</span>\n&quot;</span> &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>执行结果</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@lemon ~]<span class="comment"># chmod u+x if.exp </span></span><br><span class="line"></span><br><span class="line">[root@lemon ~]<span class="comment"># ./if.exp a b</span></span><br><span class="line">usage: == 2 不等于3!</span><br><span class="line"></span><br><span class="line">[root@lemon ~]<span class="comment"># ./if.exp a b c</span></span><br><span class="line">a	b	c</span><br></pre></td></tr></table></figure>

<h1 id="Linux-信号控制"><a href="#Linux-信号控制" class="headerlink" title="Linux 信号控制"></a>Linux 信号控制</h1><h1 id="shell案例"><a href="#shell案例" class="headerlink" title="shell案例"></a>shell案例</h1><h2 id="一、监控主机及联网状态"><a href="#一、监控主机及联网状态" class="headerlink" title="一、监控主机及联网状态"></a>一、监控主机及联网状态</h2><h3 id="1-监控目的"><a href="#1-监控目的" class="headerlink" title="1. 监控目的"></a>1. 监控目的</h3><ul>
<li><em><strong>掌握在线业务机器及联网的状态。</strong></em></li>
</ul>
<h3 id="2-监控方法"><a href="#2-监控方法" class="headerlink" title="2. 监控方法"></a>2. 监控方法</h3><ul>
<li><em><strong>通过采用 ICMP协议的 ping命令对计算机进行 ping测试,通则表示主机为开启并联网，不通则代表主机宕机或断网。</strong></em></li>
</ul>
<h3 id="3-监控思路"><a href="#3-监控思路" class="headerlink" title="3. 监控思路"></a>3. 监控思路</h3><ul>
<li><em><strong>通过分析多次 ping结果判断主机状态</strong></em></li>
</ul>
<h3 id="4-监控实现"><a href="#4-监控实现" class="headerlink" title="4. 监控实现"></a>4. 监控实现</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#Description:</span></span><br><span class="line"><span class="comment">#Author:</span></span><br><span class="line"><span class="comment">#Created Time:</span></span><br><span class="line"><span class="comment">#监控目标主机状态</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#监控方法 ping   ICMP协议</span></span><br><span class="line"><span class="comment">#ping 通  host up</span></span><br><span class="line"><span class="comment">#ping 不通  host down</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#问题</span></span><br><span class="line"><span class="comment">#1、关于禁ping   防止DDOS</span></span><br><span class="line"><span class="comment">#   禁的是陌生人 禁止所有 允许你的IP </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#满足条件 </span></span><br><span class="line"><span class="comment">#网络有延迟  what&#x27;s up    假报警问题</span></span><br><span class="line"><span class="comment">#        ping 的取值  报警阈值 3次全部失败  报警机器down</span></span><br><span class="line"><span class="comment">#ping 的频率 秒级  5秒 or  1秒</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#main</span></span><br><span class="line"><span class="keyword">for</span> ((i=1;i&lt;4;i++));<span class="keyword">do</span></span><br><span class="line"><span class="comment">#测试代码</span></span><br><span class="line">   <span class="keyword">if</span> ping -c1 <span class="variable">$1</span> &amp;&gt;/dev/null;<span class="keyword">then</span></span><br><span class="line">        <span class="built_in">export</span> ping_count<span class="string">&quot;<span class="variable">$i</span>&quot;</span>=1</span><br><span class="line"></span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">export</span> ping_count<span class="string">&quot;<span class="variable">$i</span>&quot;</span>=0</span><br><span class="line">   <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#时间间隔</span></span><br><span class="line">   sleep 0.3</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3次ping失败报警</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$ping_count1</span> -eq <span class="variable">$ping_count2</span> ] &amp;&amp; [ <span class="variable">$ping_count2</span> -eq <span class="variable">$ping_count3</span> ]&amp;&amp;[ <span class="variable">$ping_count1</span> -eq 0 ];<span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$1</span> is down&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$1</span> is up&quot;</span></span><br><span class="line"><span class="keyword">fi</span> </span><br><span class="line"></span><br><span class="line"><span class="built_in">unset</span> ping_count1 </span><br><span class="line"><span class="built_in">unset</span> ping_count2  </span><br><span class="line"><span class="built_in">unset</span> ping_count3</span><br></pre></td></tr></table></figure>

<h2 id="二、监控主机服务状态"><a href="#二、监控主机服务状态" class="headerlink" title="二、监控主机服务状态"></a>二、监控主机服务状态</h2><h3 id="1-监控目的-1"><a href="#1-监控目的-1" class="headerlink" title="1. 监控目的"></a>1. 监控目的</h3><blockquote>
<p><em><strong>实时掌握线上机器服务状态，保证服务正常运行</strong></em></p>
</blockquote>
<h3 id="2-监控方法-1"><a href="#2-监控方法-1" class="headerlink" title="2. 监控方法"></a>2. 监控方法</h3><blockquote>
<p><em><strong>采用telnet访问端口，通过返回数据分析判定结果</strong></em></p>
</blockquote>
<h3 id="3-监控实现"><a href="#3-监控实现" class="headerlink" title="3. 监控实现"></a>3. 监控实现</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#Description:</span></span><br><span class="line"><span class="comment">#Author:</span></span><br><span class="line"><span class="comment">#Created Time:</span></span><br><span class="line"><span class="comment">#监控一个服务端口</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#监控方法</span></span><br><span class="line"><span class="comment">#1）通过systemctl  service   服务启动状态  </span></span><br><span class="line"><span class="comment">#2）lsof 查看端口是否存在</span></span><br><span class="line"><span class="comment">#3）查看进程是否存在</span></span><br><span class="line"><span class="comment">######压力过大 无法响应 |  服务down了  上述东西还在  </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4）测试端口是否有响应    推荐</span></span><br><span class="line">    <span class="comment">#telnet 协议 </span></span><br><span class="line"><span class="comment">#main</span></span><br><span class="line"><span class="function"><span class="title">port_status</span></span> () &#123;</span><br><span class="line">temp_file=`mktemp port_status.XXX`</span><br><span class="line"></span><br><span class="line"><span class="comment">#1、判断依赖命令telnet是否存在</span></span><br><span class="line">[ ! -x /usr/bin/telnet ]&amp;&amp;<span class="built_in">echo</span> <span class="string">&quot;telnet: not found command&quot;</span>&amp;&amp; <span class="built_in">exit</span> 1</span><br><span class="line"></span><br><span class="line"><span class="comment">#2、测试端口 $1 IP    $2 port</span></span><br><span class="line">( telnet <span class="variable">$1</span> <span class="variable">$2</span> &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">quit</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">) &amp;&gt;<span class="variable">$temp_file</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3、分析文件中的内容，判断结果</span></span><br><span class="line"><span class="keyword">if</span> egrep <span class="string">&quot;\^]&quot;</span> <span class="variable">$temp_file</span> &amp;&gt;/dev/null;<span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$1</span> <span class="variable">$2</span> is open&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$1</span> <span class="variable">$2</span> is close&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">rm -f <span class="variable">$temp_file</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#函数带参的问题</span></span><br><span class="line">port_status <span class="variable">$1</span> <span class="variable">$2</span></span><br></pre></td></tr></table></figure>

<h2 id="三、监控内存使用率"><a href="#三、监控内存使用率" class="headerlink" title="三、监控内存使用率"></a>三、监控内存使用率</h2><h3 id="1-监控目的-2"><a href="#1-监控目的-2" class="headerlink" title="1. 监控目的"></a>1. 监控目的</h3><p>通过监控内存使用率判定机器内存资源消耗情况，及时处理并优化资源配比</p>
<h3 id="2-监控方法-2"><a href="#2-监控方法-2" class="headerlink" title="2. 监控方法"></a>2. 监控方法</h3><h4 id="2-1）监控命令"><a href="#2-1）监控命令" class="headerlink" title="2.1）监控命令"></a>2.1）监控命令</h4><ul>
<li>free  </li>
<li>cat /proc/meminfo</li>
<li>等等……</li>
</ul>
<h4 id="2-2）监控指标"><a href="#2-2）监控指标" class="headerlink" title="2.2）监控指标"></a>2.2）监控指标</h4><ul>
<li>内存使用率</li>
<li>buffer &amp; cache</li>
</ul>
<h4 id="2-3）监控方法"><a href="#2-3）监控方法" class="headerlink" title="2.3）监控方法"></a>2.3）监控方法</h4><blockquote>
<p><em><strong>通过上述命令对内存总量、使用量进行截取，取得内存使用率，并根据阈值进行判断。</strong></em></p>
</blockquote>
<h3 id="3-监控实现-1"><a href="#3-监控实现-1" class="headerlink" title="3. 监控实现"></a>3. 监控实现</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#Description:</span></span><br><span class="line"><span class="comment">#Author:</span></span><br><span class="line"><span class="comment">#Created Time:</span></span><br><span class="line"><span class="comment">#内存使用率统计脚本</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#/proc/meminfo</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#内存申请顺序  free-cache-buffer-swap</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">memory_use</span></span>() &#123;</span><br><span class="line">memory_used=`head -2 /proc/meminfo |awk <span class="string">&#x27;NR==1&#123;t=$2&#125;NR==2&#123;f=$2;print(t-f)*100/t&quot;%&quot;&#125;&#x27;</span>`</span><br><span class="line">memory_cache=`head -5 /proc/meminfo |awk <span class="string">&#x27;NR==1&#123;t=$2&#125;NR==5&#123;c=$2;print c*100/t&quot;%&quot;&#125;&#x27;</span>`</span><br><span class="line">memory_buffer=`head -4 /proc/meminfo |awk <span class="string">&#x27;NR==1&#123;t=$2&#125;NR==4&#123;b=$2;print b*100/t&quot;%&quot;&#125;&#x27;</span>`</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;memory_used:<span class="variable">$memory_used</span>\tbuffer:<span class="variable">$memory_buffer</span>\tcached:<span class="variable">$memory_cache</span>&quot;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">memory_use</span><br></pre></td></tr></table></figure>

<h2 id="四、监控使用CPU或内存前十名进程"><a href="#四、监控使用CPU或内存前十名进程" class="headerlink" title="四、监控使用CPU或内存前十名进程"></a>四、监控使用CPU或内存前十名进程</h2><hr>
<h3 id="1-监控目的-3"><a href="#1-监控目的-3" class="headerlink" title="1. 监控目的"></a>1. 监控目的</h3><ul>
<li>掌握系统进程对系统资源的使用情况，掌握机器的动态。</li>
</ul>
<h3 id="2-监控方法-3"><a href="#2-监控方法-3" class="headerlink" title="2. 监控方法"></a>2. 监控方法</h3><h4 id="2-1）监控命令-1"><a href="#2-1）监控命令-1" class="headerlink" title="2.1）监控命令"></a>2.1）监控命令</h4><ul>
<li><p>ps</p>
</li>
<li><p>top</p>
</li>
<li><p>等等……</p>
</li>
</ul>
<h4 id="2-2）监控方法"><a href="#2-2）监控方法" class="headerlink" title="2.2）监控方法"></a>2.2）监控方法</h4><ul>
<li>通过对任务管理器中的进程对内存或CPU的使用情况进行整合、排序得出结论</li>
</ul>
<h3 id="3-监控实现-2"><a href="#3-监控实现-2" class="headerlink" title="3. 监控实现"></a>3. 监控实现</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#Description:</span></span><br><span class="line"><span class="comment">#Author:</span></span><br><span class="line"><span class="comment">#Created Time:</span></span><br><span class="line"><span class="comment">#统计使用内存和CPU前十名进程</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#统计系统中前十名使用内存最多的进程</span></span><br><span class="line"><span class="function"><span class="title">memory</span></span>() &#123;</span><br><span class="line">  <span class="comment">#1、收集任务管理器进程信息</span></span><br><span class="line">  temp_file=`mktemp memory.XXX`</span><br><span class="line">  top -b -n 1 &gt; <span class="variable">$temp_file</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#2、按进程统计内存使用大小</span></span><br><span class="line">  tail -n +8 <span class="variable">$temp_file</span> | awk <span class="string">&#x27;&#123;array[$NF]+=$6&#125;END&#123;for (i in array) print array[i],i&#125;&#x27;</span>  |sort -k 1 -n -r|head -10</span><br><span class="line"></span><br><span class="line">rm -f <span class="variable">$temp_file</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#统计系统中前十名使用CPU最多的进程</span></span><br><span class="line"><span class="function"><span class="title">cpu</span></span>() &#123;</span><br><span class="line">  <span class="comment">#1、收集任务管理器进程信息</span></span><br><span class="line">  temp_file=`mktemp memory.XXX`</span><br><span class="line">  top -b -n 1 &gt; <span class="variable">$temp_file</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#2、按进程统计内存使用大小</span></span><br><span class="line">  tail -n +8 <span class="variable">$temp_file</span> | awk <span class="string">&#x27;&#123;array[$NF]+=$9&#125;END&#123;for (i in array) print array[i],i&#125;&#x27;</span>  |sort -k 1 -n -r|head -10</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rm -f <span class="variable">$temp_file</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> memory</span><br><span class="line">memory</span><br><span class="line"><span class="built_in">echo</span> cpu </span><br><span class="line">cpu</span><br></pre></td></tr></table></figure>

<h2 id="五、监控IO使用情况"><a href="#五、监控IO使用情况" class="headerlink" title="五、监控IO使用情况"></a>五、监控IO使用情况</h2><h3 id="1-磁盘说明"><a href="#1-磁盘说明" class="headerlink" title="1. 磁盘说明"></a>1. 磁盘说明</h3><blockquote>
<p><em><strong>磁盘在系统中负责存储和读取任务，磁盘的处理速度直接影响了计算机的速度，目前常用的磁盘有两种：固态和机械磁盘。</strong></em></p>
</blockquote>
<ul>
<li><strong>固态磁盘：</strong>没有IO瓶颈，读写快，存储颗粒有擦写限制，价格高，容量小。</li>
<li><strong>机械磁盘：</strong>靠电机带动磁盘转动，通过磁头读取或存储数据，读写速度和磁盘转速有关，容量大、价格低，大量读写容易造成IO瓶颈。</li>
</ul>
<h3 id="2-监控目的"><a href="#2-监控目的" class="headerlink" title="2. 监控目的"></a>2. 监控目的</h3><blockquote>
<p><em><strong>随时掌握IO的使用情况，防止IO性能瓶颈</strong></em></p>
</blockquote>
<h3 id="3-监控指标"><a href="#3-监控指标" class="headerlink" title="3. 监控指标"></a>3. 监控指标</h3><ul>
<li>IO队列长度</li>
<li>IOPS</li>
<li>磁盘吞吐量</li>
</ul>
<h3 id="4-监控命令"><a href="#4-监控命令" class="headerlink" title="4. 监控命令"></a>4. 监控命令</h3><ul>
<li><p><strong>iostat（sysstat包提供），本节重点讲解</strong></p>
</li>
<li><p>iostat（sysstat包提供）重点讲解</p>
</li>
<li><p>iozone（三方提供）</p>
</li>
</ul>
<h3 id="5-iostat语法-及-输出说明"><a href="#5-iostat语法-及-输出说明" class="headerlink" title="5. iostat语法 及 输出说明"></a>5. iostat语法 及 输出说明</h3><ul>
<li><p><strong>用法：</strong></p>
<ul>
<li>iostat [ 选项 ] [ &lt;时间间隔&gt; [ &lt;次数&gt; ]]</li>
</ul>
</li>
<li><p><strong>常用选项：</strong></p>
<ul>
<li>-c：只显示系统CPU统计信息，即单独输出avg-cpu结果，不包括device结果</li>
<li>-d：单独输出Device结果，不包括cpu结果</li>
<li>-k/-m：输出结果以kB/mB为单位，而不是以扇区数为单位</li>
<li>-x:输出更详细的io设备统计信息</li>
<li>interval/count：每次输出间隔时间，count表示输出次数，不带count表示循环输出</li>
</ul>
</li>
</ul>
<p><img src="https://bucket-1301203199.cos.ap-shanghai.myqcloud.com/armin/008i3skNly1grid0pw1s9j30ve0aggm4.jpg" alt="image-20200606143516702"></p>
<ul>
<li><strong>输出含义：</strong><ul>
<li>avg-cpu: 总体cpu使用情况统计信息，对于多核cpu，这里为所有cpu的平均值。重点关注iowait值，表示CPU用于等待io请求的完成时间。</li>
<li>%user：CPU处在用户模式下的时间百分比。</li>
<li>%nice：CPU处在带NICE值的用户模式下的时间百分比。</li>
<li>%system：CPU处在系统模式下的时间百分比。</li>
<li>%iowait：CPU等待输入输出完成时间的百分比。</li>
<li>%steal：管理程序维护另一个虚拟处理器时，虚拟CPU的无意识等待时间百分比。</li>
<li>%idle：CPU空闲时间百分比。</li>
<li>Device: 各磁盘设备的IO统计信息。各列含义如下：</li>
<li>Device: 以sdX形式显示的设备名称</li>
<li>tps: 每秒进程下发的IO读、写请求数量</li>
<li>KB_read/s: 每秒从驱动器读入的数据量，单位为K。</li>
<li>KB_wrtn/s: 每秒从驱动器写入的数据量，单位为K。</li>
<li>KB_read: 读入数据总量，单位为K。</li>
<li>KB_wrtn: 写入数据总量，单位为K。</li>
</ul>
</li>
</ul>
<p><img src="https://bucket-1301203199.cos.ap-shanghai.myqcloud.com/armin/008i3skNly1grid0mckvyj31bu0acjs3.jpg" alt="image-20200606143802196"></p>
<ul>
<li><strong>输出含义：</strong><ul>
<li>rrqm/s: 每秒对该设备的读请求被合并次数，文件系统会对读取同块(block)的请求进行合并</li>
<li>wrqm/s: 每秒对该设备的写请求被合并次数</li>
<li>r/s: 每秒完成的读次数</li>
<li>w/s: 每秒完成的写次数</li>
<li>rkB/s: 每秒读数据量(kB为单位)</li>
<li>wkB/s: 每秒写数据量(kB为单位)</li>
<li>avgrq-sz:平均每次IO操作的数据量(扇区数为单位)</li>
<li>avgqu-sz: 平均等待处理的IO请求队列长度</li>
<li>await: 平均每次IO请求等待时间(包括等待时间和处理时间，毫秒为单位)</li>
<li>svctm: 平均每次IO请求的处理时间(毫秒为单位)</li>
<li>%util: 采用周期内用于IO操作的时间比率，即IO队列非空的时间比率</li>
</ul>
</li>
<li><strong>重点关注参数：</strong></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1、iowait% 表示CPU等待IO时间占整个CPU周期的百分比，如果iowait值超过50%，或者明显大于%system、%user以及%idle，表示IO可能存在问题。</span><br><span class="line"></span><br><span class="line">2、avgqu-sz 表示磁盘IO队列长度，即IO等待个数。</span><br><span class="line"></span><br><span class="line">3、await 表示每次IO请求等待时间，包括等待时间和处理时间</span><br><span class="line"></span><br><span class="line">4、svctm 表示每次IO请求处理的时间</span><br><span class="line"></span><br><span class="line">5、%util 表示磁盘忙碌情况，一般该值超过80%表示该磁盘可能处于繁忙状态。</span><br><span class="line">如果 %util 接近 100%，说明产生的I/O请求太多，I/O系统已经满负荷，该磁盘可能存在瓶颈。如果 svctm 比较接近 await，说明 I/O 几乎没有等待时间；如果 await 远大于 svctm，说明I/O 队列太长，io响应太慢，则需要进行必要优化。如果avgqu-sz比较大，也表示有当量io在等待。</span><br><span class="line"></span><br><span class="line">6、dm-0、dm-1、dm-2的主设备号是253（是linux内核留给本地使用的设备号），次设备号分别是0、1、2，这类设备在/dev/mapper中</span><br></pre></td></tr></table></figure>

<h3 id="6-监控实现"><a href="#6-监控实现" class="headerlink" title="6. 监控实现"></a>6. 监控实现</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#Description:</span></span><br><span class="line"><span class="comment">#Author:</span></span><br><span class="line"><span class="comment">#Created Time:</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#磁盘io监控 明确知晓HD的使用情况</span></span><br><span class="line"><span class="comment">#监控指标 IO队列长度  IOPS   吞吐量</span></span><br><span class="line"><span class="comment">#          iostat         iozone</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#iostat 队列长度   明确反馈IO是否忙</span></span><br><span class="line"><span class="comment">#iostat  由sysstat</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#iostat 命令</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">io</span></span>() &#123;</span><br><span class="line">  device_num=`iostat -x |egrep <span class="string">&quot;^sd[a-z]&quot;</span>|wc -l`</span><br><span class="line">  iostat -x 1 3|egrep <span class="string">&quot;^sd[a-z]&quot;</span>|tail -n +$((device_num+<span class="number">1</span>))|awk <span class="string">&#x27;&#123;io_long[$1]+=$9&#125;END&#123;for (i in io_long)print io_long[i],i&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#阈值如何判断    2-3 </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#while true</span></span><br><span class="line"><span class="comment">#do</span></span><br><span class="line">   io</span><br><span class="line"><span class="comment">#   sleep 5</span></span><br><span class="line"><span class="comment">#done</span></span><br></pre></td></tr></table></figure>

<h2 id="六、mysql-binlog日志备份"><a href="#六、mysql-binlog日志备份" class="headerlink" title="六、mysql binlog日志备份"></a>六、mysql binlog日志备份</h2><h3 id="1-脚本思路"><a href="#1-脚本思路" class="headerlink" title="1. 脚本思路"></a>1. 脚本思路</h3><p>mysql binlog日志备份脚本 备份到备份服务器</p>
<p>#1) 确定binlog的位置及备份时间间隔 每天</p>
<p>#当前要备份的binlog是谁</p>
<p>#刷新binlog日志，生成新的binlog用于存储备份节点后的数据</p>
<p>#2）打包binlog日志 以年-月-日_binlog.tar.gz格式</p>
<p>#3）生成校验码  md5sum</p>
<p>#4）将校验码和压缩包存入到文件夹 文件夹命名 年-月-日 再次打包</p>
<p>#5）使用scp拷贝到备份机器</p>
<p>#6）备份机器解压收到的目录压缩包  通过校验码 教研binlog压缩包是否完整</p>
<p>#完整  完成备份  —–发邮件给管理员，明确备份成功</p>
<p>#不完整 报错——发邮件给管理员，要求手动备份</p>
<h3 id="2-代码如下"><a href="#2-代码如下" class="headerlink" title="2. 代码如下"></a>2. 代码如下</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#Description:</span></span><br><span class="line"><span class="comment">#Author:</span></span><br><span class="line"><span class="comment">#Created Time:</span></span><br><span class="line"><span class="comment">#将mysql的binlog日志备份到备份服务器</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#思考</span></span><br><span class="line"><span class="comment">#1) 确定binlog的位置及备份时间间隔  每天</span></span><br><span class="line">    <span class="comment">#当前要备份的binlog是谁</span></span><br><span class="line">    <span class="comment">#刷新binlog日志，生成新的binlog用于存储备份节点后的数据</span></span><br><span class="line"><span class="comment">#2）打包binlog日志  以年-月-日_binlog.tar.gz格式</span></span><br><span class="line"><span class="comment">#3）生成校验码   md5sum</span></span><br><span class="line"><span class="comment">#4）将校验码和压缩包存入到文件夹  文件夹命名 年-月-日  再次打包</span></span><br><span class="line"><span class="comment">#5）使用scp拷贝到备份机器</span></span><br><span class="line"><span class="comment">#6）备份机器解压收到的目录压缩包   通过校验码 教研binlog压缩包是否完整</span></span><br><span class="line">    <span class="comment">#完整   完成备份   -----发邮件给管理员，明确备份成功</span></span><br><span class="line">    <span class="comment">#不完整 报错------发邮件给管理员，要求手动备份</span></span><br><span class="line"></span><br><span class="line"><span class="comment">########</span></span><br><span class="line">db_user=<span class="string">&#x27;root&#x27;</span></span><br><span class="line">db_password=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">log</span>=<span class="string">&#x27;/var/log/mysql_backup.log&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">backup</span></span>() &#123;</span><br><span class="line"><span class="comment">#获得信息</span></span><br><span class="line">binlog_dir=<span class="string">&#x27;/var/lib/mysql&#x27;</span></span><br><span class="line">current_binlog=`mysql -u <span class="variable">$db_user</span> -e <span class="string">&quot;show master status&quot;</span>|egrep <span class="string">&quot;binlog.[[:digit:]]*&quot;</span>|awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>`</span><br><span class="line"></span><br><span class="line">date &gt;&gt; <span class="variable">$log</span></span><br><span class="line"><span class="comment">#准备备份</span></span><br><span class="line"><span class="comment">#1 刷新binlog    </span></span><br><span class="line">mysql -u <span class="variable">$db_user</span> -e <span class="string">&quot;flush logs&quot;</span></span><br><span class="line"><span class="comment">#2 打包要备份的binlog</span></span><br><span class="line">tar czf `date +%F`_binlog.tar.gz <span class="variable">$binlog_dir</span>/<span class="variable">$current_binlog</span> &amp;&gt;&gt;<span class="variable">$log</span></span><br><span class="line"><span class="comment">#3 生成校验码</span></span><br><span class="line">md5sum `date +%F`_binlog.tar.gz &gt; <span class="string">&quot;`date +%F`_md5sum.txt&quot;</span></span><br><span class="line"><span class="comment">#4 存入文件夹</span></span><br><span class="line">[ ! -d `date +%F` ]&amp;&amp;mkdir `date +%F`</span><br><span class="line">mv  `date +%F`_binlog.tar.gz `date +%F`</span><br><span class="line">mv `date +%F`_md5sum.txt `date +%F`</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打包目录</span></span><br><span class="line">tar czf `date +%F`.tar.gz `date +%F` &amp;&gt;&gt;<span class="variable">$log</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#5 拷贝</span></span><br><span class="line"><span class="comment">#要求提前做证书信任</span></span><br><span class="line">scp `date +%F`.tar.gz root@192.168.11.241:/opt/backup &amp;&gt;&gt;<span class="variable">$log</span></span><br><span class="line"><span class="keyword">if</span> [ $? -ne 0 ];<span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;ERROR:scp `date +%F`.tar.gz fail&quot;</span> &amp;&gt;&gt;<span class="variable">$log</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#6 校验</span></span><br><span class="line">ssh root@192.168.11.241 <span class="string">&quot;tar xf /opt/backup/`date +%F`.tar.gz -C /opt&quot;</span></span><br><span class="line"><span class="comment">#ssh root@192.168.11.241 &quot;cd /opt/backup`date +%F`&quot;</span></span><br><span class="line">ssh root@192.168.11.241 <span class="string">&quot;cd /opt/`date +%F`;md5sum -c `date +%F`_md5sum.txt&quot;</span> &amp;&gt;&gt;<span class="variable">$log</span></span><br><span class="line"><span class="keyword">if</span> [ $? -eq 0 ];<span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;success&quot;</span> &amp;&gt;&gt;<span class="variable">$log</span></span><br><span class="line">   ssh root@192.168.11.241 <span class="string">&quot;rm -rf /opt/`date +%F`&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;fail&quot;</span> &amp;&gt;&gt;<span class="variable">$log</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">backup</span><br></pre></td></tr></table></figure>

<h2 id="七、新建用户脚本"><a href="#七、新建用户脚本" class="headerlink" title="七、新建用户脚本"></a>七、新建用户脚本</h2><blockquote>
<p><em><strong>需求：新建 user01 - user20用户，要求密码是随机6位数 密码取值范围 a-zA-Z0-9，要求密码不能只是单一的数字或小写或大写字母</strong></em></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#Description:</span></span><br><span class="line"><span class="comment">#Author:</span></span><br><span class="line"><span class="comment">#Created Time:</span></span><br><span class="line"><span class="comment">#创建user01-user20 随机六位数密码 a-zA-Z0-9 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1)创建user01-user20</span></span><br><span class="line"><span class="comment">#2)生成20组随机密码</span></span><br><span class="line"><span class="comment">#3)设置密码</span></span><br><span class="line"><span class="comment">#4)输出清单</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">adduser</span></span> () &#123;</span><br><span class="line">pw_txt=`mktemp pw.XXXXX`</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;account\t\tpassword&quot;</span> &gt; user_add_result.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">#1)创建用户</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `seq -s <span class="string">&#x27; &#x27;</span> -w 1 20`</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">      useradd user<span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">#2)随机密码</span></span><br><span class="line">  cat /dev/urandom |strings -6|egrep <span class="string">&quot;^[a-zA-Z0-9]&#123;6&#125;$&quot;</span>|head -n 20 &gt; <span class="variable">$pw_txt</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3)设置密码</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `seq -s <span class="string">&#x27; &#x27;</span> -w 1 20`;<span class="keyword">do</span></span><br><span class="line">    pw=`head -n <span class="variable">$i</span> <span class="variable">$pw_txt</span>|tail -1`</span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$pw</span>|passwd --stdin user<span class="variable">$i</span> &amp;&gt;/dev/null</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;user<span class="variable">$i</span>\t\t<span class="variable">$pw</span>&quot;</span> &gt;&gt; user_add_result.txt</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4)输出</span></span><br><span class="line">clear</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;用户创建成功，密码文件是:user_add_result.txt&quot;</span></span><br><span class="line">cat user_add_result.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rm -rf <span class="variable">$pw_txt</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">adduser</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <div>
        
          <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

        
      </div>

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/07/11/Python/" rel="prev" title="Python">
      <i class="fa fa-chevron-left"></i> Python
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/07/14/TCP%E5%8D%8F%E8%AE%AE/" rel="next" title="TCP协议">
      TCP协议 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#shell-%E4%BB%8B%E7%BB%8D"><span class="nav-text">shell 介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AFshell"><span class="nav-text">一、什么是shell</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81shell-%E5%8A%9F%E8%83%BD"><span class="nav-text">二、shell 功能</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#shell-%E8%AF%AD%E6%B3%95"><span class="nav-text">shell 语法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%A6%82%E4%BD%95%E6%8A%92%E5%86%99%E4%B8%80%E4%B8%AAshell%E8%84%9A%E6%9C%AC"><span class="nav-text">一、如何抒写一个shell脚本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%A6%82%E4%BD%95%E8%BF%90%E8%A1%8C%E4%B8%80%E4%B8%AAshell%E8%84%9A%E6%9C%AC"><span class="nav-text">二、如何运行一个shell脚本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81shell%E4%B8%AD%E7%9A%84%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7"><span class="nav-text">三、shell中的特殊符号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B%E3%80%81shell%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-text">四、shell重定向</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%94%E3%80%81shell%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97"><span class="nav-text">五、shell数学运算</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#shell%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%BE%93%E5%87%BA"><span class="nav-text">shell格式化输出</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81echo-%E5%91%BD%E4%BB%A4%E4%BB%8B%E7%BB%8D"><span class="nav-text">一、echo 命令介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E9%A2%9C%E8%89%B2%E4%BB%A3%E7%A0%81"><span class="nav-text">二、颜色代码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#shell%E4%BA%A4%E4%BA%92%E8%BE%93%E5%85%A5%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="nav-text">shell交互输入定义变量</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81read%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4"><span class="nav-text">一、read基本命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81read-%E5%9F%BA%E6%9C%AC%E7%A4%BA%E4%BE%8B"><span class="nav-text">二、read 基本示例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%98%E9%87%8F"><span class="nav-text">变量</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%8F%98%E9%87%8F%E4%BB%8B%E7%BB%8D"><span class="nav-text">一、变量介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%8F%98%E9%87%8F%E5%88%86%E7%B1%BB"><span class="nav-text">二、变量分类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E4%BD%BF%E7%94%A8%E5%8F%98%E9%87%8F"><span class="nav-text">三、使用变量</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="nav-text">1. 定义变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E8%AF%BB%E5%8F%96%E5%8F%98%E9%87%8F%E5%86%85%E5%AE%B9"><span class="nav-text">2. 读取变量内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E5%8F%96%E6%B6%88%E5%8F%98%E9%87%8F-unset"><span class="nav-text">3. 取消变量  unset</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E5%AE%9A%E4%B9%89%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F-export"><span class="nav-text">4. 定义全局变量 export</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E5%AE%9A%E4%B9%89%E6%B0%B8%E4%B9%85%E5%8F%98%E9%87%8F"><span class="nav-text">5. 定义永久变量</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E7%BB%84"><span class="nav-text">数组</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E6%95%B0%E7%BB%84%E4%BB%8B%E7%BB%8D"><span class="nav-text">一、数组介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%9F%BA%E6%9C%AC%E6%95%B0%E7%BB%84"><span class="nav-text">二、基本数组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%95%B0%E7%BB%84%E8%AF%AD%E6%B3%95"><span class="nav-text">1. 数组语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%95%B0%E7%BB%84%E8%AF%BB%E5%87%BA"><span class="nav-text">2. 数组读出</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%95%B0%E7%BB%84%E8%B5%8B%E5%80%BC"><span class="nav-text">3. 数组赋值</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%951%EF%BC%9A%E4%B8%80%E6%AC%A1%E8%B5%8B%E4%B8%80%E4%B8%AA%E5%80%BC"><span class="nav-text">方法1：一次赋一个值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%952%EF%BC%9A%E4%B8%80%E6%AC%A1%E8%B5%8B%E5%A4%9A%E4%B8%AA%E5%80%BC"><span class="nav-text">方法2：一次赋多个值</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E6%9F%A5%E7%9C%8B%E5%9F%BA%E6%9C%AC%E6%95%B0%E7%BB%84-a"><span class="nav-text">4. 查看基本数组-a</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E8%AE%BF%E9%97%AE%E6%95%B0%E7%BB%84%E5%85%83%E7%B4%A0"><span class="nav-text">5. 访问数组元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E9%81%8D%E5%8E%86%E6%95%B0%E7%BB%84"><span class="nav-text">6. 遍历数组</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E5%85%B3%E8%81%94%E6%95%B0%E7%BB%84"><span class="nav-text">三、关联数组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%AE%9A%E4%B9%89%E5%85%B3%E8%81%94%E6%95%B0%E7%BB%84"><span class="nav-text">1. 定义关联数组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%85%B3%E8%81%94%E6%95%B0%E7%BB%84%E8%B5%8B%E5%80%BC"><span class="nav-text">2. 关联数组赋值</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%951%EF%BC%9A%E4%B8%80%E6%AC%A1%E8%B5%8B%E4%B8%80%E4%B8%AA%E5%80%BC-1"><span class="nav-text">方法1：一次赋一个值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%952%EF%BC%9A%E4%B8%80%E6%AC%A1%E8%B5%8B%E5%A4%9A%E4%B8%AA%E5%80%BC-1"><span class="nav-text">方法2：一次赋多个值</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%9F%A5%E7%9C%8B%E5%85%B3%E8%81%94%E6%95%B0%E7%BB%84-A"><span class="nav-text">3. 查看关联数组-A</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E8%AE%BF%E9%97%AE%E6%95%B0%E7%BB%84%E5%85%83%E7%B4%A0"><span class="nav-text">4. 访问数组元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E9%81%8D%E5%8E%86%E6%95%B0%E7%BB%84"><span class="nav-text">5. 遍历数组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E7%AE%80%E5%8D%95%E7%9A%84%E5%AD%A6%E5%91%98%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F"><span class="nav-text">6. 简单的学员信息系统</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#shell%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6-if%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5"><span class="nav-text">shell流程控制-if判断语句</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81shell%E4%B8%AD%E7%9A%84%E8%BF%90%E7%AE%97"><span class="nav-text">一、shell中的运算</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%95%B0%E5%AD%A6%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97"><span class="nav-text">1. 数学比较运算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97"><span class="nav-text">2. 字符串比较运算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%96%87%E4%BB%B6%E6%AF%94%E8%BE%83%E4%B8%8E%E6%A3%80%E6%9F%A5"><span class="nav-text">3. 文件比较与检查</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97"><span class="nav-text">4. 逻辑运算</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81if-%E8%AF%AD%E6%B3%95"><span class="nav-text">二、if 语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%AF%AD%E6%B3%95%E4%B8%80%EF%BC%9A-%E5%8D%95if%E8%AF%AD%E5%8F%A5"><span class="nav-text">1. 语法一： 单if语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E8%AF%AD%E6%B3%95%E4%BA%8C%EF%BC%9A-if-else%E8%AF%AD%E5%8F%A5"><span class="nav-text">2. 语法二： if-else语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E8%AF%AD%E6%B3%95%E4%B8%89-if-elif-else%E8%AF%AD%E5%8F%A5"><span class="nav-text">3. 语法三: if-elif-else语句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81if-%E9%AB%98%E7%BA%A7%E5%BA%94%E7%94%A8"><span class="nav-text">三、if 高级应用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BE%AA%E7%8E%AF%E8%84%9A%E6%9C%AC%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5"><span class="nav-text">循环脚本控制语句</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-text">特殊条件表达式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95-continue%E3%80%81break%E3%80%81exit-%E8%AF%AD%E5%8F%A5%E7%9A%84%E4%B8%8D%E5%90%8C%E7%82%B9"><span class="nav-text">测试 continue、break、exit 语句的不同点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-sleep-N-%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E5%88%B0%E8%AF%A5%E6%AD%A5%E4%BC%91%E7%9C%A0N%E7%A7%92"><span class="nav-text">1. sleep   N   脚本执行到该步休眠N秒</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-continue-%E8%B7%B3%E8%BF%87%E5%BE%AA%E7%8E%AF%E4%B8%AD%E7%9A%84%E6%9F%90%E6%AC%A1%E5%BE%AA%E7%8E%AF"><span class="nav-text">2. continue 跳过循环中的某次循环</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-break-%E8%B7%B3%E5%87%BA%E5%BE%AA%E7%8E%AF%E7%BB%A7%E7%BB%AD%E6%89%A7%E8%A1%8C%E5%90%8E%E7%BB%AD%E4%BB%A3%E7%A0%81"><span class="nav-text">3. break 跳出循环继续执行后续代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-exit-%E9%80%80%E5%87%BA%E5%BD%93%E5%89%8D%E8%84%9A%E6%9C%AC"><span class="nav-text">4. exit  退出当前脚本</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#shell%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6-for%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5"><span class="nav-text">shell流程控制-for循环语句</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81for-%E5%BE%AA%E7%8E%AF%E4%BB%8B%E7%BB%8D"><span class="nav-text">一、for 循环介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81for%E8%AF%AD%E6%B3%95"><span class="nav-text">二、for语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-for-%E8%AF%AD%E6%B3%95%E4%B8%80"><span class="nav-text">1. for 语法一</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-for%E8%AF%AD%E6%B3%95%E4%BA%8C"><span class="nav-text">2. for语法二</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#shell%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6-while%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5"><span class="nav-text">shell流程控制-while循环语句</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81while%E5%BE%AA%E7%8E%AF%E4%BB%8B%E7%BB%8D"><span class="nav-text">一、while循环介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81while%E5%BE%AA%E7%8E%AF%E8%AF%AD%E6%B3%95"><span class="nav-text">二、while循环语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81while%E5%AE%9E%E6%88%98"><span class="nav-text">三、while实战</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%B7%B3%E6%9D%BF%E6%9C%BA%E8%84%9A%E6%9C%AC"><span class="nav-text">1. 跳板机脚本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="nav-text">2. 遍历文件内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E8%AF%BB%E5%87%BA%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%88%97%EF%BC%8CIFS%E6%8C%87%E5%AE%9A%E9%BB%98%E8%AE%A4%E7%9A%84%E5%88%97%E5%88%86%E9%9A%94%E7%AC%A6"><span class="nav-text">3. 读出文件中的列，IFS指定默认的列分隔符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E6%89%B9%E9%87%8F%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7-%E5%8F%8A-%E8%AE%BE%E7%BD%AE%E5%AF%86%E7%A0%81"><span class="nav-text">4. 批量创建用户 及 设置密码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#until%E8%AF%AD%E5%8F%A5"><span class="nav-text">until语句</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81until%E4%BB%8B%E7%BB%8D"><span class="nav-text">一、until介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81until%E8%AF%AD%E6%B3%95"><span class="nav-text">二、until语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E6%A1%88%E4%BE%8B"><span class="nav-text">三、案例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#case%E5%A4%9A%E6%9D%A1%E4%BB%B6%E5%88%86%E6%94%AF%E8%AF%AD%E5%8F%A5"><span class="nav-text">case多条件分支语句</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81case%E4%BB%8B%E7%BB%8D"><span class="nav-text">一、case介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81case%E8%AF%AD%E6%B3%95"><span class="nav-text">二、case语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81shell%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F"><span class="nav-text">三、shell特殊变量</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#shell%E5%87%BD%E6%95%B0"><span class="nav-text">shell函数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%87%BD%E6%95%B0%E4%BB%8B%E7%BB%8D"><span class="nav-text">一、函数介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%87%BD%E6%95%B0%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="nav-text">二、函数的语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81Shell%E5%87%BD%E6%95%B0%E7%9A%84%E9%80%80%E5%87%BA%E5%8F%8A%E5%88%A0%E9%99%A4"><span class="nav-text">三、Shell函数的退出及删除</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E5%87%BD%E6%95%B0%E7%9A%84%E5%8F%98%E9%87%8F%E6%A6%82%E5%BF%B5"><span class="nav-text">四、函数的变量概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E5%87%BD%E6%95%B0%E7%9A%84%E5%BA%94%E7%94%A8"><span class="nav-text">五、函数的应用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E4%BA%A4%E4%BA%92-expect-%E8%AF%A6%E8%A7%A3"><span class="nav-text">自动化交互 expect 详解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81expect%E4%BB%8B%E7%BB%8D"><span class="nav-text">一、expect介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%AE%89%E8%A3%85-expect-%E5%B7%A5%E5%85%B7"><span class="nav-text">二、安装 expect 工具</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81expect%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-text">三、expect常用命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B%E3%80%81expect-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="nav-text">四、expect 基本语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%94%E3%80%81expect-%E5%BA%94%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="nav-text">五、expect 应用案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B1%EF%BC%9Aexpect%E8%87%AA%E5%8A%A8%E4%BA%A4%E4%BA%92ssh%E8%BF%9C%E7%A8%8B%E7%99%BB%E5%BD%95"><span class="nav-text">案例1：expect自动交互ssh远程登录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B2%EF%BC%9Aexpect%E8%87%AA%E5%8A%A8%E4%BA%A4%E4%BA%92%E5%BC%8F%E7%AE%A1%E7%90%86%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="nav-text">案例2：expect自动交互式管理执行命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B3%EF%BC%9Aexpect%E8%87%AA%E5%8A%A8%E5%8C%96%E4%B8%8B%E5%8F%91%E8%84%9A%E6%9C%AC%EF%BC%8C%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%EF%BC%88%E7%BB%93%E5%90%88%E6%A1%88%E4%BE%8B2%EF%BC%89"><span class="nav-text">案例3：expect自动化下发脚本，执行脚本（结合案例2）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B4%EF%BC%9Aexpect-%E5%8F%98%E9%87%8F%E7%9A%84%E7%BB%83%E4%B9%A0"><span class="nav-text">案例4：expect 变量的练习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B5%EF%BC%9Aexpect-%E7%BB%93%E5%90%88-if-%E7%9A%84%E7%BB%83%E4%B9%A0%EF%BC%8C"><span class="nav-text">案例5：expect 结合 if 的练习，</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Linux-%E4%BF%A1%E5%8F%B7%E6%8E%A7%E5%88%B6"><span class="nav-text">Linux 信号控制</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#shell%E6%A1%88%E4%BE%8B"><span class="nav-text">shell案例</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E7%9B%91%E6%8E%A7%E4%B8%BB%E6%9C%BA%E5%8F%8A%E8%81%94%E7%BD%91%E7%8A%B6%E6%80%81"><span class="nav-text">一、监控主机及联网状态</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E7%9B%91%E6%8E%A7%E7%9B%AE%E7%9A%84"><span class="nav-text">1. 监控目的</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E7%9B%91%E6%8E%A7%E6%96%B9%E6%B3%95"><span class="nav-text">2. 监控方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E7%9B%91%E6%8E%A7%E6%80%9D%E8%B7%AF"><span class="nav-text">3. 监控思路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E7%9B%91%E6%8E%A7%E5%AE%9E%E7%8E%B0"><span class="nav-text">4. 监控实现</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E7%9B%91%E6%8E%A7%E4%B8%BB%E6%9C%BA%E6%9C%8D%E5%8A%A1%E7%8A%B6%E6%80%81"><span class="nav-text">二、监控主机服务状态</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E7%9B%91%E6%8E%A7%E7%9B%AE%E7%9A%84-1"><span class="nav-text">1. 监控目的</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E7%9B%91%E6%8E%A7%E6%96%B9%E6%B3%95-1"><span class="nav-text">2. 监控方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E7%9B%91%E6%8E%A7%E5%AE%9E%E7%8E%B0"><span class="nav-text">3. 监控实现</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E7%9B%91%E6%8E%A7%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8%E7%8E%87"><span class="nav-text">三、监控内存使用率</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E7%9B%91%E6%8E%A7%E7%9B%AE%E7%9A%84-2"><span class="nav-text">1. 监控目的</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E7%9B%91%E6%8E%A7%E6%96%B9%E6%B3%95-2"><span class="nav-text">2. 监控方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1%EF%BC%89%E7%9B%91%E6%8E%A7%E5%91%BD%E4%BB%A4"><span class="nav-text">2.1）监控命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2%EF%BC%89%E7%9B%91%E6%8E%A7%E6%8C%87%E6%A0%87"><span class="nav-text">2.2）监控指标</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3%EF%BC%89%E7%9B%91%E6%8E%A7%E6%96%B9%E6%B3%95"><span class="nav-text">2.3）监控方法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E7%9B%91%E6%8E%A7%E5%AE%9E%E7%8E%B0-1"><span class="nav-text">3. 监控实现</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E7%9B%91%E6%8E%A7%E4%BD%BF%E7%94%A8CPU%E6%88%96%E5%86%85%E5%AD%98%E5%89%8D%E5%8D%81%E5%90%8D%E8%BF%9B%E7%A8%8B"><span class="nav-text">四、监控使用CPU或内存前十名进程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E7%9B%91%E6%8E%A7%E7%9B%AE%E7%9A%84-3"><span class="nav-text">1. 监控目的</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E7%9B%91%E6%8E%A7%E6%96%B9%E6%B3%95-3"><span class="nav-text">2. 监控方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1%EF%BC%89%E7%9B%91%E6%8E%A7%E5%91%BD%E4%BB%A4-1"><span class="nav-text">2.1）监控命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2%EF%BC%89%E7%9B%91%E6%8E%A7%E6%96%B9%E6%B3%95"><span class="nav-text">2.2）监控方法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E7%9B%91%E6%8E%A7%E5%AE%9E%E7%8E%B0-2"><span class="nav-text">3. 监控实现</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E7%9B%91%E6%8E%A7IO%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5"><span class="nav-text">五、监控IO使用情况</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E7%A3%81%E7%9B%98%E8%AF%B4%E6%98%8E"><span class="nav-text">1. 磁盘说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E7%9B%91%E6%8E%A7%E7%9B%AE%E7%9A%84"><span class="nav-text">2. 监控目的</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E7%9B%91%E6%8E%A7%E6%8C%87%E6%A0%87"><span class="nav-text">3. 监控指标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E7%9B%91%E6%8E%A7%E5%91%BD%E4%BB%A4"><span class="nav-text">4. 监控命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-iostat%E8%AF%AD%E6%B3%95-%E5%8F%8A-%E8%BE%93%E5%87%BA%E8%AF%B4%E6%98%8E"><span class="nav-text">5. iostat语法 及 输出说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E7%9B%91%E6%8E%A7%E5%AE%9E%E7%8E%B0"><span class="nav-text">6. 监控实现</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AD%E3%80%81mysql-binlog%E6%97%A5%E5%BF%97%E5%A4%87%E4%BB%BD"><span class="nav-text">六、mysql binlog日志备份</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%84%9A%E6%9C%AC%E6%80%9D%E8%B7%AF"><span class="nav-text">1. 脚本思路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E4%BB%A3%E7%A0%81%E5%A6%82%E4%B8%8B"><span class="nav-text">2. 代码如下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%83%E3%80%81%E6%96%B0%E5%BB%BA%E7%94%A8%E6%88%B7%E8%84%9A%E6%9C%AC"><span class="nav-text">七、新建用户脚本</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Armin"
      src="/uploads/armin.png">
  <p class="site-author-name" itemprop="name">Armin</p>
  <div class="site-description" itemprop="description">记录生活中的点点滴滴</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/" title="GitHub → https:&#x2F;&#x2F;github.com" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://aws.amazon.com/cn/" title="AWS → https:&#x2F;&#x2F;aws.amazon.com&#x2F;cn&#x2F;" rel="noopener" target="_blank"><i class="fab fa-aws fa-fw"></i>AWS</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.processon.com/" title="processon → https:&#x2F;&#x2F;www.processon.com&#x2F;" rel="noopener" target="_blank"><i class="fab fa-accusoft fa-fw"></i>processon</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.cn-ki.net/" title="知识库 → https:&#x2F;&#x2F;www.cn-ki.net&#x2F;" rel="noopener" target="_blank"><i class="fas fa-book-open fa-fw"></i>知识库</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tophub.today/" title="看新闻 → https:&#x2F;&#x2F;tophub.today&#x2F;" rel="noopener" target="_blank"><i class="far fa-newspaper fa-fw"></i>看新闻</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://m.zxjsq.net/" title="计算器 → http:&#x2F;&#x2F;m.zxjsq.net" rel="noopener" target="_blank"><i class="fas fa-calculator fa-fw"></i>计算器</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://shijisuishu.bmcx.com/20010314__shijisuishu/" title="计龄器 → https:&#x2F;&#x2F;shijisuishu.bmcx.com&#x2F;20010314__shijisuishu&#x2F;" rel="noopener" target="_blank"><i class="fas fa-calculator fa-fw"></i>计龄器</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tool.oschina.net/hexconvert" title="进制转换 → https:&#x2F;&#x2F;tool.oschina.net&#x2F;hexconvert" rel="noopener" target="_blank"><i class="fas fa-calculator fa-fw"></i>进制转换</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.sojson.com/convert/subnetmask.html" title="子网计算 → https:&#x2F;&#x2F;www.sojson.com&#x2F;convert&#x2F;subnetmask.html" rel="noopener" target="_blank"><i class="fas fa-calculator fa-fw"></i>子网计算</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.baidu.com/" title="百度一下 → https:&#x2F;&#x2F;www.baidu.com&#x2F;" rel="noopener" target="_blank"><i class="fas fa-search fa-fw"></i>百度一下</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2020 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Armin</span>
</div>

<div class="powered-by">

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
