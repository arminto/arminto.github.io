<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>MySQL | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="article">
<meta property="og:title" content="MySQL">
<meta property="og:url" content="http://example.com/2020/10/18/MySQL/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtm16wflwj30q30fat9c.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtm1p5wu1j30sj0e4js0.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjtla0xxmnj30nn0ko76o.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjtlar24zej31110md0vv.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlbn4z6aj31by0c2di2.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtld1pfbij30ur0efabd.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtldgpr9aj30q60enab2.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlermaqrj30og09b0to.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlf7qv26j30ol0a0wfl.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlfo7omfj30on098dgs.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlg5he4nj30pp09w74f.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlh1c0eqj30po09uwem.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlhhj27xj30ps0aodg0.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlhuhe8cj30po0a00sv.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlibl446j30pj0a30sv.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlinca48j30kb0a4gm2.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlizwvhwj30lq0a2t8o.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtljekgx9j30oc0a0aaa.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtljoxryzj30sk08qa9y.jpg">
<meta property="article:published_time" content="2020-10-18T08:17:12.000Z">
<meta property="article:modified_time" content="2021-06-05T14:45:00.294Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="db">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtm16wflwj30q30fat9c.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-MySQL" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/10/18/MySQL/" class="article-date">
  <time class="dt-published" datetime="2020-10-18T08:17:12.000Z" itemprop="datePublished">2020-10-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      MySQL
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <!--toc-->
<span id="more"></span>

<h1 id="一、数据库概念"><a href="#一、数据库概念" class="headerlink" title="一、数据库概念"></a>一、数据库概念</h1><blockquote>
<p>数据库（Database）</p>
</blockquote>
<p>数据库, 简而言之可视为电子化的文件柜—存储电子文件的处所, 用户可以对文件中的数据运行新增、截取、更新、删除等操作。</p>
<p>所谓 “数据库” 系以一定方式储存在一起、能予多个用户共享、具有尽可能小的冗余度、与应用程序彼此独立的数据集合。</p>
<blockquote>
<p>数据库架构</p>
</blockquote>
<p>数据库的架构可以大致区分为三个概括层次：内层、概念层和外层。</p>
<ul>
<li><p>概念层：介于两者之间的间接层</p>
</li>
<li><p>外层：最接近用户，即有关个别用户观看数据的方式。</p>
</li>
<li><p>内层：最接近实际存储体，亦即有关数据的实际存储方式。</p>
</li>
</ul>
<h2 id="1-数据库管理系统（DBMS）"><a href="#1-数据库管理系统（DBMS）" class="headerlink" title="1. 数据库管理系统（DBMS）"></a>1. 数据库管理系统（DBMS）</h2><blockquote>
<p>数据库管理系统（Database Management System，简称DBMS）是为管理数据库而设计的电脑软件系统，一般具有存储、截取、安全保障、备份等基础功能。</p>
</blockquote>
<p><strong>数据库管理系统主要分为以下两类：</strong></p>
<h3 id="1-1-关系型数据库-RDB"><a href="#1-1-关系型数据库-RDB" class="headerlink" title="1.1 关系型数据库 RDB"></a>1.1 关系型数据库 RDB</h3><p>关系数据库是创建在关系模型基础上的数据库，借助于集合代数等数学概念和方法来处理数据库中的数据。现实世界中的各种实体以及实体之间的各种联系均用关系模型来表示。</p>
<p>典型代表有：MySQL、Oracle、Microsoft SQL Server、Access及PostgreSQL等</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtm16wflwj30q30fat9c.jpg"></p>
<p><strong>优点：</strong></p>
<p>1、易于维护：都是使用表结构，格式一致；</p>
<p>2、使用方便：SQL语言通用，可用于复杂查询；</p>
<p>3、复杂操作：支持SQL，可用于一个表以及多个表之间非常复杂的查询。</p>
<p><strong>缺点：</strong></p>
<p>1、因为事务所以读写性能比较差，尤其是海量数据的高效率读写；</p>
<p>2、固定的表结构，灵活度稍欠；</p>
<p>3、高并发读写需求，传统关系型数据库来说，硬盘I/O是一个很大的瓶颈。</p>
<h3 id="1-2-非关系型数据库-NoSQL"><a href="#1-2-非关系型数据库-NoSQL" class="headerlink" title="1.2 非关系型数据库 NoSQL"></a>1.2 非关系型数据库 NoSQL</h3><p>非关系型数据库是对不同于传统的关系数据库的数据库管理系统的统称,与关系数据库最大的不同点是不使用SQL作为查询语言</p>
<p>典型代表有：Neo4J、HBase、MongoDB、Redis；</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtm1p5wu1j30sj0e4js0.jpg"></p>
<p><strong>优点：</strong></p>
<p>1、存储数据的格式可以是key,value形式  文档形式  图片形式等等, 使用灵活, 应用场景广泛, 而关系型数据库则只支持基础类型。</p>
<p>2、速度快：nosql可以使用硬盘或者内存作为载体，而关系型数据库只能使用硬盘。</p>
<p>3、成本低：nosql数据库部署简单，基本都是开源软件。</p>
<p><strong>缺点：</strong></p>
<p>1、没有标准化</p>
<p>2、不提供sql支持，学习和使用成本较高。</p>
<p>3、数据结构相对复杂，复杂查询方面稍欠。</p>
<h3 id="1-3-RDBMS-vs-NoSQL"><a href="#1-3-RDBMS-vs-NoSQL" class="headerlink" title="1.3 RDBMS vs NoSQL"></a>1.3 RDBMS vs NoSQL</h3><blockquote>
<p>关系型数据库管理系统的具体应用场景和应用领域</p>
</blockquote>
<p>sql server是微软公司的产品，主要应用于大中型企业；如联想、方正等<br>oracle主要用于银行、铁路、飞机场等。该数据库功能强大，软件费用高。也是甲骨文公司的产品。<br>mysql主要用于大型门户，例如搜狗、新浪等，它主要的优势就是开放源代码，因为开放源代码这个数据库是免费的，他现在是甲骨文公司的产品。</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjtla0xxmnj30nn0ko76o.jpg"></p>
<h2 id="2-关系型数据库遵循ACID规则"><a href="#2-关系型数据库遵循ACID规则" class="headerlink" title="2. 关系型数据库遵循ACID规则"></a>2. 关系型数据库遵循ACID规则</h2><blockquote>
<p>事务在英文中是transaction，和现实世界中的交易很类似，它有如下四个特性：</p>
</blockquote>
<h3 id="2-1-什么是事务？"><a href="#2-1-什么是事务？" class="headerlink" title="2.1 什么是事务？"></a>2.1 什么是事务？</h3><p>事务可以是n条sql语句；n &gt;= 0 。</p>
<p>不是所有数据库引擎支持事务，InnoDB引擎支持事务处理。</p>
<p>事务就是由一组SQL语句组成的，保证一组SQL语句要么全部执行成功，要么全部执行失败，以此维护数据的完整性。也就是要么都成功要么都失败。</p>
<h3 id="2-2-事务的四大特性-transaction"><a href="#2-2-事务的四大特性-transaction" class="headerlink" title="2.2 事务的四大特性(transaction)"></a>2.2 事务的四大特性(transaction)</h3><p><strong>关系型数据库遵循 ACID 规则，和现实世界中的交易很类似，它有如下四个特性：</strong></p>
<p>1、A (Atomicity) 原子性</p>
<p>一个事务中的所有操作，要么全部完成，要么全部不完成，不会结束在中间的某个环节上。事务在执行过程中如果发生错误，就会被回滚（Rollback）到事务开始前的状态，就像这个事务从来没有被执行过一样。<br>比如银行转账：从A账户转100元至B账户，分为两个步骤：1）从A账户取100元；2）存入100元至B账户。这两步要么都完成，要么都不完成；如果只完成第一步，第二步失败，钱会莫名其妙少了100元。</p>
<p>2、C (Consistency) 一致性</p>
<p>一致性也比较容易理解，也就是说数据库要一直处于一致的状态，事务的运行不会改变数据库原本的一致性约束。<br>例如：现有完整性约束a+b=10，如果一个事务改变了a，那么必须得改变b，使得事务结束后依然满足a+b=10，总和不会变；否则事务失败。</p>
<p>3、I (Isolation) 独立性；也叫隔离性</p>
<p>所谓的独立性是指并发多个事务之间保持数据的隔离，如果一个事务要访问的数据正在被另外一个事务修改，只要另外一个事务未提交，它所访问的数据就不受未提交事务的影响。<br>比如：现在有个交易是从A账户转100元至B账户，在这个交易还未完成的情况下，如果此时B查询自己的账户，是看不到新增加的100元的。</p>
<p>4、D (Durability) 持久性</p>
<p>持久性是指一旦事务提交后，它所做的修改将会永久的保存在数据库上，即使出现宕机也不会丢失。</p>
<h3 id="2-3-没有事务隔离会怎样？"><a href="#2-3-没有事务隔离会怎样？" class="headerlink" title="2.3 没有事务隔离会怎样？"></a>2.3 没有事务隔离会怎样？</h3><p>脏读：比如事务A读到未提交事务B修改的数据，如果此时事务B中途执行失败回滚，那么此时事务A读取到的就是脏数据。再比如事务A对money进行修改，此时事务B读取到事务A的更新结果，但是如果后面事务A回滚，那么事务B读取到的就是脏数据了。</p>
<p>不可重复读：同一个事务中，对同一份数据读取的结果不一致。事务A在事务B对数据更新前进行读取，然后事务B更新提交，事务A再次读取，这时候两次读取的数据不同。</p>
<p>幻读：同一个事务中，同一个查询多次返回的结果不一样。事务B查询表的记录数，然后事务A对表插入一条记录，接着事务B再次查询发现记录数不同。</p>
<h3 id="2-4-他们之间的区别"><a href="#2-4-他们之间的区别" class="headerlink" title="2.4 他们之间的区别"></a>2.4 他们之间的区别</h3><p>脏读和不可重复读：脏读是zz事务读取了还未提交事务的更新数据。不可重复读是同一个事务中，几次读取的数据不同。</p>
<p>不可重复读和幻读的区别：都是在同一个事务中，前者是几次读取数据不同，后者是几次读取数据整体不同；大致的区别在于不可重复读是由于另一个事务对数据的更改所造成的，而幻读是由于另一个事务插入或删除引起的。</p>
<h3 id="2-5-隔离级别-重点"><a href="#2-5-隔离级别-重点" class="headerlink" title="2.5 隔离级别(重点)"></a>2.5 隔离级别(重点)</h3><table>
<thead>
<tr>
<th>隔离级别</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>Serializable(串行化)</td>
<td>避免脏读、不可重复读、幻读</td>
</tr>
<tr>
<td>Repeatable(可重复读)</td>
<td>避免脏读、不可重复读（默认）</td>
</tr>
<tr>
<td>Read committed(读已提交）</td>
<td>避免脏读</td>
</tr>
<tr>
<td>Read uncommitted(读未提交)</td>
<td>none</td>
</tr>
</tbody></table>
<h2 id="3-MySQL三大范式"><a href="#3-MySQL三大范式" class="headerlink" title="3. MySQL三大范式"></a>3. MySQL三大范式</h2><blockquote>
<p>分别是：原子性，唯一性，冗余性</p>
</blockquote>
<h3 id="3-1-第一范式"><a href="#3-1-第一范式" class="headerlink" title="3.1 第一范式"></a>3.1 第一范式</h3><p>1NF是对属性的 <strong>原子性</strong>，要求属性具有原子性，不可再分解；</p>
<h3 id="3-2-第二范式"><a href="#3-2-第二范式" class="headerlink" title="3.2 第二范式"></a>3.2 第二范式</h3><p>2NF是对记录的 <strong>惟一性</strong>，要求记录有惟一标识，即实体的惟一性，即不存在部分依赖；</p>
<h3 id="3-3-第三范式"><a href="#3-3-第三范式" class="headerlink" title="3.3 第三范式"></a>3.3 第三范式</h3><p>3NF是对字段的 <strong>冗余性</strong>，要求任何字段不能由其他字段派生出来，它要求字段没有冗余，即不存在传递依赖；</p>
<h2 id="4-Mysql整体架构（重点）"><a href="#4-Mysql整体架构（重点）" class="headerlink" title="4. Mysql整体架构（重点）"></a>4. Mysql整体架构（重点）</h2><h3 id="4-1-MySQL架构图"><a href="#4-1-MySQL架构图" class="headerlink" title="4.1 MySQL架构图"></a>4.1 MySQL架构图</h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjtlar24zej31110md0vv.jpg"></p>
<h3 id="4-2-MySQL组件作用"><a href="#4-2-MySQL组件作用" class="headerlink" title="4.2 MySQL组件作用"></a>4.2 MySQL组件作用</h3><p><strong>1、连接池（connectors）：</strong>最上层负责和客户端进行连接，比如jdbc，odbj这样的数据库连接的API，在这一层有连接池的概念，类似于线程池，连接池可以同时处理很多个数据库请求。同时这一层有SSL的安全概念，可以确保连接是安全的。</p>
<p>一句话，可以对这个产品进行二次开发及通过这个api接口去操作这个数据。</p>
<p><strong>2、SQL接口（SQL Interface）：</strong>当SQL语句进入MySQL后, 会先到SQL接口中，这一层是封装层，将传过来的SQL语句拆散，将底层的结果封装成SQL的数据格式。</p>
<p>一句话，就是对SQL语句进行封装，如果不封装，底层就不知道这条SQL语句是什么意思。</p>
<p><strong>3、解析器（parser）：</strong>这一层负责将SQL语句进行拆分，验证，如果语句有问题那么就返回错误，如果没问题就继续向下执行。</p>
<p>一句话，检查客户端敲的SQL语句是否正确。</p>
<p><strong>4、优化器（Optimizer）：</strong>对SQL查询的结果优化处理,产生多种执行计划,最终数据库会选择最优化的方案去执行,尽快返会结果</p>
<p>比如select a,b from c where d, 在这里会先查询c表中符合d的数据并将他们的ab项进行投影, 返回结果, 并不会直接把整张表查出</p>
<p><strong>5、缓存（caches &amp;Buffers）：</strong>对要查询的SQL语句进行hash后缓存，如果下一次是相同的查询语句，则会直接返回结果。</p>
<p>他的主要作用就是加快查询速度。</p>
<p><strong>6、存储引擎（pluggable Storage Englnes）：</strong>MySQL有很多种存储引擎，每一种存储引擎有不同的特性，他们负责组织文件的存放形式，位置，访问文件的方法等等。比较常用的有innoDB，MyISAM，MEMORY等；</p>
<p><strong>7、文件系统（File System）：</strong>真正存放物理文件的单位；</p>
<h2 id="5-MySQL常见的表引擎"><a href="#5-MySQL常见的表引擎" class="headerlink" title="5. MySQL常见的表引擎"></a>5. MySQL常见的表引擎</h2><h3 id="5-1-InnoDB"><a href="#5-1-InnoDB" class="headerlink" title="5.1 InnoDB"></a>5.1 InnoDB</h3><blockquote>
<p>事务型速记的首选引擎，支持ACID事务，支持行级锁定，MySQL5.5成为默认数据库引擎</p>
</blockquote>
<p>1、配合一些热备工具可以支持在线热备份；</p>
<p>2、可以通过自动增长列，方法是auto_increment。</p>
<p>3、使用的锁粒度为行级锁，可以支持更高的并发；</p>
<p>4、支持外键约束；外键约束其实降低了表的查询速度，但是增加了表之间的耦合度。</p>
<p>5、支持事务。默认的事务隔离级别为可重复度，通过MVCC（并发版本控制）来实现的。</p>
<p>6、在InnoDB中存在着缓冲管理，通过缓冲池，将索引和数据全部缓存起来，加快查询的速度；</p>
<p>7、对于InnoDB类型的表，所有的数据按照主键来组织。数据和索引放在一块，都位于B+树的叶子节点上；</p>
<h3 id="5-2-Myisam"><a href="#5-2-Myisam" class="headerlink" title="5.2 Myisam"></a>5.2 Myisam</h3><blockquote>
<p>使用这个存储引擎，每个MyISAM在磁盘上存储成三个文件。</p>
</blockquote>
<p>1、frm文件：存储表的定义数据</p>
<p>2、MYD文件：存放表具体记录的数据</p>
<p>3、MYI文件：存储索引</p>
<h3 id="5-3-对比-InnoDB-和-Myisam"><a href="#5-3-对比-InnoDB-和-Myisam" class="headerlink" title="5.3 对比 InnoDB 和 Myisam"></a>5.3 对比 InnoDB 和 Myisam</h3><table>
<thead>
<tr>
<th>功能</th>
<th>MyISAM</th>
<th>InnoDB</th>
<th>MEMORY</th>
</tr>
</thead>
<tbody><tr>
<td>功能限制</td>
<td>256TB</td>
<td>64TB</td>
<td>RAM</td>
</tr>
<tr>
<td>支持事务</td>
<td>NO</td>
<td>YES</td>
<td>NO</td>
</tr>
<tr>
<td>支持全文索引</td>
<td>NO</td>
<td>YES</td>
<td>NO</td>
</tr>
<tr>
<td>支持B+树索引</td>
<td>YES</td>
<td>YES</td>
<td>YES</td>
</tr>
<tr>
<td>支持哈希索引</td>
<td>NO</td>
<td>NO</td>
<td>YES</td>
</tr>
<tr>
<td>支持集群索引</td>
<td>NO</td>
<td>YES</td>
<td>NO</td>
</tr>
<tr>
<td>支持数据索引</td>
<td>NO</td>
<td>YES</td>
<td>YES</td>
</tr>
<tr>
<td>支持数据压缩</td>
<td>YES</td>
<td>NO</td>
<td>NO</td>
</tr>
<tr>
<td>空间使用率</td>
<td>低</td>
<td>N/A</td>
<td>高</td>
</tr>
<tr>
<td>支持外键</td>
<td>NO</td>
<td>YES</td>
<td>NO</td>
</tr>
</tbody></table>
<h1 id="二、MySQL-安装部署"><a href="#二、MySQL-安装部署" class="headerlink" title="二、MySQL 安装部署"></a>二、MySQL 安装部署</h1><blockquote>
<p><strong>MySQL官网地址：<a target="_blank" rel="noopener" href="https://www.mysql.com/">https://www.mysql.com/</a></strong></p>
</blockquote>
<h2 id="1、初始化环境"><a href="#1、初始化环境" class="headerlink" title="1、初始化环境"></a>1、初始化环境</h2><table>
<thead>
<tr>
<th>系统类型</th>
<th>IP地址</th>
<th>主机名</th>
<th>所需软件</th>
<th>硬件</th>
</tr>
</thead>
<tbody><tr>
<td>Centos 7.4</td>
<td>192.168.1.1</td>
<td>Mysql</td>
<td>mysql-5.7.12.tar.gz  boost_1_59_0.tar.bz2</td>
<td>内存：2G CPU核心：2</td>
</tr>
</tbody></table>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// 修改主机名</span><br><span class="line">[root@localhost ~]<span class="comment"># hostnamectl set-hostname mysql &amp;&amp; logout</span></span><br><span class="line"></span><br><span class="line">// 关闭firewald &amp; selinux</span><br><span class="line">[root@mysql ~]<span class="comment"># systemctl stop firewalld</span></span><br><span class="line">[root@mysql ~]<span class="comment"># systemctl disable firewalld</span></span><br><span class="line">[root@mysql ~]<span class="comment"># setenforce 0</span></span><br><span class="line"></span><br><span class="line">// 添加mysql用户和组</span><br><span class="line">[root@mysql ~]<span class="comment"># groupadd mysql &amp;&amp; useradd -r -g mysql mysql</span></span><br><span class="line"></span><br><span class="line">// 移除系统自带数据库服务（没有请忽略）</span><br><span class="line">[root@mysql ~]<span class="comment"># yum -y remove mysql-* boost-*</span></span><br><span class="line">[root@mysql ~]<span class="comment"># rpm -qa mysql</span></span><br><span class="line">[root@mysql ~]<span class="comment"># rpm -qa boost</span></span><br></pre></td></tr></table></figure>

<h2 id="2、下载Mysql包"><a href="#2、下载Mysql包" class="headerlink" title="2、下载Mysql包"></a>2、下载Mysql包</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 下载</span><br><span class="line">[root@mysql ~]<span class="comment"># cd /usr/local/src</span></span><br><span class="line">[root@mysql src]<span class="comment"># wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.26.tar.gz</span></span><br><span class="line">[root@mysql src]<span class="comment"># ll -lrth</span></span><br><span class="line">总用量 52M</span><br><span class="line">-rw-r--r-- 1 root root 52M 4月  13 2019 mysql-5.7.26.tar.gz</span><br></pre></td></tr></table></figure>

<h2 id="3、安装相关依赖包"><a href="#3、安装相关依赖包" class="headerlink" title="3、安装相关依赖包"></a>3、安装相关依赖包</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@mysql src]<span class="comment"># yum -y install cmake gcc gcc-c++ ncurses-devel bison zlib libxml openssl automake autoconf make libtool bison-devel libaio-devel</span></span><br></pre></td></tr></table></figure>

<h2 id="4、安装Boost"><a href="#4、安装Boost" class="headerlink" title="4、安装Boost"></a>4、安装Boost</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">// 下载boost包</span><br><span class="line">[root@mysql src]<span class="comment"># wget http://downloads.sourceforge.net/project/boost/boost/1.59.0/boost_1_59_0.tar.gz</span></span><br><span class="line">[root@mysql src]<span class="comment"># ll -lrth</span></span><br><span class="line">总用量 132M</span><br><span class="line">-rw-r--r-- 1 root root 80M 8月  13 2015 boost_1_59_0.tar.gz</span><br><span class="line">-rw-r--r-- 1 root root 52M 4月  13 2019 mysql-5.7.26.tar.gz</span><br><span class="line"></span><br><span class="line">// 安装boost</span><br><span class="line">[root@mysql src]<span class="comment"># tar -xf boost_1_59_0.tar.gz &amp;&amp; mv boost_1_59_0 /usr/local/boost-1.59.0</span></span><br><span class="line">[root@mysql src]<span class="comment"># ll -lrth /usr/local/boost-1.59.0/</span></span><br><span class="line">总用量 108K</span><br><span class="line">drwxr-xr-x  10 501 games  190 8月  11 2015 tools</span><br><span class="line">drwxr-xr-x   2 501 games  141 8月  11 2015 status</span><br><span class="line">-rw-r--r--   1 501 games 2.6K 8月  11 2015 rst.css</span><br><span class="line">drwxr-xr-x   4 501 games  159 8月  11 2015 more</span><br><span class="line">-rw-r--r--   1 501 games 1.4K 8月  11 2015 LICENSE_1_0.txt</span><br><span class="line">-rw-r--r--   1 501 games  11K 8月  11 2015 Jamroot</span><br><span class="line">-rw-r--r--   1 501 games  291 8月  11 2015 INSTALL</span><br><span class="line">-rw-r--r--   1 501 games 5.4K 8月  11 2015 index.html</span><br><span class="line">-rw-r--r--   1 501 games  769 8月  11 2015 index.htm</span><br><span class="line">-rwxr-xr-x   1 501 games  11K 8月  11 2015 bootstrap.sh</span><br><span class="line">-rw-r--r--   1 501 games 2.5K 8月  11 2015 bootstrap.bat</span><br><span class="line">-rw-r--r--   1 501 games 6.2K 8月  11 2015 boost.png</span><br><span class="line">-rw-r--r--   1 501 games  989 8月  11 2015 boost.css</span><br><span class="line">-rw-r--r--   1 501 games  22K 8月  11 2015 boostcpp.jam</span><br><span class="line">-rw-r--r--   1 501 games  850 8月  11 2015 boost-build.jam</span><br><span class="line">drwx------   7 501 games   84 8月  12 2015 doc</span><br><span class="line">drwx------ 116 501 games 4.0K 8月  12 2015 libs</span><br><span class="line">drwxr-xr-x 105 501 games 8.0K 8月  12 2015 boost</span><br></pre></td></tr></table></figure>

<h2 id="5、编译安装MySQL"><a href="#5、编译安装MySQL" class="headerlink" title="5、编译安装MySQL"></a>5、编译安装MySQL</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">// 解压MySQL</span><br><span class="line">[root@mysql src]<span class="comment"># tar -xf mysql-5.7.26.tar.gz -C ./ &amp;&amp; cd mysql-5.7.26/</span></span><br><span class="line"></span><br><span class="line">// 编译安装MySQL</span><br><span class="line">[root@mysql mysql-5.7.26]<span class="comment"># cmake -DCMAKE_INSTALL_PREFIX=/usr/local/mysql \</span></span><br><span class="line">-DMYSQL_DATADIR=/usr/<span class="built_in">local</span>/mysql/data -DWITH_BOOST=/usr/<span class="built_in">local</span>/boost-1.59.0 \</span><br><span class="line">-DSYSCONFDIR=/etc -DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci \</span><br><span class="line">-DMYSQL_TCP_PORT=3306 -DMYSQL_USER=mysql -DWITH_MYISAM_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_INNOBASE_STORAGE_ENGINE=1 -DWITH_ARCHIVE_STORAGE_ENGINE=1 -DWITH_BLACKHOLE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_MEMORY_STORAGE_ENGINE=1 -DENABLE_DOWNLOADS=1 -DDOWNLOAD_BOOST=1 \</span><br><span class="line">&amp;&amp; make -j `cat /proc/cpuinfo | grep processor| wc -l` &amp;&amp; make install &amp;&amp; <span class="built_in">cd</span></span><br><span class="line"></span><br><span class="line">// 参数含义</span><br><span class="line">-DCMAKE_INSTALL_PREFIX=/usr/<span class="built_in">local</span>/mysql          [MySQL安装的根目录]</span><br><span class="line">-DMYSQL_DATADIR=/mydata/mysql/data               [MySQL数据库文件存放目录]</span><br><span class="line">-DDEFAULT_CHARSET=utf8                           [设置默认字符集为utf8]</span><br><span class="line">-DDEFAULT_COLLATION=utf8_general_ci              [设置默认字符校对]</span><br><span class="line">-DMYSQL_TCP_PORT=3306                            [MySQL的监听端口]</span><br><span class="line">-DMYSQL_USER=mysql                               [MySQL用户名]    </span><br><span class="line">-DWITH_MYISAM_STORAGE_ENGINE=1                   [安装MySQL的myisam数据库引擎]</span><br><span class="line">-DWITH_INNOBASE_STORAGE_ENGINE=1                 [安装MySQL的innodb数据库引擎]</span><br><span class="line">-DWITH_ARCHIVE_STORAGE_ENGINE=1                  [安装MySQL的archive数据库引擎]</span><br><span class="line">-DWITH_BLACKHOLE_STORAGE_ENGINE=1 			     [安装MySQL的blackhole数据库引擎]</span><br><span class="line">-DWITH_MEMORY_STORAGE_ENGINE=1                   [安装MySQL的memory数据库引擎]</span><br><span class="line">-DENABLE_DOWNLOADS=1                             [编译时允许自主下载相关文件]</span><br><span class="line">-DDOWNLOAD_BOOST=1 							     [允许下载BOOST]</span><br><span class="line">-DWITH_BOOST=/usr/<span class="built_in">local</span>/boost 				     [指定系统中存在的BOOST]</span><br><span class="line">-DSYSCONFDIR=/etc                                [MySQL配置文件所在目录]</span><br><span class="line">-DWITH_READLINE=1                                [MySQL的readline library]</span><br><span class="line">-DMYSQL_UNIX_ADDR=/var/run/mysql/mysql.sock      [MySQL的通讯目录]</span><br><span class="line">-DENABLED_LOCAL_INFILE=1                         [启用加载本地数据]</span><br><span class="line">-DWITH_PARTITION_STORAGE_ENGINE=1  		         [启动mysql的分区存储结构]</span><br><span class="line">-DEXTRA_CHARSETS=all                             [使MySQL支持所有的扩展字符]</span><br><span class="line">-DWITH_DEBUG=0                                   [禁用调试模式]</span><br><span class="line">-DWITH_SSL:STRING=bundled                        [通讯时支持ssl协议]</span><br><span class="line">-DWITH_ZLIB:STRING=bundled                       [允许使用zlib library]</span><br></pre></td></tr></table></figure>

<h2 id="6、调整MySQL脚本程序"><a href="#6、调整MySQL脚本程序" class="headerlink" title="6、调整MySQL脚本程序"></a>6、调整MySQL脚本程序</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">// 拷贝MySQL的启动脚本</span><br><span class="line">[root@mysql ~]<span class="comment"># cp /usr/local/src/mysql-5.7.26/support-files/mysql.server /etc/init.d/</span></span><br><span class="line">[root@mysql ~]<span class="comment"># chmod +x /etc/init.d/mysql.server</span></span><br><span class="line"></span><br><span class="line">// 更改MySQL属主数组</span><br><span class="line">[root@mysql ~]<span class="comment"># chown -R mysql:mysql /usr/local/mysql</span></span><br><span class="line">[root@mysql ~]<span class="comment"># chown -R mysql:mysql /etc/my.cnf</span></span><br><span class="line"></span><br><span class="line">// 编写服务控制脚本</span><br><span class="line">[root@mysql ~]<span class="comment"># cat &lt;&lt;END &gt;&gt;/usr/lib/systemd/system/mysqld.service</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=mysqldapi</span><br><span class="line">After=network.target</span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">PIDFile=/usr/<span class="built_in">local</span>/mysql/logs/mysqld.pid</span><br><span class="line">ExecStart=/etc/init.d/mysql.server start</span><br><span class="line">ExecReload=/etc/init.d/mysql.server restart</span><br><span class="line">ExecStop=/etc/init.d/mysql.server stop</span><br><span class="line">PrivateTmp=Flase</span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">END</span><br><span class="line">[root@mysql ~]<span class="comment"># chmod a+x /usr/lib/systemd/system/mysqld.service</span></span><br><span class="line"></span><br><span class="line">// 注解：PrivateTmp=Flase   [此配置必须关闭，不然mysql连接文件mysql.sock文件会默认生成在以下位置/tmp/systemd-private-83bba738e8ff4837b5ae657eff983821-mysqld.service-BPxWpJ/tmp/mysql.sock，导致数据库无法连接，将此配置项关闭后，则文件正常生成在/tmp/mysql.sock。]</span><br><span class="line"></span><br><span class="line">// 添加MySQL环境变脸</span><br><span class="line">[root@mysql ~]<span class="comment"># echo &quot;export PATH=$PATH:/usr/local/mysql/bin/&quot; &gt;&gt; /etc/profile</span></span><br><span class="line">[root@mysql ~]<span class="comment"># source /etc/profile</span></span><br><span class="line"></span><br><span class="line">// 编写MySQL配置文件并创建相关目录</span><br><span class="line">[root@mysql ~]<span class="comment"># mkdir /usr/local/mysql/logs</span></span><br><span class="line">[root@mysql ~]<span class="comment"># chown mysql:mysql /usr/local/mysql/logs/</span></span><br><span class="line">[root@mysql ~]<span class="comment"># cat &lt;&lt;END &gt;/etc/my.cnf</span></span><br><span class="line">[mysqld]</span><br><span class="line">basedir = /usr/<span class="built_in">local</span>/mysql</span><br><span class="line">datadir = /usr/<span class="built_in">local</span>/mysql/data</span><br><span class="line">port = 3306</span><br><span class="line">sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES</span><br><span class="line">character_set_server=utf8</span><br><span class="line">init_connect=<span class="string">&#x27;SET NAMES utf8&#x27;</span></span><br><span class="line">log-error=/usr/<span class="built_in">local</span>/mysql/logs/mysqld.log</span><br><span class="line">pid-file=/usr/<span class="built_in">local</span>/mysql/logs/mysqld.pid</span><br><span class="line">skip-name-resolve</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">// 配置含义</span><br><span class="line">[mysqld]					               [声明区域]</span><br><span class="line">basedir = /usr/<span class="built_in">local</span>/mysql			             [mysql的安装位置]</span><br><span class="line">datadir = /usr/<span class="built_in">local</span>/mysql/data		                    [mysql的数据库存放位置]</span><br><span class="line">port = 3306						             [mysql服务监听的端口]</span><br><span class="line">sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES		[mysql的模式]</span><br><span class="line">character_set_server=utf8		                        [默认字符集]</span><br><span class="line">init_connect=<span class="string">&#x27;SET NAMES utf8&#x27;</span>			                [默认字符集]	</span><br><span class="line">log-error=/usr/<span class="built_in">local</span>/mysql/logs/mysqld.log	               [指定日志文件位置]</span><br><span class="line">pid-file=/usr/<span class="built_in">local</span>/mysql/logs/mysqld.pid	               [指定运行服务所产生的pid文件位置]</span><br><span class="line">skip-name-resolve					    [跳过mysql的域名反向解析]</span><br></pre></td></tr></table></figure>

<h2 id="7、初始化MySQL数据库并启动服务"><a href="#7、初始化MySQL数据库并启动服务" class="headerlink" title="7、初始化MySQL数据库并启动服务"></a>7、初始化MySQL数据库并启动服务</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// 初始化</span><br><span class="line">[root@mysql ~]<span class="comment"># mysqld --initialize-insecure --user=mysql --basedir=/usr/local/mysql \</span></span><br><span class="line">--datadir=/usr/<span class="built_in">local</span>/mysql/data &amp;&amp; <span class="built_in">echo</span> $?</span><br><span class="line"></span><br><span class="line">// 参数含义</span><br><span class="line">--initialize-insecure 		        [禁用mysql的密码策略（密码复杂性等）]</span><br><span class="line">--initialize-aize                   [是开启密码策略，自动生成密码在mysqld.log文件中]</span><br><span class="line">--user=mysql                 [运行的账户]</span><br><span class="line">--basedir=/usr/<span class="built_in">local</span>/mysql   [mysql的安装位置]</span><br><span class="line">--datadir=/usr/<span class="built_in">local</span>/mysql/data		[mysql数据库服务数据的物理存放路径]</span><br><span class="line"></span><br><span class="line">// 启动MySQL服务</span><br><span class="line">[root@mysql ~]<span class="comment"># systemctl start mysqld</span></span><br><span class="line">[root@mysql ~]<span class="comment"># systemctl enable mysqld</span></span><br><span class="line">[root@mysql ~]<span class="comment"># netstat -utpln |grep mysqld</span></span><br><span class="line">tcp6       0      0 :::3306                 :::*                    LISTEN      46166/mysqld</span><br></pre></td></tr></table></figure>

<h2 id="8、修改MySQL密码并连接访问数据库"><a href="#8、修改MySQL密码并连接访问数据库" class="headerlink" title="8、修改MySQL密码并连接访问数据库"></a>8、修改MySQL密码并连接访问数据库</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// 设置MySQL密码</span><br><span class="line">[root@mysql ~]<span class="comment"># mysqladmin -uroot -p password &quot;abc123..&quot;</span></span><br><span class="line"></span><br><span class="line">// 连接数据库</span><br><span class="line">[root@mysql ~]<span class="comment"># mysql -uroot -pabc123..</span></span><br><span class="line">mysql: [Warning] Using a password on the <span class="built_in">command</span> line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 9</span><br><span class="line">Server version: 5.7.26 Source distribution</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>
<p><em><strong>至此MySQL安装完毕</strong></em></p>
<h1 id="三、MySQL-配置文件详解"><a href="#三、MySQL-配置文件详解" class="headerlink" title="三、MySQL 配置文件详解"></a>三、MySQL 配置文件详解</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line"><span class="comment">#user = mysql</span></span><br><span class="line">mysql以什么用户运行</span><br><span class="line"></span><br><span class="line"><span class="comment">#port = 3306   </span></span><br><span class="line">mysql运行在哪个端口</span><br><span class="line"></span><br><span class="line"><span class="comment">#datadir = /usr/loca/mysql/data/</span></span><br><span class="line">mysql的数据目录</span><br><span class="line"></span><br><span class="line"><span class="comment">#socket=/tmp/mysql.sock</span></span><br><span class="line">mysql以socket方式运行的sock文件位置</span><br><span class="line"></span><br><span class="line"><span class="comment">#symbolic-links=0</span></span><br><span class="line">是否支持符号链接，即数据库或表可以存储在my.cnf中指定datadir之外的分区或目录，为0不开启。</span><br><span class="line"></span><br><span class="line"><span class="comment">########基本配置########</span></span><br><span class="line"><span class="comment">#server-id = 11</span></span><br><span class="line">mysql的服务器分配id，在启用主从和集群的时候必须指定，每个节点必须不同</span><br><span class="line"></span><br><span class="line"><span class="comment">#bind_address = 10.166.224.32</span></span><br><span class="line">mysql监听的ip地址，如果是127.0.0.1，表示仅本机访问</span><br><span class="line"></span><br><span class="line"><span class="comment">#autocommit = 1</span></span><br><span class="line">数据修改是否自动提交，为0不自动提交</span><br><span class="line"></span><br><span class="line"><span class="comment">#character_set_server=utf8mb4</span></span><br><span class="line">服务器使用的字符集</span><br><span class="line"></span><br><span class="line"><span class="comment">#skip_name_resolve = 1</span></span><br><span class="line">禁用DNS主机名查找，启用以后用内网地址向mysqlslap请求响应快了一半</span><br><span class="line"></span><br><span class="line"><span class="comment">#max_connections = 800</span></span><br><span class="line">mysql最大连接数</span><br><span class="line"></span><br><span class="line"><span class="comment">#max_connect_errors = 10</span></span><br><span class="line">某台host连接错误次数等于max_connect_errors（默认10） ，主机<span class="string">&#x27;host_name&#x27;</span>再次尝试时被屏蔽；可有效反的防止dos攻击。</span><br><span class="line"></span><br><span class="line"><span class="comment">#transaction_isolation = READ-COMMITTED</span></span><br><span class="line">数据库事务隔离级别</span><br><span class="line">1.READ-UNCOMMITTED(读取未提交内容)级别</span><br><span class="line">2.READ-COMMITTED（读取提交内容）</span><br><span class="line">3.REPEATABLE-READ(可重读)</span><br><span class="line">4.SERIERLIZED(可串行化)</span><br><span class="line">默认级别REPEATABLE-READ</span><br><span class="line"></span><br><span class="line"><span class="comment">#explicit_defaults_for_timestamp = 1</span></span><br><span class="line">mysql中TIMESTAMP类型和其他的类型有点不一样(在没有设置explicit_defaults_for_timestamp=1的情况下）。</span><br><span class="line"></span><br><span class="line"><span class="comment">#join_buffer_size = 128M</span></span><br><span class="line">当我们的join是ALL,index,rang或者Index_merge的时候使用的buffer。 实际上这种join被称为FULL JOIN。</span><br><span class="line"></span><br><span class="line"><span class="comment">#tmp_table_size = 128M</span></span><br><span class="line">规定了内部内存临时表的最大值，每个线程都要分配。（实际起限制作用的是tmp_table_size和max_heap_table_size的最小值。）如果内存临时表超出了限制，MySQL就会自动地把它转化为基于磁盘的MyISAM表，存储在指定的tmpdir目录下。</span><br><span class="line"></span><br><span class="line"><span class="comment">#tmpdir = /dev/shm/mysql-tmp/</span></span><br><span class="line">保存临时文件的目录</span><br><span class="line"></span><br><span class="line"><span class="comment">#max_allowed_packet = 16M</span></span><br><span class="line">mysql最大接受的数据包大小</span><br><span class="line"></span><br><span class="line"><span class="comment">#sql_mode = &quot;STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION,NO_ZERO_DATE,NO_ZERO_IN_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER&quot;</span></span><br><span class="line">sql_mode 模式，定义了你MySQL应该支持的sql语法，对数据的校验等等，限制一些所谓的‘不合法’的操作。</span><br><span class="line"></span><br><span class="line"><span class="comment">#interactive_timeout = 60</span></span><br><span class="line">服务器关闭交互式连接前等待活动的秒数。交互式客户端定义为在mysql_real_connect()中使用CLIENT_INTERACTIVE选项的客户端。</span><br><span class="line"></span><br><span class="line"><span class="comment">#wait_timeout = 60</span></span><br><span class="line">服务器关闭非交互连接之前等待活动的秒数，在线程启动时，根据全局wait_timeout值或全局interactive_timeout值初始化会话wait_timeout值，取决于客户端类型(由mysql_real_connect()的连接选项CLIENT_INTERACTIVE定义)。</span><br><span class="line"></span><br><span class="line"><span class="comment">#read_buffer_size = 16M</span></span><br><span class="line">读入缓冲区的大小，将对表进行顺序扫描的请求将分配一个读入缓冲区，MySQL会为它分配一段内存缓冲区。</span><br><span class="line"></span><br><span class="line"><span class="comment">#read_rnd_buffer_size = 32M</span></span><br><span class="line">随机读缓冲区大小，当按任意顺序读取行时（列如按照排序顺序）将分配一个随机读取缓冲区，进行排序查询时，MySQL会首先扫描一遍该缓冲，以避免磁盘搜索，提高查询速度</span><br><span class="line"></span><br><span class="line"><span class="comment">#sort_buffer_size = 32M</span></span><br><span class="line">是一个connection级参数，在每个connection第一次需要使用这个buffer的时候，一次性分配设置的内存。</span><br><span class="line"></span><br><span class="line"><span class="comment">########日志配置########</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#log_error = /data/local/mysql-5.7.19/log/mysql-error.log</span></span><br><span class="line">错误日志位置</span><br><span class="line"></span><br><span class="line">slow_query_log = 1</span><br><span class="line">是否开启慢查询日志收集</span><br><span class="line">slow_query_log_file = /data/<span class="built_in">local</span>/mysql-5.7.19/<span class="built_in">log</span>/mysql-slow.log</span><br><span class="line">慢查询日志位置</span><br><span class="line"></span><br><span class="line"><span class="comment">#log_queries_not_using_indexes = 1</span></span><br><span class="line">是否记录未使用索引的语句</span><br><span class="line"></span><br><span class="line"><span class="comment">#log_slow_admin_statements = 1</span></span><br><span class="line">慢查询也记录那些慢的optimize table，analyze table和alter table语句</span><br><span class="line"></span><br><span class="line"><span class="comment">#log_slow_slave_statements = 1</span></span><br><span class="line">记录由Slave所产生的慢查询</span><br><span class="line"></span><br><span class="line"><span class="comment">#log_throttle_queries_not_using_indexes = 10</span></span><br><span class="line">设定每分钟记录到日志的未使用索引的语句数目，超过这个数目后只记录语句数量和花费的总时间。</span><br><span class="line"></span><br><span class="line"><span class="comment">#expire_logs_days = 90</span></span><br><span class="line">日志自动过期清理天数</span><br><span class="line"></span><br><span class="line"><span class="comment">#long_query_time = 1</span></span><br><span class="line">设置记录慢查询超时时间</span><br><span class="line"></span><br><span class="line"><span class="comment">#min_examined_row_limit = 100</span></span><br><span class="line">查询检查返回少于该参数指定行的SQL不被记录到慢查询日志</span><br><span class="line"></span><br><span class="line"><span class="comment">########复制集配置########</span></span><br><span class="line"><span class="comment">#master_info_repository = TABLE</span></span><br><span class="line">从机保存主节点信息方式，设成file时 会生成master.info 和 relay-log.info2个文件，设成table，信息就会存在mysql.master_slave_info表中。不管是设置的哪种值，都不要移动或者编辑相关的文件和表。</span><br><span class="line"></span><br><span class="line"><span class="comment">#relay_log_info_repository = TABLE</span></span><br><span class="line">用于保存slave读取relay <span class="built_in">log</span>的位置信息，可选值为“FILE”、“TABLE”，以便crash重启后继续恢复。</span><br><span class="line"></span><br><span class="line"><span class="comment">#log_bin = /data/local/mysql-5.7.19/log/mysql-bin</span></span><br><span class="line">binlog的保存位置，不能指定确定的文件名如mysql-bin.log，只能指定位置和前缀，会生成以前缀为开头的一系列文件；默认生成在data目录下。</span><br><span class="line"></span><br><span class="line"><span class="comment">#sync_binlog = 4</span></span><br><span class="line">这个参数是对于MySQL系统来说是至关重要的，他不仅影响到Binlog对MySQL所带来的性能损耗，而且还影响到MySQL中数据的完整性。对于“sync_binlog”参数的各种设置的说明如下：</span><br><span class="line">sync_binlog=0，当事务提交之后，MySQL不做fsync之类的磁盘同步指令刷新binlog_cache中的信息到磁盘，而让Filesystem自行决定什么时候来做同步，或者cache满了之后才同步到磁盘；sync_binlog=n，当每进行n次事务提交之后，MySQL将进行一次fsync之类的磁盘同步指令来将binlog_cache中的数据强制写入磁盘；在MySQL中系统默认的设置是sync_binlog=0，也就是不做任何强制性的磁盘刷新指令，这时候的性能是最好的，但是风险也是最大的。因为一旦系统Crash，在binlog_cache中的所有binlog信息都会被丢失。而当设置为“1”的时候，是最安全但是性能损耗最大的设置。因为当设置为1的时候，即使系统Crash，也最多丢失binlog_cache中未完成的一个事务，对实际数据没有任何实质性影响。从以往经验和相关测试来看，对于高并发事务的系统来说，“sync_binlog”设置为0和设置为1的系统写入性能差距可能高达5倍甚至更多。</span><br><span class="line"></span><br><span class="line"><span class="comment">#gtid_mode = on</span></span><br><span class="line">启用gtid类型，否则就是普通的复制架构</span><br><span class="line"></span><br><span class="line"><span class="comment">#enforce_gtid_consistency = 1</span></span><br><span class="line">强制GTID的一致性</span><br><span class="line"></span><br><span class="line"><span class="comment">#log_slave_updates</span></span><br><span class="line">slave更新是否记入日志，在做双主架构时异常重要，影响到双主架构是否能互相同步</span><br><span class="line">binlog_format = row；binlog日志格式，可选值“MIXED”、“ROW”、“STATEMENT”，在5.6版本之前默认为“STATEMENT”，5.6之后默认为“MIXED”；因为“STATEMENT”方式在处理一些“不确定”性的方法时会造成数据不一致问题，我们建议使用“MIXED”或者“ROW”。</span><br><span class="line"></span><br><span class="line"><span class="comment">#relay_log = /data/local/mysql-5.7.19/log/mysql-relay.log</span></span><br><span class="line">从机保存同步中继日志的位置</span><br><span class="line"></span><br><span class="line"><span class="comment">#relay_log_recovery = 1</span></span><br><span class="line">当slave从库宕机后，假如relay-log损坏了，导致一部分中继日志没有处理，则自动放弃所有未执行的relay-log，并且重新从master上获取日志，这样就保证了relay-log的完整性。</span><br><span class="line"></span><br><span class="line"><span class="comment">#binlog_gtid_simple_recovery = 1</span></span><br><span class="line">这个参数控制了当mysql启动或重启时，mysql在搜寻GTIDs时是如何迭代使用binlog文件的。 这个选项设置为真，会提升mysql执行恢复的性能。因为这样mysql-server启动和binlog日志清理更快。</span><br><span class="line"></span><br><span class="line"><span class="comment">#slave_skip_errors = ddl_exist_errors</span></span><br><span class="line">跳过指定error no类型的错误，设成all 跳过所有错误</span><br><span class="line"></span><br><span class="line"><span class="comment">########innodb引擎配置########</span></span><br><span class="line"></span><br><span class="line">innodb_page_size = 16K</span><br><span class="line">innodb每个数据页大小，这个参数在一开始初始化时就要加入my.cnf里，如果已经创建了表，再修改，启动MySQL会报错。</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_buffer_pool_size = 4G</span></span><br><span class="line">缓存innodb表的索引，数据，插入数据时的缓冲，专用mysql服务器设置的大小： 操作系统内存的70%-80%最佳。</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_buffer_pool_instances = 8</span></span><br><span class="line">可以开启多个内存缓冲池，把需要缓冲的数据<span class="built_in">hash</span>到不同的缓冲池，这样可以并行的内存读写</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_buffer_pool_load_at_startup = 1</span></span><br><span class="line">默认为关闭OFF。如果开启该参数，启动MySQL服务时，MySQL将本地热数据加载到InnoDB缓冲池中。</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_buffer_pool_dump_at_shutdown = 1</span></span><br><span class="line">默认为关闭OFF。如果开启该参数，停止MySQL服务时，InnoDB将InnoDB缓冲池中的热数据保存到本地硬盘。</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_lru_scan_depth = 2000</span></span><br><span class="line">根据 官方文档 描述，它会影响page cleaner线程每次刷脏页的数量， 这是一个每1秒 loop一次的线程。</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_lock_wait_timeout = 5</span></span><br><span class="line">事务等待获取资源等待的最长时间，超过这个时间还未分配到资源则会返回应用失败；参数的时间单位是秒。</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_io_capacity = 4000</span></span><br><span class="line"><span class="comment">#innodb_io_capacity_max = 8000</span></span><br><span class="line">这两个设置会影响InnoDB每秒在后台执行多少操作. 大多数写IO(除了写InnoDB日志)是后台操作的. 如果你深度了解硬件性能(如每秒可以执行多少次IO操作),则使用这些功能是很可取的,而不是让它闲着。</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_flush_method = O_DIRECT</span></span><br><span class="line">默认值为 fdatasync. 如果使用 硬件RAID磁盘控制器, 可能需要设置为 O_DIRECT. 这在读取InnoDB缓冲池时可防止“双缓冲(double buffering)”效应,否则会在文件系统缓存与InnoDB缓存间形成2个副本(copy). 如果不使用硬件RAID控制器,或者使用SAN存储时, O_DIRECT 可能会导致性能下降。</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_log_group_home_dir = /data/local/mysql-5.7.19/log/redolog/</span></span><br><span class="line">innodb重做日志保存目录</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_undo_directory = /data/local/mysql-5.7.19/log/undolog/</span></span><br><span class="line">innodb回滚日志保存目录</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_undo_logs = 128</span></span><br><span class="line">undo回滚段的数量， 至少大于等于35，默认128</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_undo_tablespaces = 0</span></span><br><span class="line">用于设定创建的undo表空间的个数，在mysql_install_db时初始化后，就再也不能被改动了；默认值为0，表示不独立设置undo的tablespace，默认记录到ibdata中；否则，则在undo目录下创建这么多个undo文件，例如假定设置该值为4，那么就会创建命名为undo001~undo004的undo tablespace文件，每个文件的默认大小为10M。修改该值会导致Innodb无法完成初始化，数据库无法启动，但是另两个参数可以修改。</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_flush_neighbors = 1</span></span><br><span class="line">InnoDB存储引擎在刷新一个脏页时，会检测该页所在区(extent)的所有页，如果是脏页，那么一起刷新。这样做的好处是通过AIO可以将多个IO写操作合并为一个IO操作。对于传统机械硬盘建议使用，而对于固态硬盘可以关闭。</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_log_file_size = 4G</span></span><br><span class="line">这个值定义了日志文件的大小，innodb日志文件的作用是用来保存redo日志。一个事务对于数据或索引的修改往往对应到表空间中的随机的位置，因此当刷新这些修改到磁盘中就会引起随机的I/O，而随机的I/O往往比顺序的I/O更加昂贵的开销，因为随机的I/O需要更多的开销来定位到指定的位置。innodb使用日志来将随机的I/O转为顺序的I/O，只要日志文件是安全的，那么事务就是永久的，尽管这些改变还没有写到数据文件中，如果出现了当机或服务器断电的情况，那么innodb也可以通过日志文件来恢复以及提交的事务。但是日志文件是有一定的大小的，所以必须要把日志文件记录的改变写到数据文件中，innodb对于日志文件的操作是循环的，即当日志文件写满后，会将指针重新移动到文件开始的地方重新写，但是它不会覆盖那些还没有写到数据文件中的日志，因为这是唯一记录了事务持久化的记录；如果对 Innodb 数据表有大量的写入操作，那么选择合适的 innodb_log_file_size 值对提升MySQL性能很重要。然而设置太大了，就会增加恢复的时间，因此在MySQL崩溃或者突然断电等情况会令MySQL服务器花很长时间来恢复。</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_log_buffer_size = 16M</span></span><br><span class="line">事务在内存中的缓冲。 分配原 则：控制在2-8M.这个值不用太多的。他里面的内存一般一秒钟写到磁盘一次。</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_purge_threads = 4</span></span><br><span class="line">控制是否使用，使用几个独立purge线程（清除二进制日志）</span><br><span class="line"></span><br><span class="line">innodb_large_prefix = 1</span><br><span class="line">mysql在5.6之前一直都是单列索引限制767，起因是256×3-1。这个3是字符最大占用空间（utf8）。但是在5.6以后，开始支持4个字节的uutf8。255×4&gt;767, 于是增加了这个参数。这个参数默认值是OFF。当改为ON时，允许列索引最大达到3072；innodb_thread_concurrency = 64；InnoDB kernel并发最大的线程数。 1) 最少设置为(num_disks+num_cpus)*2。 2) 可以通过设置成1000来禁止这个限制。</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_print_all_deadlocks = 1</span></span><br><span class="line">是否将死锁相关信息保存到MySQL 错误日志中</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_strict_mode = 1</span></span><br><span class="line">开启InnoDB严格检查模式，尤其采用了页数据压缩功能后，最好是开启该功能。开启此功能后，当创建表（CREATE TABLE）、更改表（ALTER TABLE）和创建索引（CREATE INDEX）语句时，如果写法有错误，不会有警告信息，而是直接抛出错误，这样就可直接将问题扼杀在摇篮里。</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_sort_buffer_size = 64M</span></span><br><span class="line">ORDER BY 或者GROUP BY 操作的buffer缓存大小</span><br><span class="line"></span><br><span class="line"><span class="comment">########半同步复制配置########</span></span><br><span class="line"><span class="comment">#plugin_dir=/data/local/mysql-5.7.19/lib/plugin</span></span><br><span class="line">指定mysql的插件目录</span><br><span class="line"></span><br><span class="line"><span class="comment">#plugin_load = &quot;rpl_semi_sync_master=semisync_master.so;rpl_semi_sync_slave=semisync_slave.so&quot;</span></span><br><span class="line">指定载入哪些插件</span><br><span class="line"></span><br><span class="line"><span class="comment">#loose_rpl_semi_sync_master_enabled = 1</span></span><br><span class="line">控制主库上是否开启semisync</span><br><span class="line"></span><br><span class="line"><span class="comment">#loose_rpl_semi_sync_slave_enabled = 1</span></span><br><span class="line">控制备库是否开启semisync</span><br><span class="line"></span><br><span class="line"><span class="comment">#loose_rpl_semi_sync_master_timeout = 5000</span></span><br><span class="line">单位毫秒，防止半同步复制在没有收到确认的情况下，发送堵塞。master在超时之前没有收到确认，将恢复到异步复制，继续执行半同步没有进行的操作。</span><br><span class="line"></span><br><span class="line"><span class="comment">#[mysqld-5.7]</span></span><br><span class="line">服务端</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_buffer_pool_dump_pct = 40</span></span><br><span class="line">表示转储每个bp instance LRU上最热的page的百分比。通过设置该参数减少转储的page数</span><br><span class="line"></span><br><span class="line">innodb_page_cleaners = 4</span><br><span class="line">为了提升扩展性和刷脏效率，在5.7.4版本里引入了多个page cleaner线程。从而达到并行刷脏的效果；在该版本中，Page cleaner并未和buffer pool绑定，其模型为一个协调线程 + 多个工作线程，协调线程本身也是工作线程。因此如果innodb_page_cleaners设置为8，那么就是一个协调线程，加7个工作线程。</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_undo_log_truncate = 1</span></span><br><span class="line">是否开启在线回收（收缩）undo <span class="built_in">log</span>日志文件，支持动态设置</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_max_undo_log_size = 2G</span></span><br><span class="line">当超过这个阀值（默认是1G），会触发truncate回收（收缩）动作，truncate后空间缩小到10M</span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb_purge_rseg_truncate_frequency = 128</span></span><br><span class="line">控制回收（收缩）undo <span class="built_in">log</span>的频率。undo <span class="built_in">log</span>空间在它的回滚段没有得到释放之前不会收缩， 想要增加释放回滚区间的频率，就得降低设定值。</span><br><span class="line"></span><br><span class="line"><span class="comment">#binlog_gtid_simple_recovery=1</span></span><br><span class="line">这个参数控制了当mysql启动或重启时，mysql在搜寻GTIDs时是如何迭代使用binlog文件的。 这个选项设置为真，会提升mysql执行恢复的性能。因为这样mysql-server启动和binlog日志清理更快。该参数为真时，mysql-server只需打开最老的和最新的这2个binlog文件。</span><br><span class="line"></span><br><span class="line">log_timestamps=system</span><br><span class="line">在MySQL 5.7.2 新增了 log_timestamps 这个参数，该参数主要是控制 error <span class="built_in">log</span>、genera <span class="built_in">log</span>，等等记录日志的显示时间参数。 在 5.7.2 之后改参数为默认 UTC 这样会导致日志中记录的时间比中国这边的慢，导致查看日志不方便。修改为 SYSTEM 就能解决问题。</span><br><span class="line"></span><br><span class="line"><span class="comment">#transaction_write_set_extraction=MURMUR32</span></span><br><span class="line">这个神奇的参数5.7.6版本引入，用于定义一个记录事务的算法，这个算法使用<span class="built_in">hash</span>标识来记录事务。如果使用MGR，那么这个<span class="built_in">hash</span>值需要用于分布式冲突检测何处理，在64位的系统，官网建议设置该参数使用 XXHASH64 算法。如果线上并没有使用该功能，应该设为off。</span><br><span class="line"></span><br><span class="line"><span class="comment">#show_compatibility_56=on</span></span><br><span class="line">从mysql5.7.6开始information_schema.global_status已经开始被舍弃，为了兼容性，此时需要打开 show_compatibility_56。</span><br></pre></td></tr></table></figure>


<h1 id="四、SQL语句"><a href="#四、SQL语句" class="headerlink" title="四、SQL语句"></a>四、SQL语句</h1><blockquote>
<p>一般来讲SQL 语言主要分为三类:</p>
</blockquote>
<p><strong>DML 数据操控 :</strong> 用来对数据进行操作，用于（表中的内容），代表指令为：insert（插入）、delete（删除）、update（更新）。</p>
<p><strong>DCL 数据控制 :</strong> 主要是负责（用户）权限管理，代表指令为：grant（授权）、revoke（撤销授权）。</p>
<p><strong>DDL 数据定义 :</strong> 维护储存数据的结构，用于（数据库、数据表），代表指令为：create（创建）、drop（删除）、alter（修改）。</p>
<h2 id="1、SQL语句规范"><a href="#1、SQL语句规范" class="headerlink" title="1、SQL语句规范"></a>1、SQL语句规范</h2><h3 id="1-1-SQL语句规范第一条-建库"><a href="#1-1-SQL语句规范第一条-建库" class="headerlink" title="1.1 SQL语句规范第一条(建库)"></a>1.1 SQL语句规范第一条(建库)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE oldboy CHARSET utf8mb4</span><br></pre></td></tr></table></figure>

<ol>
<li>关键字大写(非必须), 字面量小写(必须)</li>
<li>库名字, 只能是小写, 不能有数字开头, 不能是预留关键字</li>
<li>库名字必须和业务名有关, 例如his_user</li>
<li>必须加字符集</li>
</ol>
<h3 id="1-2-SQL语句规范第二条-建表"><a href="#1-2-SQL语句规范第二条-建表" class="headerlink" title="1.2 SQL语句规范第二条(建表)"></a>1.2 SQL语句规范第二条(建表)</h3><ol>
<li>关键字大写(非必须), 字面量小写(必须)</li>
<li>表名必须小写, 不能有数字开头, 不能是预留关键字</li>
<li>表名字必须和业务名有关</li>
<li>必须加存储引擎和字符集</li>
<li>适合的数据类型</li>
<li>必须要有主键</li>
<li>尽量非空选项</li>
<li>字段唯一性</li>
<li>必须加注释</li>
<li>避免使用外键</li>
<li>建立合理的索引</li>
</ol>
<h3 id="1-3-SQL语句规范第三条-增删改"><a href="#1-3-SQL语句规范第三条-增删改" class="headerlink" title="1.3 SQL语句规范第三条(增删改)"></a>1.3 SQL语句规范第三条(增删改)</h3><ol>
<li>insert语句按批量插入数据</li>
<li>update必须加where条件</li>
<li>delete尽量替换为update</li>
<li>如果有清空全表需求, 不要用delete, 推荐使用 truncate</li>
</ol>
<h3 id="1-4-SQL语句规范第四条-查询"><a href="#1-4-SQL语句规范第四条-查询" class="headerlink" title="1.4 SQL语句规范第四条(查询)"></a>1.4 SQL语句规范第四条(查询)</h3><ol>
<li>select语句避免使用 select *  from  t1; &lt;==&gt;  select id,name from t1</li>
<li>select语句尽量加等值的where条件.例如 select * from t1 where id=20</li>
<li>select 语句对于范围查询, 例如 select * from t1 where id&gt;200; 尽量添加limit</li>
<li>select 的where 条件  不要使用 &lt;&gt; like “%name” not in not exist</li>
<li>不要出现3表以上的表连接, 避免子查询</li>
<li>where条件中不要出现函数操作</li>
</ol>
<h3 id="SQL语句规范第五条-数据类型"><a href="#SQL语句规范第五条-数据类型" class="headerlink" title="SQL语句规范第五条(数据类型)"></a>SQL语句规范第五条(数据类型)</h3><ol>
<li>合适长度</li>
<li>选择合适的数据类型</li>
<li>少于10位的数字int , 大于10位数 char, 例如手机号</li>
<li>在可变长度的存储时, 将来使用不同的数据类型, 对于索引树的高度是有影响的</li>
<li>char和varchar选择时, 字符长度一定不变的可以使用char, 可变的尽量使用varchar</li>
</ol>
<h2 id="2、MySQL数据类型和字段属性"><a href="#2、MySQL数据类型和字段属性" class="headerlink" title="2、MySQL数据类型和字段属性"></a>2、MySQL数据类型和字段属性</h2><blockquote>
<p>MySQL中的数据类型大的方面来分，可以分为：日期和时间、数值，以及字符串。下面就分开来进行总结。</p>
</blockquote>
<h3 id="2-1-数据类型"><a href="#2-1-数据类型" class="headerlink" title="2.1 数据类型"></a>2.1 数据类型</h3><h4 id="2-1-1-日期和时间数据类型"><a href="#2-1-1-日期和时间数据类型" class="headerlink" title="2.1.1 日期和时间数据类型"></a>2.1.1 日期和时间数据类型</h4><table>
<thead>
<tr>
<th>MySQL数据类型</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>date</td>
<td>3字节，日期，格式：2014-09-18</td>
</tr>
<tr>
<td>time</td>
<td>3字节，时间，格式：08:42:30</td>
</tr>
<tr>
<td>datetime</td>
<td>8字节，日期时间，格式：2014-09-18 08:42:30</td>
</tr>
<tr>
<td>timestamp</td>
<td>4字节，自动存储记录修改的时间</td>
</tr>
<tr>
<td>year</td>
<td>1字节，年份</td>
</tr>
</tbody></table>
<h4 id="2-1-2-数值数据类型"><a href="#2-1-2-数值数据类型" class="headerlink" title="2.1.2 数值数据类型"></a>2.1.2 数值数据类型</h4><p><strong>整型</strong></p>
<table>
<thead>
<tr>
<th>MySQL数据类型</th>
<th>含义（有符号）</th>
</tr>
</thead>
<tbody><tr>
<td>tinyint</td>
<td>1字节，范围（-128~127）</td>
</tr>
<tr>
<td>smallint</td>
<td>2字节，范围（-32768~32767）</td>
</tr>
<tr>
<td>mediumint</td>
<td>3字节，范围（-8388608~8388607）</td>
</tr>
<tr>
<td>int</td>
<td>4字节，范围（-2147483648~2147483647）</td>
</tr>
<tr>
<td>bigint</td>
<td>8字节，范围（+-9.22*10的18次方）</td>
</tr>
</tbody></table>
<p>上面定义的都是有符号的，当然了，也可以加上unsigned关键字，定义成无符号的类型，那么对应的取值范围就要翻翻了，比如：tinyint unsigned的取值范围为0~255。</p>
<p><strong>浮点型</strong></p>
<table>
<thead>
<tr>
<th>MySQL数据类型</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>float(m, d)</td>
<td>4字节，单精度浮点型，m总个数，d小数位</td>
</tr>
<tr>
<td>double(m, d)</td>
<td>8字节，双精度浮点型，m总个数，d小数位</td>
</tr>
<tr>
<td>decimal(m, d)</td>
<td>decimal是存储为字符串的浮点数</td>
</tr>
</tbody></table>
<p>在MySQL中建立了一个表，有一列为float(5, 3)；做了以下试验：</p>
<p>1.插入123.45678，最后查询得到的结果为99.999；<br>2.插入123.456，最后查询结果为99.999；<br>3.插入12.34567，最后查询结果为12.346；</p>
<p>所以，在使用浮点型的时候，还是要注意陷阱的，要以插入数据库中的实际结果为准。</p>
<p><strong>字符串数据类型</strong></p>
<table>
<thead>
<tr>
<th>MySQL数据类型</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>char(n)</td>
<td>固定长度，最多255个字符</td>
</tr>
<tr>
<td>varchar(n)</td>
<td>可变长度，最多65535个字符</td>
</tr>
<tr>
<td>tinytext</td>
<td>可变长度，最多255个字符</td>
</tr>
<tr>
<td>text</td>
<td>可变长度，最多65535个字符</td>
</tr>
<tr>
<td>mediumtext</td>
<td>可变长度，最多2的24次方-1个字符</td>
</tr>
<tr>
<td>longtext</td>
<td>可变长度，最多2的32次方-1个字符</td>
</tr>
</tbody></table>
<h4 id="2-1-3-最后总结"><a href="#2-1-3-最后总结" class="headerlink" title="2.1.3 最后总结"></a>2.1.3 最后总结</h4><ul>
<li><p>经常变化的字段用 varchar</p>
</li>
<li><p>知道固定长度的用 char</p>
</li>
<li><p>尽量用 varchar</p>
</li>
<li><p>超过 255 字符的只能用 varchar 或者 text</p>
</li>
<li><p>能用 varchar 的地方不用 text</p>
</li>
</ul>
<h3 id="2-2-数据类型属性"><a href="#2-2-数据类型属性" class="headerlink" title="2.2 数据类型属性"></a>2.2 数据类型属性</h3><h4 id="2-2-1-auto-increment"><a href="#2-2-1-auto-increment" class="headerlink" title="2.2.1 auto_increment"></a>2.2.1 auto_increment</h4><p>auto_increment能为新插入的行赋一个唯一的整数标识符。为列赋此属性将为每个新插入的行赋值为上一次插入的ID+1。</p>
<p>MySQL要求将auto_increment属性用于作为主键的列。此外，每个表只允许有一个auto_increment列。</p>
<p>例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id <span class="type">smallint</span> <span class="keyword">not</span> <span class="keyword">null</span> auto_increment <span class="keyword">primary</span> key</span><br></pre></td></tr></table></figure>
<h4 id="2-2-2-binary"><a href="#2-2-2-binary" class="headerlink" title="2.2.2 binary"></a>2.2.2 binary</h4><p>binary属性只用于char和varchar值。当为列指定了该属性时，将以区分大小写的方式排序。与之相反，忽略binary属性时，将使用不区分大小写的方式排序。</p>
<p>例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname <span class="type">char</span>(<span class="number">25</span>) <span class="type">binary</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure>
<h4 id="2-2-3-default"><a href="#2-2-3-default" class="headerlink" title="2.2.3 default"></a>2.2.3 default</h4><p>default属性确保在没有任何值可用的情况下，赋予某个常量值，这个值必须是常量，因为MySQL不允许插入函数或表达式值。此外，此属性无法用于BLOB或TEXT列。如果已经为此列指定了NULL属性，没有指定默认值时默认值将为NULL，否则默认值将依赖于字段的数据类型。</p>
<p>例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subscribed enum(<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">default</span> <span class="string">&#x27;0&#x27;</span></span><br></pre></td></tr></table></figure>
<h4 id="2-2-4-index"><a href="#2-2-4-index" class="headerlink" title="2.2.4 index"></a>2.2.4 index</h4><p>如果所有其他因素都相同，要加速数据库查询，使用索引通常是最重要的一个步骤。索引一个列会为该列创建一个有序的键数组，每个键指向其相应的表行。<br>以后针对输入条件可以搜索这个有序的键数组，与搜索整个未索引的表相比，这将在性能方面得到极大的提升。</p>
<p>例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> employees</span><br><span class="line">(</span><br><span class="line">id <span class="type">varchar</span>(<span class="number">9</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">firstname <span class="type">varchar</span>(<span class="number">15</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">lastname <span class="type">varchar</span>(<span class="number">25</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">email <span class="type">varchar</span>(<span class="number">45</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">phone <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">index lastname(lastname),</span><br><span class="line"><span class="keyword">primary</span> key(id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><strong>当然也可以利用MySQL的create index命令在创建表之后增加索引:</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> index lastname <span class="keyword">on</span> employees (lastname(<span class="number">7</span>));</span><br><span class="line"></span><br><span class="line">这一次只索引了名字的前<span class="number">7</span>个字符，因为可能不需要其它字母来区分不同的名字。因为使用较小的索引时性能更好，所以应当在实践中尽量使用小的索引。</span><br></pre></td></tr></table></figure>
<h4 id="2-2-5-not-null"><a href="#2-2-5-not-null" class="headerlink" title="2.2.5 not null"></a>2.2.5 not null</h4><p>如果将一个列定义为not null，将不允许向该列插入null值。建议在重要情况下始终使用not null属性，因为它提供了一个基本验证，确保已经向查询传递了所有必要的值。</p>
<p>例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> users (name <span class="type">char</span>(<span class="number">16</span>) <span class="keyword">not</span> <span class="keyword">null</span>);</span><br></pre></td></tr></table></figure>
<h4 id="2-2-6-null（默认就是）"><a href="#2-2-6-null（默认就是）" class="headerlink" title="2.2.6 null（默认就是）"></a>2.2.6 null（默认就是）</h4><p>为列指定null属性时, 该列可以保持为空, 而不论行中其它列是否已经被填充。记住, null精确的说法是“无”, 而不是空字符串或0</p>
<p>例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> users (name <span class="type">char</span>(<span class="number">16</span>) <span class="keyword">null</span>);</span><br></pre></td></tr></table></figure>
<h4 id="2-2-7-primary-key"><a href="#2-2-7-primary-key" class="headerlink" title="2.2.7 primary key"></a>2.2.7 primary key</h4><p>primary key属性用于确保指定行的唯一性。指定为主键的列中, 值不能重复, 也不能为空。为指定为主键的列赋予auto_increment属性是很常见的，因为此列不必与行数据有任何关系，而只是作为一个唯一标识符。</p>
<p><strong>主键又分为以下两种：</strong></p>
<p>(1) 单字段主键</p>
<p>如果输入到数据库中的每行都已经有不可修改的唯一标识符，一般会使用单字段主键。注意，此主键一旦设置就不能再修改。</p>
<p>(2) 多字段主键</p>
<p>如果记录中任何一个字段都不可能保证唯一性，就可以使用多字段主键。这时，多个字段联合起来确保唯一性。如果出现这种情况，指定一个auto_increment整数作为主键是更好的办法。</p>
<h4 id="2-2-8-unique"><a href="#2-2-8-unique" class="headerlink" title="2.2.8 unique"></a>2.2.8 unique</h4><p>被赋予unique属性的列将确保所有值都有不同的值, 只是null值可以重复。一般会指定一个列为unique, 以确保该列的所有值都不同。</p>
<p>例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">email <span class="type">varchar</span>(<span class="number">45</span>) <span class="keyword">unique</span></span><br></pre></td></tr></table></figure>
<h4 id="2-2-9-zerofill"><a href="#2-2-9-zerofill" class="headerlink" title="2.2.9 zerofill"></a>2.2.9 zerofill</h4><p>zerofill属性可用于任何数值类型，用0填充所有剩余字段空间。例如，无符号int的默认宽度是10；因此，当“零填充”的int值为4时，将表示它为0000000004。</p>
<p>例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">orderid <span class="type">int</span> unsigned zerofill <span class="keyword">not</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure>
<h3 id="2-3-有兴趣可以去了解下"><a href="#2-3-有兴趣可以去了解下" class="headerlink" title="2.3 有兴趣可以去了解下"></a>2.3 有兴趣可以去了解下</h3><h4 id="2-3-1-MySQL日期数据类型、时间类型使用总结"><a href="#2-3-1-MySQL日期数据类型、时间类型使用总结" class="headerlink" title="2.3.1 MySQL日期数据类型、时间类型使用总结"></a>2.3.1 <a target="_blank" rel="noopener" href="https://www.jb51.net/article/23966.htm">MySQL日期数据类型、时间类型使用总结</a></h4><h4 id="2-3-2-MySQL数据类型varchar详解"><a href="#2-3-2-MySQL数据类型varchar详解" class="headerlink" title="2.3.2 MySQL数据类型varchar详解"></a>2.3.2 <a target="_blank" rel="noopener" href="https://www.jb51.net/article/48170.htm">MySQL数据类型varchar详解</a></h4><h4 id="2-3-3-MySQL-数据类型-详解"><a href="#2-3-3-MySQL-数据类型-详解" class="headerlink" title="2.3.3 MySQL 数据类型 详解"></a>2.3.3 <a target="_blank" rel="noopener" href="https://www.jb51.net/article/20555.htm">MySQL 数据类型 详解</a></h4><h4 id="2-3-4-MySQL-数据类型-大全"><a href="#2-3-4-MySQL-数据类型-大全" class="headerlink" title="2.3.4 MySQL 数据类型 大全"></a>2.3.4 <a target="_blank" rel="noopener" href="https://www.jb51.net/article/17764.htm">MySQL 数据类型 大全</a></h4><h4 id="2-3-5-深入了解mysql的4种常用、重要的数据类型"><a href="#2-3-5-深入了解mysql的4种常用、重要的数据类型" class="headerlink" title="2.3.5 深入了解mysql的4种常用、重要的数据类型"></a>2.3.5 <a target="_blank" rel="noopener" href="https://www.jb51.net/article/49770.htm">深入了解mysql的4种常用、重要的数据类型</a></h4><h4 id="2-3-6-MySQL优化之表结构优化的5大建议（数据类型选择讲的很好）"><a href="#2-3-6-MySQL优化之表结构优化的5大建议（数据类型选择讲的很好）" class="headerlink" title="2.3.6 MySQL优化之表结构优化的5大建议（数据类型选择讲的很好）"></a>2.3.6 <a target="_blank" rel="noopener" href="https://www.jb51.net/article/48423.htm">MySQL优化之表结构优化的5大建议（数据类型选择讲的很好）</a></h4><h4 id="2-3-7-Mysql支持的数据类型-列类型总结"><a href="#2-3-7-Mysql支持的数据类型-列类型总结" class="headerlink" title="2.3.7 Mysql支持的数据类型(列类型总结)"></a>2.3.7 <a target="_blank" rel="noopener" href="https://www.jb51.net/article/99932.htm">Mysql支持的数据类型(列类型总结)</a></h4><h4 id="2-3-8-mysql-数据类型TIMESTAMP"><a href="#2-3-8-mysql-数据类型TIMESTAMP" class="headerlink" title="2.3.8 mysql 数据类型TIMESTAMP"></a>2.3.8 <a target="_blank" rel="noopener" href="https://www.jb51.net/article/52252.htm">mysql 数据类型TIMESTAMP</a></h4><h4 id="2-3-9-MariaDB-MySQL-创建、删除、选择及数据类型使用详解"><a href="#2-3-9-MariaDB-MySQL-创建、删除、选择及数据类型使用详解" class="headerlink" title="2.3.9 MariaDB(MySQL)创建、删除、选择及数据类型使用详解"></a>2.3.9 <a target="_blank" rel="noopener" href="https://www.jb51.net/article/92870.htm">MariaDB(MySQL)创建、删除、选择及数据类型使用详解</a></h4><h4 id="2-3-10-mysql数据类型和字段属性原理与用法详解"><a href="#2-3-10-mysql数据类型和字段属性原理与用法详解" class="headerlink" title="2.3.10 mysql数据类型和字段属性原理与用法详解"></a>2.3.10 <a target="_blank" rel="noopener" href="https://www.jb51.net/article/184751.htm">mysql数据类型和字段属性原理与用法详解</a></h4><h2 id="3、SQL语句基本使用"><a href="#3、SQL语句基本使用" class="headerlink" title="3、SQL语句基本使用"></a>3、SQL语句基本使用</h2><h3 id="3-1-基本的增删改查"><a href="#3-1-基本的增删改查" class="headerlink" title="3.1 基本的增删改查"></a>3.1 基本的增删改查</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br></pre></td><td class="code"><pre><span class="line">1、安装完mysql之后，mysql数据库默认密码为空，因次需要给数据库修改密码</span><br><span class="line">mysqladmin -u  root  -p  password <span class="string">&quot;abc123..&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2、连接并登录到mysql操作环境</span><br><span class="line">mysql -u 用户名 -p 密码</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3、退出mysql操作环境</span><br><span class="line">mysql&gt; <span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">4、查看有哪些数据库</span><br><span class="line">mysql&gt; show databases;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">5、查看数据库详情信息</span><br><span class="line">mysql&gt; show create database mysql;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">6、创建数据库</span><br><span class="line"><span class="comment"># 有两种格式</span></span><br><span class="line">- 指定字符集的创建格式 : create database 库名</span><br><span class="line">- 使用默认的字符集创建格式 : create database 库名 character <span class="built_in">set</span> 字符集;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以第一种格式创建数据库</span></span><br><span class="line">mysql&gt; create database lemon;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以第二种格式创建数据库</span></span><br><span class="line">mysql&gt; create database db1 character <span class="built_in">set</span> gbk;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">7、进入指定数据库</span><br><span class="line">mysql&gt; use mysql;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">8、删除数据库</span><br><span class="line">mysql&gt; drop database db1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">9、查看库下的所有数据表</span><br><span class="line">mysql&gt; use mysql;</span><br><span class="line">mysql&gt; show tables;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">10、查看某个表的详细信息</span><br><span class="line">mysql&gt; show create table proc\G</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">11、查看表结构, 可以缩写成desc</span><br><span class="line">mysql&gt; describe user;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">12、创建数据表</span><br><span class="line"><span class="comment"># 两种创建格式</span></span><br><span class="line">- 使用默认的字符集|引擎 : create table 表名 (字段名 数据类型 [数据属性], 字段名 数据类型 [数据属性], ......);</span><br><span class="line">- 指定表的字符集|引擎 : create table 表名 (字段名 数据类型 [数据属性], ......) engine=myisam charset=utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以第一种格式在lemon库下创建user表</span></span><br><span class="line">mysql&gt; create table user (name char(16) not null, passwd char(48) default <span class="string">&#x27;250&#x27;</span>, primary key (name));</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以第二种格式在lemon库下创建person表</span></span><br><span class="line">mysql&gt; create table lemon.person (id int(10), name varchar(10), primary key (id)) engine=myisam charset=utf8;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">13、向lemon库的user表插入数据，</span><br><span class="line"><span class="comment"># 三种插入方法格式</span></span><br><span class="line">- 全表插入格式 : insert into 表名 values (值1,值2,值3, ....);</span><br><span class="line">- 全表批量插入格式 : insert into 表名 values (值1,值2...),( 值1,值2...),( 值1,值2...);</span><br><span class="line">- 指定字段插入格式 : insert into 表名 (列名1，列名2) values (值1,值2);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 先查看下user表的字段结构</span></span><br><span class="line">mysql&gt; desc user;</span><br><span class="line">+--------+----------+------+-----+---------+-------+</span><br><span class="line">| Field  | Type     | Null | Key | Default | Extra |</span><br><span class="line">+--------+----------+------+-----+---------+-------+</span><br><span class="line">| name   | char(16) | NO   | PRI | NULL    |       |</span><br><span class="line">| passwd | char(48) | YES  |     | 250     |       |</span><br><span class="line">+--------+----------+------+-----+---------+-------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 全表插入格式</span></span><br><span class="line">mysql&gt; insert into user(name,passwd) values (<span class="string">&#x27;laoda&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 全表批量插入格式</span></span><br><span class="line">mysql&gt; insert into user values (<span class="string">&quot;laoer&quot;</span>,<span class="string">&quot;123123&quot;</span>),(<span class="string">&#x27;laosan&#x27;</span>,<span class="string">&#x27;456456&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定字段插入格式, password:密文</span></span><br><span class="line">mysql&gt; insert into user values (<span class="string">&#x27;laosan&#x27;</span>, password(<span class="string">&#x27;678678&#x27;</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">14、查询表中所有数据</span><br><span class="line">查询lemon库中user表的数据</span><br><span class="line">mysql&gt; select * from lemon.user;</span><br><span class="line">+--------+-------------------------------------------+</span><br><span class="line">| name   | passwd                                    |</span><br><span class="line">+--------+-------------------------------------------+</span><br><span class="line">| laoda  | 123456                                    |</span><br><span class="line">| laoer  | 123123                                    |</span><br><span class="line">| laosan  | *2E3A12CC92B01C3795F7ADA23369F77C978BDB27 |</span><br><span class="line">+--------+-------------------------------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.01 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">15、使用<span class="built_in">where</span>条件查询表数据</span><br><span class="line"><span class="comment"># </span></span><br><span class="line">mysql&gt; select passwd from user <span class="built_in">where</span> name=<span class="string">&#x27;laosan&#x27;</span>;</span><br><span class="line">+--------+</span><br><span class="line">| passwd |</span><br><span class="line">+--------+</span><br><span class="line">| 456456 |</span><br><span class="line">+--------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from user <span class="built_in">where</span> name=<span class="string">&#x27;laoer&#x27;</span>;</span><br><span class="line">+-------+--------+</span><br><span class="line">| name  | passwd |</span><br><span class="line">+-------+--------+</span><br><span class="line">| laoer | 123123 |</span><br><span class="line">+-------+--------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select passwd from lemon.user <span class="built_in">where</span> name=<span class="string">&#x27;laoda&#x27;</span>;</span><br><span class="line">+--------+</span><br><span class="line">| passwd |</span><br><span class="line">+--------+</span><br><span class="line">| 123456 |</span><br><span class="line">+--------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">16、修改数据表内容，并且是以密文形式的。</span><br><span class="line"><span class="comment"># 两种格式</span></span><br><span class="line">- 修改全表格式 : update 表名 <span class="built_in">set</span> 列名=值;</span><br><span class="line">- 添加条件修改格式 : update 表名 <span class="built_in">set</span> 列名=值 <span class="built_in">where</span> 列名=值;</span><br><span class="line">mysql&gt; update lemon.user <span class="built_in">set</span> passwd=password(<span class="string">&#x27;buzhidao&#x27;</span>) <span class="built_in">where</span> name=<span class="string">&#x27;laoer&#x27;</span>;</span><br><span class="line">mysql&gt; select * from user;</span><br><span class="line">+--------+-------------------------------------------+</span><br><span class="line">| name   | passwd                                    |</span><br><span class="line">+--------+-------------------------------------------+</span><br><span class="line">| laoda  | 123456                                    |</span><br><span class="line">| laoer  | *919C8839C55DEA3ED65C7E0972E8446731F3DE3A |</span><br><span class="line">| laosan | *2E3A12CC92B01C3795F7ADA23369F77C978BDB27 |</span><br><span class="line">+--------+-------------------------------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">17、输出数据表内容</span><br><span class="line"><span class="comment"># 两种格式</span></span><br><span class="line">- 删除全表数据格式 : delete from 表名;</span><br><span class="line">- 删除指定条件的数据格式 : delete from 表名 <span class="built_in">where</span> 列名=值;</span><br><span class="line">mysql&gt; delete from lemon.user <span class="built_in">where</span> name=<span class="string">&#x27;laosan&#x27;</span>;</span><br><span class="line">mysql&gt; select * from user;</span><br><span class="line">+-------+-------------------------------------------+</span><br><span class="line">| name  | passwd                                    |</span><br><span class="line">+-------+-------------------------------------------+</span><br><span class="line">| laoda | 123456                                    |</span><br><span class="line">| laoer | *919C8839C55DEA3ED65C7E0972E8446731F3DE3A |</span><br><span class="line">+-------+-------------------------------------------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">18、修改数据表字段类型</span><br><span class="line"><span class="comment"># 格式 : alter table 表名 modify 字段名称 新字段类型 first;       // first可以不加</span></span><br><span class="line">mysql&gt; alter table user modify name char(30);</span><br><span class="line">mysql&gt; desc user;</span><br><span class="line">+--------+----------+------+-----+---------+-------+</span><br><span class="line">| Field  | Type     | Null | Key | Default | Extra |</span><br><span class="line">+--------+----------+------+-----+---------+-------+</span><br><span class="line">| name   | char(30) | NO   | PRI | NULL    |       |</span><br><span class="line">| passwd | char(48) | YES  |     | 250     |       |</span><br><span class="line">+--------+----------+------+-----+---------+-------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">19、增加数据表字段</span><br><span class="line"><span class="comment"># 格式 : alter table 表名 add 列名;</span></span><br><span class="line">mysql&gt; alter table user add age int(30);</span><br><span class="line">mysql&gt; desc user;</span><br><span class="line">+--------+----------+------+-----+---------+-------+</span><br><span class="line">| Field  | Type     | Null | Key | Default | Extra |</span><br><span class="line">+--------+----------+------+-----+---------+-------+</span><br><span class="line">| name   | char(30) | NO   | PRI | NULL    |       |</span><br><span class="line">| passwd | char(48) | YES  |     | 250     |       |</span><br><span class="line">| age    | int(30)  | YES  |     | NULL    |       |</span><br><span class="line">+--------+----------+------+-----+---------+-------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">20、删除数据表的字段</span><br><span class="line"><span class="comment"># 格式 : alter table 表名 drop 列名;</span></span><br><span class="line">mysql&gt; alter table user drop age;</span><br><span class="line">mysql&gt; desc user;</span><br><span class="line">+--------+----------+------+-----+---------+-------+</span><br><span class="line">| Field  | Type     | Null | Key | Default | Extra |</span><br><span class="line">+--------+----------+------+-----+---------+-------+</span><br><span class="line">| name   | char(30) | NO   | PRI | NULL    |       |</span><br><span class="line">| passwd | char(48) | YES  |     | 250     |       |</span><br><span class="line">+--------+----------+------+-----+---------+-------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">21、修改数据表字段名及类型属性</span><br><span class="line"><span class="comment"># 格式 : alter table 表名 change 旧字段名 新字段名;</span></span><br><span class="line">mysql&gt; alter table user change passwd password char(50);</span><br><span class="line">mysql&gt; desc user;</span><br><span class="line">+----------+----------+------+-----+---------+-------+</span><br><span class="line">| Field    | Type     | Null | Key | Default | Extra |</span><br><span class="line">+----------+----------+------+-----+---------+-------+</span><br><span class="line">| name     | char(30) | NO   | PRI | NULL    |       |</span><br><span class="line">| password | char(50) | YES  |     | NULL    |       |</span><br><span class="line">+----------+----------+------+-----+---------+-------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.01 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">22、查看数据表的前1行【升序】</span><br><span class="line">mysql&gt; select * from user <span class="built_in">limit</span> 1;</span><br><span class="line">+-------+----------+</span><br><span class="line">| name  | password |</span><br><span class="line">+-------+----------+</span><br><span class="line">| laoda | 123456   |</span><br><span class="line">+-------+----------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">23、查看数据表的最后1行【降序】</span><br><span class="line"><span class="comment"># 【desc 是降序】：从大到小；例如：3 2 1   【asc 默认就是升序】：从小到大；例如：1 2 3</span></span><br><span class="line">mysql&gt; select * from user order by name desc;</span><br><span class="line">+-------+-------------------------------------------+</span><br><span class="line">| name  | password                                  |</span><br><span class="line">+-------+-------------------------------------------+</span><br><span class="line">| laoer | *919C8839C55DEA3ED65C7E0972E8446731F3DE3A |</span><br><span class="line">| laoda | 123456                                    |</span><br><span class="line">+-------+-------------------------------------------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 案例：查看lemon库user表的id列里数字最大的2行</span></span><br><span class="line">mysql&gt; select * from users order by id desc <span class="built_in">limit</span> 2;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">24、复制当前表数据到另外一个表【类似于备份】</span><br><span class="line">mysql&gt; create table hehe as select * from user;</span><br><span class="line">mysql&gt; select * from hehe;</span><br><span class="line">+-------+-------------------------------------------+</span><br><span class="line">| name  | password                                  |</span><br><span class="line">+-------+-------------------------------------------+</span><br><span class="line">| laoda | 123456                                    |</span><br><span class="line">| laoer | *919C8839C55DEA3ED65C7E0972E8446731F3DE3A |</span><br><span class="line">+-------+-------------------------------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">25、【内链接】通过hehe表和users表中的name列,将两个表中的所有数据合并，前提是这两个数据表列中的数据必须是一样的！</span><br><span class="line">mysql&gt; select * from hehe inner join user on hehe.name=user.name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">26、【内链接】通过hehe表的name列和users表的password列,只将hehe表的name列和users表的password列数据合并，前提是&#123;和前者一样&#125;！</span><br><span class="line">mysql&gt; select hehe.name,user.password from hehe,user <span class="built_in">where</span> user.name=hehe.name;</span><br><span class="line">+-------+-------------------------------------------+</span><br><span class="line">| name  | password                                  |</span><br><span class="line">+-------+-------------------------------------------+</span><br><span class="line">| laoda | 123456                                    |</span><br><span class="line">| laoer | *919C8839C55DEA3ED65C7E0972E8446731F3DE3A |</span><br><span class="line">+-------+-------------------------------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">27、修改表的名字</span><br><span class="line"><span class="comment"># 格式：rename 原表名 to 新表名;</span></span><br><span class="line">mysql&gt; rename person to beros;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">28、修改字段位置</span><br><span class="line">mysql&gt; alter table user modify name varchar(10) after password;</span><br><span class="line">mysql&gt; desc user;</span><br><span class="line">+----------+-------------+------+-----+---------+-------+</span><br><span class="line">| Field    | Type        | Null | Key | Default | Extra |</span><br><span class="line">+----------+-------------+------+-----+---------+-------+</span><br><span class="line">| password | char(50)    | YES  |     | NULL    |       |</span><br><span class="line">| name     | varchar(10) | NO   | PRI | NULL    |       |</span><br><span class="line">+----------+-------------+------+-----+---------+-------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">29、删除数据表</span><br><span class="line">mysql&gt; drop table lemon.hehe;</span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+-----------------+</span><br><span class="line">| Tables_in_lemon |</span><br><span class="line">+-----------------+</span><br><span class="line">| person          |</span><br><span class="line">| user            |</span><br><span class="line">+-----------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>
<h3 id="3-2-授权用户、撤销授权用户、及限制"><a href="#3-2-授权用户、撤销授权用户、及限制" class="headerlink" title="3.2 授权用户、撤销授权用户、及限制"></a>3.2 授权用户、撤销授权用户、及限制</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">1、对lemon数据库授权，以便其他用户对该库进行操作</span><br><span class="line">mysql&gt; grant all on lemon.* to <span class="string">&#x27;admin&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified by <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line">	   上边的%是指:         <span class="comment">#任何主机都可以登录mysql；</span></span><br><span class="line">	                       <span class="comment">#localhost代表的服务器本身，不包含在上边的网段</span></span><br><span class="line">                              <span class="comment">#还可以是网段或者某个ip</span></span><br><span class="line">	     lemon.*:          <span class="comment">#只让admin用户拥有lemon库的所有权限	</span></span><br><span class="line">	       all:            <span class="comment">#代表的增、删、改、查所有权限</span></span><br><span class="line">	    123456:            <span class="comment">#是admin用户的登录密码</span></span><br><span class="line"></span><br><span class="line">mysql&gt; flush privileges;      <span class="comment">#刷新权限</span></span><br><span class="line"></span><br><span class="line">2、对admin用户取消对lemon库的授权</span><br><span class="line">mysql&gt; revoke all on lemon.* from <span class="string">&#x27;admin&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">mysql&gt; delete from mysql.user <span class="built_in">where</span> user=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">mysql&gt; flush privileges;</span><br><span class="line"></span><br><span class="line">3、查看mysql的用户权限</span><br><span class="line">mysql&gt; select user,host from mysql.user;</span><br><span class="line">mysql&gt; select * from mysql.user \G</span><br></pre></td></tr></table></figure>
<h3 id="3-3-破MySQL密码流程"><a href="#3-3-破MySQL密码流程" class="headerlink" title="3.3 破MySQL密码流程"></a>3.3 破MySQL密码流程</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">1、进入/etc/my.cnf配置文件里添加一条配置</span><br><span class="line">	vi  /etc/my.cnf</span><br><span class="line">	skip-grant-tables       <span class="comment">#跳过所有授权</span></span><br><span class="line">重启MySQL服务</span><br><span class="line"></span><br><span class="line">2、现在直接进入MysQl里</span><br><span class="line">    mysql  -u  root  -p</span><br><span class="line">	</span><br><span class="line">3、修改秘密【数据表】，并且刷新权限、退出用666666登陆即可</span><br><span class="line">    mysql&gt; update mysql.user <span class="built_in">set</span> password=password(<span class="string">&#x27;666666&#x27;</span>) <span class="built_in">where</span> user=<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">	mysql&gt; flush privileges;</span><br><span class="line">	mysql&gt; <span class="built_in">exit</span></span><br><span class="line">	</span><br><span class="line">4、检查没问题后在进入/etc/my.cnf配置文件里把刚加的skip-grant-tables这条配置删掉，保存退出并重启mysql服务</span><br><span class="line"><span class="comment"># 注：仅限5.7之前的版本</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MySQL-5.7版本的修改方式</span></span><br><span class="line">mysql&gt; update mysql.user <span class="built_in">set</span> authentication_string=password(<span class="string">&#x27;666666&#x27;</span>) <span class="built_in">where</span> user=<span class="string">&#x27;root&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="3-4-解决MySQL乱码问题"><a href="#3-4-解决MySQL乱码问题" class="headerlink" title="3.4 解决MySQL乱码问题"></a>3.4 解决MySQL乱码问题</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 有两种方法</span><br><span class="line"><span class="comment"># 第一种是永久生效的</span></span><br><span class="line">[root@mysql ~]<span class="comment"># vi /etc/my.cnf</span></span><br><span class="line">[client]</span><br><span class="line">default-character-set=utf8</span><br><span class="line">:wq!</span><br><span class="line">[root@mysql ~]<span class="comment"># systemctl restart mysqld</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二种是临时生效的</span></span><br><span class="line">进入数据库</span><br><span class="line">mysql&gt; <span class="built_in">set</span> names utf8;</span><br></pre></td></tr></table></figure>
<h3 id="3-5-查看MySQL连接情况"><a href="#3-5-查看MySQL连接情况" class="headerlink" title="3.5 查看MySQL连接情况"></a>3.5 查看MySQL连接情况</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Mysql存储引擎的应用mysql&gt; show status like <span class="string">&#x27;Thread_%&#x27;</span>;</span><br><span class="line">+-------------------+-------+</span><br><span class="line">| Variable_name     | Value |</span><br><span class="line">+-------------------+-------+</span><br><span class="line">| Threads_cached    | 5     |</span><br><span class="line">| Threads_connected | 3     |</span><br><span class="line">| Threads_created   | 8     |</span><br><span class="line">| Threads_running   | 1     |</span><br><span class="line">+-------------------+-------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>
<h3 id="3-6-Mysql存储引擎的应用"><a href="#3-6-Mysql存储引擎的应用" class="headerlink" title="3.6 Mysql存储引擎的应用"></a>3.6 Mysql存储引擎的应用</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.查看数据库可以配置的存储引擎类型</span><br><span class="line">mysql&gt; show engines;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlbn4z6aj31by0c2di2.jpg"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">2、修改Mysql服务的默认存储引擎</span><br><span class="line">[root@mysql ~]<span class="comment"># vi /etc/my.cnf</span></span><br><span class="line">[mysqld]</span><br><span class="line">default-storage-engine=MyISAM</span><br><span class="line">:wq!</span><br><span class="line"></span><br><span class="line">[root@mysql ~]<span class="comment"># systemctl restart mysqld</span></span><br><span class="line">[root@mysql ~]<span class="comment"># mysql -uroot -p123123</span></span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtld1pfbij30ur0efabd.jpg"></p>
<h2 id="4、SQL语句进阶使用"><a href="#4、SQL语句进阶使用" class="headerlink" title="4、SQL语句进阶使用"></a>4、SQL语句进阶使用</h2><h3 id="4-1-主键及自增"><a href="#4-1-主键及自增" class="headerlink" title="4.1 主键及自增"></a>4.1 主键及自增</h3><blockquote>
<p>每一张表通常会有一个且只有一个主键 来表示每条数据的唯一性；主键其实是对某一个字段的 约束 。</p>
</blockquote>
<ul>
<li>primary key</li>
<li>auto_increment</li>
</ul>
<p><strong>主键特性：</strong></p>
<ul>
<li>值不能重复 </li>
<li>非空（不能赋值为not null）</li>
</ul>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">非空<span class="operator">-</span> 主键约束写法：</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student (id <span class="type">int</span> <span class="keyword">primary</span> key,age <span class="type">int</span>); </span><br><span class="line"></span><br><span class="line"><span class="operator">-</span> 主键约束<span class="operator">+</span>自增的写法：特点  从<span class="number">1</span>开始走；不会自动回收，用过了就是用过了</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student (id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,age <span class="type">int</span>); </span><br></pre></td></tr></table></figure>

<h3 id="4-2-非空（not-null）"><a href="#4-2-非空（not-null）" class="headerlink" title="4.2 非空（not null）"></a>4.2 非空（not null）</h3><blockquote>
<p>非空约束 not null，说白了就是不允许某个字段的值是空的</p>
</blockquote>
<ul>
<li>not null</li>
</ul>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student (id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment, age <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>);</span><br></pre></td></tr></table></figure>
<h3 id="4-3-表字段的注释"><a href="#4-3-表字段的注释" class="headerlink" title="4.3 表字段的注释"></a>4.3 表字段的注释</h3><blockquote>
<p>关键字：comment</p>
</blockquote>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> tom(id <span class="type">int</span> comment <span class="string">&#x27;用户ID&#x27;</span>, age <span class="type">int</span> comment <span class="string">&#x27;用户年龄&#x27;</span>);</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> tom;</span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtldgpr9aj30q60enab2.jpg"></p>
<h3 id="4-4-Mysql数据库事务管理"><a href="#4-4-Mysql数据库事务管理" class="headerlink" title="4.4 Mysql数据库事务管理"></a>4.4 Mysql数据库事务管理</h3><blockquote>
<p>管理事务的三个命令：</p>
</blockquote>
<p><strong>begin：</strong>开始事务，后边有多条数据库操作语句开始执行。<br><strong>commit：</strong>开始提交一个事务，对应前边的begin操作，将事务处理的结果保存到数据文件中。<br><strong>rollback：</strong>开始回滚一个事务，在begin和commit之间，将事务中的全部语句撤回，</p>
<p><code>set autocommit = 0/1;     # 0禁用自动提交   1开启自动提交，自动提交为退出mysql连接程序时，或者执行下一条DML语句。</code></p>
<p><strong>管理事务：</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like <span class="string">&#x27;%autocommit%&#x27;</span>;       <span class="comment"># 查看当前数据库是否自动提交事务</span></span><br><span class="line">+---------------+-------+</span><br><span class="line">| Variable_name | Value |</span><br><span class="line">+---------------+-------+</span><br><span class="line">| autocommit    | ON    |        <span class="comment"># 默认就是开启的</span></span><br><span class="line">+---------------+-------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line">mysql&gt; create database lemon;</span><br><span class="line">mysql&gt; use lemon;</span><br><span class="line">mysql&gt; create table it(岗位 char(16),姓名 char(16),身份证号 char(48),学历 char(16),工资 int);</span><br><span class="line">mysql&gt; show table status <span class="built_in">where</span> name=<span class="string">&quot;it&quot;</span>;    <span class="comment"># 确保表引擎为InnoDB，如若不是按以下命令修改</span></span><br><span class="line">mysql&gt; alter table it engine=InnoDB;         <span class="comment"># 修改表储存引擎为InnoDB</span></span><br><span class="line">mysql&gt; insert into it values (<span class="string">&#x27;网络工程师&#x27;</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;150404199201091132&#x27;</span>,<span class="string">&#x27;高中&#x27;</span>,<span class="string">&#x27;5500&#x27;</span>);</span><br><span class="line">mysql&gt; insert into it values (<span class="string">&#x27;网络工程师&#x27;</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;150406187805271432&#x27;</span>,<span class="string">&#x27;专科&#x27;</span>,<span class="string">&#x27;12000&#x27;</span>);</span><br><span class="line">mysql&gt; insert into it values (<span class="string">&#x27;java工程师&#x27;</span>,<span class="string">&#x27;王五&#x27;</span>,<span class="string">&#x27;111376199609101456&#x27;</span>,<span class="string">&#x27;初中&#x27;</span>,<span class="string">&#x27;10000&#x27;</span>);</span><br><span class="line">mysql&gt; insert into it values (<span class="string">&#x27;网络工程师&#x27;</span>,<span class="string">&#x27;刘备&#x27;</span>,<span class="string">&#x27;345646199209103256&#x27;</span>,<span class="string">&#x27;高中&#x27;</span>,<span class="string">&#x27;15000&#x27;</span>);</span><br><span class="line">mysql&gt; insert into it values (<span class="string">&#x27;ui工程师&#x27;</span>,<span class="string">&#x27;关羽&#x27;</span>,<span class="string">&#x27;178645199909101189&#x27;</span>,<span class="string">&#x27;本科&#x27;</span>,<span class="string">&#x27;7000&#x27;</span>);</span><br><span class="line">mysql&gt; select * from it;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlermaqrj30og09b0to.jpg"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; begin;    <span class="comment">#手动开始事务</span></span><br><span class="line">mysql&gt; insert into it values (<span class="string">&#x27;php工程师&#x27;</span>,<span class="string">&#x27;曹操&#x27;</span>,<span class="string">&#x27;891878195409081198&#x27;</span>,<span class="string">&#x27;本科&#x27;</span>,<span class="string">&#x27;9000&#x27;</span>);</span><br><span class="line">mysql&gt; select * from it;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlf7qv26j30ol0a0wfl.jpg"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="built_in">exit</span>                             <span class="comment">#不手动提交事务退出</span></span><br><span class="line">[root@mysql ~]<span class="comment"># mysql -uroot -p123123</span></span><br><span class="line">mysql&gt; select * from lemon.it;          <span class="comment">#查看曹操是否还存在</span></span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlfo7omfj30on098dgs.jpg"></p>
<p><strong>如果是手动开始的事务就必须手动提交，因为系统是不会帮手动开始的事务自动提交的</strong>！</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; begin;                <span class="comment">#手动开始事务</span></span><br><span class="line">mysql&gt; insert into it values(<span class="string">&#x27;nginx工程师&#x27;</span>,<span class="string">&#x27;诸葛亮&#x27;</span>,<span class="string">&#x27;187967198712081198&#x27;</span>,<span class="string">&#x27;专科&#x27;</span>,<span class="string">&#x27;6700&#x27;</span>);</span><br><span class="line">mysql&gt; commit;               <span class="comment">#手动提交事务</span></span><br><span class="line">mysql&gt; select * from it;     <span class="comment">#查询</span></span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlg5he4nj30pp09w74f.jpg"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="built_in">exit</span></span><br><span class="line">[root@localhost ~]<span class="comment"># mysql -uroot -p123123</span></span><br><span class="line">mysql&gt; select * from lemon.it;               <span class="comment">#在查询诸葛亮还存不存在</span></span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlh1c0eqj30po09uwem.jpg"></p>
<p><strong>可以看到，手动执行的事务只有你主动提交后才会永久的修改！</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; begin;                        <span class="comment">#手动开始事务</span></span><br><span class="line">mysql&gt; insert into it values(<span class="string">&#x27;php工程师&#x27;</span>,<span class="string">&#x27;赵云&#x27;</span>,<span class="string">&#x27;987867199012081198&#x27;</span>,<span class="string">&#x27;专科&#x27;</span>,<span class="string">&#x27;9500&#x27;</span>);</span><br><span class="line">mysql&gt; select * from lemon.it;       <span class="comment">#查询</span></span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlhhj27xj30ps0aodg0.jpg"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; rollback;                   <span class="comment">#回滚事务</span></span><br><span class="line">mysql&gt; select * from lemon.it;     <span class="comment">#在查询赵云是否还存在</span></span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlhuhe8cj30po0a00sv.jpg"></p>
<p><strong>事务是数据库中的执行单元</strong><br><strong>事务能够保证事务内部的sql语句要么都成功，要么都失败</strong><br><strong>mysql 客户端（终端、命令行）事务是默认提交的</strong></p>
<h3 id="4-5-别名"><a href="#4-5-别名" class="headerlink" title="4.5 别名"></a>4.5 别名</h3><p>格式1：select 列名 别名,列名 别名…… from 表名;</p>
<p>格式2：select 列名 as ‘别名’, 列名 as ‘别名’,…… from 表名</p>
<p>示例：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from lemon.it;</span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlibl446j30pj0a30sv.jpg"></p>
<p>别名格式1</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select 岗位 gangwei,姓名 xingming from lemon.it;</span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlinca48j30kb0a4gm2.jpg"></p>
<p>别名格式2</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select 姓名 as <span class="string">&#x27;name&#x27;</span>,学历 as <span class="string">&#x27;xueli&#x27;</span> from lemon.it;</span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtlizwvhwj30lq0a2t8o.jpg"></p>
<h3 id="4-6-去重-distinct"><a href="#4-6-去重-distinct" class="headerlink" title="4.6 去重(distinct)"></a>4.6 去重(distinct)</h3><blockquote>
<p>格式：select distinct 列名 from 表名;</p>
</blockquote>
<p>示例：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select 岗位 from lemon.it;     <span class="comment">#查询it表中所有员工的职位</span></span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtljekgx9j30oc0a0aaa.jpg"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select distinct 岗位 from lemon.it;      <span class="comment">#去重</span></span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gjtljoxryzj30sk08qa9y.jpg"></p>
<h3 id="4-7-WHERE-条件判断（重点）"><a href="#4-7-WHERE-条件判断（重点）" class="headerlink" title="4.7 WHERE 条件判断（重点）"></a>4.7 WHERE 条件判断（重点）</h3><blockquote>
<p>有时候操作数据库时，只操作一些有条件限制的数据，这时可以在SQL语句中添加WHERE子句来规定数据操作的条件。</p>
</blockquote>
<p>常用的运算符：</p>
<table>
<thead>
<tr>
<th align="left">运算符</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">=</td>
<td align="left">等于</td>
</tr>
<tr>
<td align="left">!=</td>
<td align="left">不等于，某些数据库系统也写作 &lt;&gt;</td>
</tr>
<tr>
<td align="left">&gt;</td>
<td align="left">大于</td>
</tr>
<tr>
<td align="left">&lt;</td>
<td align="left">小于</td>
</tr>
<tr>
<td align="left">&gt;=</td>
<td align="left">大于或等于</td>
</tr>
<tr>
<td align="left">&lt;=</td>
<td align="left">小于或等于</td>
</tr>
<tr>
<td align="left">BETWEEN … AND …</td>
<td align="left">介于某个范围之内，例：WHERE age BETWEEN 20 AND 30</td>
</tr>
<tr>
<td align="left">NOT BETWEEN …AND …</td>
<td align="left">不在某个范围之内</td>
</tr>
<tr>
<td align="left">IN(项1,项2,…)</td>
<td align="left">在指定项内，例：WHERE city IN(‘beijing’,’shanghai’)</td>
</tr>
<tr>
<td align="left">NOT IN(项1,项2,…)</td>
<td align="left">不在指定项内</td>
</tr>
<tr>
<td align="left">LIKE</td>
<td align="left">搜索匹配，常与模式匹配符配合使用</td>
</tr>
<tr>
<td align="left">NOT LIKE</td>
<td align="left">LIKE的反义</td>
</tr>
<tr>
<td align="left">IS NULL</td>
<td align="left">空值判断符</td>
</tr>
<tr>
<td align="left">IS NOT NULL</td>
<td align="left">非空判断符</td>
</tr>
<tr>
<td align="left">NOT、AND、OR</td>
<td align="left">逻辑运算符，分别表示否、并且、或，用于多个逻辑连接。 优先级：NOT &gt; AND &gt; OR</td>
</tr>
<tr>
<td align="left">%</td>
<td align="left">模式匹配符，表示任意字串，例：WHERE username LIKE ‘%user’</td>
</tr>
</tbody></table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/10/18/MySQL/" data-id="ckpjvqhyc0005n2g06dstbq99" data-title="MySQL" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/db/" rel="tag">db</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/10/18/Jenkins/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Jenkins
        
      </div>
    </a>
  
  
    <a href="/2020/10/07/Kubernetes/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">kubernetes</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/DevOps/" rel="tag">DevOps</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/db/" rel="tag">db</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/DevOps/" style="font-size: 10px;">DevOps</a> <a href="/tags/db/" style="font-size: 10px;">db</a> <a href="/tags/k8s/" style="font-size: 10px;">k8s</a> <a href="/tags/web/" style="font-size: 10px;">web</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/06/05/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2020/10/25/Nginx/">Nginx</a>
          </li>
        
          <li>
            <a href="/2020/10/18/Jenkins/">Jenkins</a>
          </li>
        
          <li>
            <a href="/2020/10/18/MySQL/">MySQL</a>
          </li>
        
          <li>
            <a href="/2020/10/07/Kubernetes/">kubernetes</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>